// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`aggregates.sql > line 12 1`] = `
[
  "CREATE TABLE aggtest (
	a 			int2,
	b			float4
)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "aggtest",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "int2",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 36,
                  "typeName": {
                    "location": 40,
                    "names": [
                      {
                        "String": {
                          "sval": "float4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 20 1`] = `
[
  "ANALYZE aggtest",
  {
    "stmts": [
      {
        "stmt": {
          "VacuumStmt": {
            "rels": [
              {
                "VacuumRelation": {
                  "relation": {
                    "inh": true,
                    "location": 8,
                    "relname": "aggtest",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 25 1`] = `
[
  "SELECT avg(a) AS avg_32 FROM aggtest WHERE a < 100",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 29,
                  "relname": "aggtest",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "name": "avg_32",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 11,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "avg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 43,
                  },
                },
                "location": 45,
                "name": [
                  {
                    "String": {
                      "sval": "<",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 100,
                    },
                    "location": 47,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 27 1`] = `
[
  "SELECT any_value(v) FROM (VALUES (1), (2), (3)) AS v (v)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "v",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 34,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 39,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 44,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "v",
                                },
                              },
                            ],
                            "location": 17,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "any_value",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 37 1`] = `
[
  "SELECT avg(gpa) AS avg_3_4 FROM ONLY student",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "location": 37,
                  "relname": "student",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "name": "avg_3_4",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "gpa",
                                },
                              },
                            ],
                            "location": 11,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "avg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 45 1`] = `
[
  "SELECT max(four) AS max_3 FROM onek",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 31,
                  "relname": "onek",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "name": "max_3",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 11,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 50 1`] = `
[
  "SELECT stddev_pop(b) FROM aggtest",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 26,
                  "relname": "aggtest",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 18,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "stddev_pop",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 55 1`] = `
[
  "SELECT stddev_pop(b::numeric) FROM aggtest",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 35,
                  "relname": "aggtest",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 18,
                              },
                            },
                            "location": 19,
                            "typeName": {
                              "location": 21,
                              "names": [
                                {
                                  "String": {
                                    "sval": "pg_catalog",
                                  },
                                },
                                {
                                  "String": {
                                    "sval": "numeric",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "stddev_pop",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 62 1`] = `
[
  "SELECT var_pop(1.0::float8), var_samp(2.0::float8)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "A_Const": {
                                "fval": {
                                  "fval": "1.0",
                                },
                                "location": 15,
                              },
                            },
                            "location": 18,
                            "typeName": {
                              "location": 20,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "var_pop",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 29,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "A_Const": {
                                "fval": {
                                  "fval": "2.0",
                                },
                                "location": 38,
                              },
                            },
                            "location": 41,
                            "typeName": {
                              "location": 43,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "var_samp",
                          },
                        },
                      ],
                      "location": 29,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 82 1`] = `
[
  "select sum(null::int4) from generate_series(1,3)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 44,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 3,
                                    },
                                    "location": 46,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 28,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "A_Const": {
                                "isnull": true,
                                "location": 11,
                              },
                            },
                            "location": 15,
                            "typeName": {
                              "location": 17,
                              "names": [
                                {
                                  "String": {
                                    "sval": "int4",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 94 1`] = `
[
  "SELECT sum(x::float8), avg(x::float8), var_pop(x::float8)
FROM (VALUES ('1'), ('infinity')) v(x)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "x",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 72,
                                  "sval": {
                                    "sval": "1",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 79,
                                  "sval": {
                                    "sval": "infinity",
                                  },
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 11,
                              },
                            },
                            "location": 12,
                            "typeName": {
                              "location": 14,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 23,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 27,
                              },
                            },
                            "location": 28,
                            "typeName": {
                              "location": 30,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "avg",
                          },
                        },
                      ],
                      "location": 23,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 39,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 47,
                              },
                            },
                            "location": 48,
                            "typeName": {
                              "location": 50,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "var_pop",
                          },
                        },
                      ],
                      "location": 39,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 116 1`] = `
[
  "SELECT avg(x::float8), var_pop(x::float8)
FROM (VALUES (100000003), (100000004), (100000006), (100000007)) v(x)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "x",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 100000003,
                                  },
                                  "location": 56,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 100000004,
                                  },
                                  "location": 69,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 100000006,
                                  },
                                  "location": 82,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 100000007,
                                  },
                                  "location": 95,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 11,
                              },
                            },
                            "location": 12,
                            "typeName": {
                              "location": 14,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "avg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 23,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 31,
                              },
                            },
                            "location": 32,
                            "typeName": {
                              "location": 34,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "var_pop",
                          },
                        },
                      ],
                      "location": 23,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 122 1`] = `
[
  "SELECT regr_count(b, a) FROM aggtest",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 29,
                  "relname": "aggtest",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 18,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 21,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "regr_count",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 133 1`] = `
[
  "SELECT covar_pop(1::float8,2::float8), covar_samp(3::float8,4::float8)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "A_Const": {
                                "ival": {
                                  "ival": 1,
                                },
                                "location": 17,
                              },
                            },
                            "location": 18,
                            "typeName": {
                              "location": 20,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                        {
                          "TypeCast": {
                            "arg": {
                              "A_Const": {
                                "ival": {
                                  "ival": 2,
                                },
                                "location": 27,
                              },
                            },
                            "location": 28,
                            "typeName": {
                              "location": 30,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "covar_pop",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 39,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "A_Const": {
                                "ival": {
                                  "ival": 3,
                                },
                                "location": 50,
                              },
                            },
                            "location": 51,
                            "typeName": {
                              "location": 53,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                        {
                          "TypeCast": {
                            "arg": {
                              "A_Const": {
                                "ival": {
                                  "ival": 4,
                                },
                                "location": 60,
                              },
                            },
                            "location": 61,
                            "typeName": {
                              "location": 63,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "covar_samp",
                          },
                        },
                      ],
                      "location": 39,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 138 1`] = `
[
  "CREATE TABLE regr_test (x float8, y float8)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "regr_test",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "x",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 26,
                    "names": [
                      {
                        "String": {
                          "sval": "float8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "y",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 36,
                    "names": [
                      {
                        "String": {
                          "sval": "float8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 162 1`] = `
[
  "SELECT count(four) AS cnt_1000 FROM onek",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 36,
                  "relname": "onek",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "name": "cnt_1000",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 13,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "count",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 165 1`] = `
[
  "select ten, count(*), sum(four) from onek
group by ten order by ten",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 37,
                  "relname": "onek",
                  "relpersistence": "p",
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "ten",
                      },
                    },
                  ],
                  "location": 51,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 64,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 12,
                  "val": {
                    "FuncCall": {
                      "agg_star": true,
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "count",
                          },
                        },
                      ],
                      "location": 12,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 22,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 26,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 22,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 168 1`] = `
[
  "select ten, count(four), sum(DISTINCT four) from onek
group by ten order by ten",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 49,
                  "relname": "onek",
                  "relpersistence": "p",
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "ten",
                      },
                    },
                  ],
                  "location": 63,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 76,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 12,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 18,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "count",
                          },
                        },
                      ],
                      "location": 12,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 25,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 38,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 25,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 172 1`] = `
[
  "SELECT newavg(four) AS avg_1 FROM onek",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 34,
                  "relname": "onek",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "name": "avg_1",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 14,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "newavg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 182 1`] = `
[
  "select ten, sum(distinct four) from onek a
group by ten
having exists (select 1 from onek b where sum(distinct a.four) = b.four)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "alias": {
                    "aliasname": "a",
                  },
                  "inh": true,
                  "location": 36,
                  "relname": "onek",
                  "relpersistence": "p",
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "ten",
                      },
                    },
                  ],
                  "location": 52,
                },
              },
            ],
            "havingClause": {
              "SubLink": {
                "location": 63,
                "subLinkType": "EXISTS_SUBLINK",
                "subselect": {
                  "SelectStmt": {
                    "fromClause": [
                      {
                        "RangeVar": {
                          "alias": {
                            "aliasname": "b",
                          },
                          "inh": true,
                          "location": 85,
                          "relname": "onek",
                          "relpersistence": "p",
                        },
                      },
                    ],
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "targetList": [
                      {
                        "ResTarget": {
                          "location": 78,
                          "val": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 78,
                            },
                          },
                        },
                      },
                    ],
                    "whereClause": {
                      "A_Expr": {
                        "kind": "AEXPR_OP",
                        "lexpr": {
                          "FuncCall": {
                            "agg_distinct": true,
                            "args": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "a",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "four",
                                      },
                                    },
                                  ],
                                  "location": 111,
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "sum",
                                },
                              },
                            ],
                            "location": 98,
                          },
                        },
                        "location": 119,
                        "name": [
                          {
                            "String": {
                              "sval": "=",
                            },
                          },
                        ],
                        "rexpr": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 121,
                          },
                        },
                      },
                    },
                  },
                },
              },
            },
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 12,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 25,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 12,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 187 1`] = `
[
  "select ten, sum(distinct four) from onek a
group by ten
having exists (select 1 from onek b
               where sum(distinct a.four + b.four) = b.four)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "alias": {
                    "aliasname": "a",
                  },
                  "inh": true,
                  "location": 36,
                  "relname": "onek",
                  "relpersistence": "p",
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "ten",
                      },
                    },
                  ],
                  "location": 52,
                },
              },
            ],
            "havingClause": {
              "SubLink": {
                "location": 63,
                "subLinkType": "EXISTS_SUBLINK",
                "subselect": {
                  "SelectStmt": {
                    "fromClause": [
                      {
                        "RangeVar": {
                          "alias": {
                            "aliasname": "b",
                          },
                          "inh": true,
                          "location": 85,
                          "relname": "onek",
                          "relpersistence": "p",
                        },
                      },
                    ],
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "targetList": [
                      {
                        "ResTarget": {
                          "location": 78,
                          "val": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 78,
                            },
                          },
                        },
                      },
                    ],
                    "whereClause": {
                      "A_Expr": {
                        "kind": "AEXPR_OP",
                        "lexpr": {
                          "FuncCall": {
                            "agg_distinct": true,
                            "args": [
                              {
                                "A_Expr": {
                                  "kind": "AEXPR_OP",
                                  "lexpr": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "a",
                                          },
                                        },
                                        {
                                          "String": {
                                            "sval": "four",
                                          },
                                        },
                                      ],
                                      "location": 126,
                                    },
                                  },
                                  "location": 133,
                                  "name": [
                                    {
                                      "String": {
                                        "sval": "+",
                                      },
                                    },
                                  ],
                                  "rexpr": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "b",
                                          },
                                        },
                                        {
                                          "String": {
                                            "sval": "four",
                                          },
                                        },
                                      ],
                                      "location": 135,
                                    },
                                  },
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "sum",
                                },
                              },
                            ],
                            "location": 113,
                          },
                        },
                        "location": 143,
                        "name": [
                          {
                            "String": {
                              "sval": "=",
                            },
                          },
                        ],
                        "rexpr": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 145,
                          },
                        },
                      },
                    },
                  },
                },
              },
            },
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 12,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 25,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 12,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 194 1`] = `
[
  "select
  (select max((select i.unique2 from tenk1 i where i.unique1 = o.unique1)))
from tenk1 o",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "alias": {
                    "aliasname": "o",
                  },
                  "inh": true,
                  "location": 88,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "SubLink": {
                      "location": 9,
                      "subLinkType": "EXPR_SUBLINK",
                      "subselect": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 17,
                                "val": {
                                  "FuncCall": {
                                    "args": [
                                      {
                                        "SubLink": {
                                          "location": 21,
                                          "subLinkType": "EXPR_SUBLINK",
                                          "subselect": {
                                            "SelectStmt": {
                                              "fromClause": [
                                                {
                                                  "RangeVar": {
                                                    "alias": {
                                                      "aliasname": "i",
                                                    },
                                                    "inh": true,
                                                    "location": 44,
                                                    "relname": "tenk1",
                                                    "relpersistence": "p",
                                                  },
                                                },
                                              ],
                                              "limitOption": "LIMIT_OPTION_DEFAULT",
                                              "op": "SETOP_NONE",
                                              "targetList": [
                                                {
                                                  "ResTarget": {
                                                    "location": 29,
                                                    "val": {
                                                      "ColumnRef": {
                                                        "fields": [
                                                          {
                                                            "String": {
                                                              "sval": "i",
                                                            },
                                                          },
                                                          {
                                                            "String": {
                                                              "sval": "unique2",
                                                            },
                                                          },
                                                        ],
                                                        "location": 29,
                                                      },
                                                    },
                                                  },
                                                },
                                              ],
                                              "whereClause": {
                                                "A_Expr": {
                                                  "kind": "AEXPR_OP",
                                                  "lexpr": {
                                                    "ColumnRef": {
                                                      "fields": [
                                                        {
                                                          "String": {
                                                            "sval": "i",
                                                          },
                                                        },
                                                        {
                                                          "String": {
                                                            "sval": "unique1",
                                                          },
                                                        },
                                                      ],
                                                      "location": 58,
                                                    },
                                                  },
                                                  "location": 68,
                                                  "name": [
                                                    {
                                                      "String": {
                                                        "sval": "=",
                                                      },
                                                    },
                                                  ],
                                                  "rexpr": {
                                                    "ColumnRef": {
                                                      "fields": [
                                                        {
                                                          "String": {
                                                            "sval": "o",
                                                          },
                                                        },
                                                        {
                                                          "String": {
                                                            "sval": "unique1",
                                                          },
                                                        },
                                                      ],
                                                      "location": 70,
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "max",
                                        },
                                      },
                                    ],
                                    "location": 17,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 200 1`] = `
[
  "explain (verbose, costs off)
select s1, s2, sm
from generate_series(1, 3) s1,
     lateral (select s2, sum(s1 + s2) sm
              from generate_series(1, 3) s2 group by s2) ss
order by 1, 2",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "verbose",
                  "location": 9,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 18,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeFunction": {
                      "alias": {
                        "aliasname": "s1",
                      },
                      "functions": [
                        {
                          "List": {
                            "items": [
                              {
                                "FuncCall": {
                                  "args": [
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1,
                                        },
                                        "location": 68,
                                      },
                                    },
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 3,
                                        },
                                        "location": 71,
                                      },
                                    },
                                  ],
                                  "funcformat": "COERCE_EXPLICIT_CALL",
                                  "funcname": [
                                    {
                                      "String": {
                                        "sval": "generate_series",
                                      },
                                    },
                                  ],
                                  "location": 52,
                                },
                              },
                              {},
                            ],
                          },
                        },
                      ],
                    },
                  },
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "ss",
                      },
                      "lateral": true,
                      "subquery": {
                        "SelectStmt": {
                          "fromClause": [
                            {
                              "RangeFunction": {
                                "alias": {
                                  "aliasname": "s2",
                                },
                                "functions": [
                                  {
                                    "List": {
                                      "items": [
                                        {
                                          "FuncCall": {
                                            "args": [
                                              {
                                                "A_Const": {
                                                  "ival": {
                                                    "ival": 1,
                                                  },
                                                  "location": 154,
                                                },
                                              },
                                              {
                                                "A_Const": {
                                                  "ival": {
                                                    "ival": 3,
                                                  },
                                                  "location": 157,
                                                },
                                              },
                                            ],
                                            "funcformat": "COERCE_EXPLICIT_CALL",
                                            "funcname": [
                                              {
                                                "String": {
                                                  "sval": "generate_series",
                                                },
                                              },
                                            ],
                                            "location": 138,
                                          },
                                        },
                                        {},
                                      ],
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                          "groupClause": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "s2",
                                    },
                                  },
                                ],
                                "location": 172,
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 99,
                                "val": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "s2",
                                        },
                                      },
                                    ],
                                    "location": 99,
                                  },
                                },
                              },
                            },
                            {
                              "ResTarget": {
                                "location": 103,
                                "name": "sm",
                                "val": {
                                  "FuncCall": {
                                    "args": [
                                      {
                                        "A_Expr": {
                                          "kind": "AEXPR_OP",
                                          "lexpr": {
                                            "ColumnRef": {
                                              "fields": [
                                                {
                                                  "String": {
                                                    "sval": "s1",
                                                  },
                                                },
                                              ],
                                              "location": 107,
                                            },
                                          },
                                          "location": 110,
                                          "name": [
                                            {
                                              "String": {
                                                "sval": "+",
                                              },
                                            },
                                          ],
                                          "rexpr": {
                                            "ColumnRef": {
                                              "fields": [
                                                {
                                                  "String": {
                                                    "sval": "s2",
                                                  },
                                                },
                                              ],
                                              "location": 112,
                                            },
                                          },
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "sum",
                                        },
                                      },
                                    ],
                                    "location": 103,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "sortClause": [
                  {
                    "SortBy": {
                      "location": -1,
                      "node": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 188,
                        },
                      },
                      "sortby_dir": "SORTBY_DEFAULT",
                      "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                    },
                  },
                  {
                    "SortBy": {
                      "location": -1,
                      "node": {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 191,
                        },
                      },
                      "sortby_dir": "SORTBY_DEFAULT",
                      "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                    },
                  },
                ],
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 36,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "s1",
                              },
                            },
                          ],
                          "location": 36,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 40,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "s2",
                              },
                            },
                          ],
                          "location": 40,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 44,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "sm",
                              },
                            },
                          ],
                          "location": 44,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 212 1`] = `
[
  "explain (verbose, costs off)
select array(select sum(x+y) s
            from generate_series(1,3) y group by y order by s)
  from generate_series(1,3) x",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "verbose",
                  "location": 9,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 18,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeFunction": {
                      "alias": {
                        "aliasname": "x",
                      },
                      "functions": [
                        {
                          "List": {
                            "items": [
                              {
                                "FuncCall": {
                                  "args": [
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1,
                                        },
                                        "location": 146,
                                      },
                                    },
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 3,
                                        },
                                        "location": 148,
                                      },
                                    },
                                  ],
                                  "funcformat": "COERCE_EXPLICIT_CALL",
                                  "funcname": [
                                    {
                                      "String": {
                                        "sval": "generate_series",
                                      },
                                    },
                                  ],
                                  "location": 130,
                                },
                              },
                              {},
                            ],
                          },
                        },
                      ],
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 36,
                      "val": {
                        "SubLink": {
                          "location": 36,
                          "subLinkType": "ARRAY_SUBLINK",
                          "subselect": {
                            "SelectStmt": {
                              "fromClause": [
                                {
                                  "RangeFunction": {
                                    "alias": {
                                      "aliasname": "y",
                                    },
                                    "functions": [
                                      {
                                        "List": {
                                          "items": [
                                            {
                                              "FuncCall": {
                                                "args": [
                                                  {
                                                    "A_Const": {
                                                      "ival": {
                                                        "ival": 1,
                                                      },
                                                      "location": 93,
                                                    },
                                                  },
                                                  {
                                                    "A_Const": {
                                                      "ival": {
                                                        "ival": 3,
                                                      },
                                                      "location": 95,
                                                    },
                                                  },
                                                ],
                                                "funcformat": "COERCE_EXPLICIT_CALL",
                                                "funcname": [
                                                  {
                                                    "String": {
                                                      "sval": "generate_series",
                                                    },
                                                  },
                                                ],
                                                "location": 77,
                                              },
                                            },
                                            {},
                                          ],
                                        },
                                      },
                                    ],
                                  },
                                },
                              ],
                              "groupClause": [
                                {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "y",
                                        },
                                      },
                                    ],
                                    "location": 109,
                                  },
                                },
                              ],
                              "limitOption": "LIMIT_OPTION_DEFAULT",
                              "op": "SETOP_NONE",
                              "sortClause": [
                                {
                                  "SortBy": {
                                    "location": -1,
                                    "node": {
                                      "ColumnRef": {
                                        "fields": [
                                          {
                                            "String": {
                                              "sval": "s",
                                            },
                                          },
                                        ],
                                        "location": 120,
                                      },
                                    },
                                    "sortby_dir": "SORTBY_DEFAULT",
                                    "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                                  },
                                },
                              ],
                              "targetList": [
                                {
                                  "ResTarget": {
                                    "location": 49,
                                    "name": "s",
                                    "val": {
                                      "FuncCall": {
                                        "args": [
                                          {
                                            "A_Expr": {
                                              "kind": "AEXPR_OP",
                                              "lexpr": {
                                                "ColumnRef": {
                                                  "fields": [
                                                    {
                                                      "String": {
                                                        "sval": "x",
                                                      },
                                                    },
                                                  ],
                                                  "location": 53,
                                                },
                                              },
                                              "location": 54,
                                              "name": [
                                                {
                                                  "String": {
                                                    "sval": "+",
                                                  },
                                                },
                                              ],
                                              "rexpr": {
                                                "ColumnRef": {
                                                  "fields": [
                                                    {
                                                      "String": {
                                                        "sval": "y",
                                                      },
                                                    },
                                                  ],
                                                  "location": 55,
                                                },
                                              },
                                            },
                                          },
                                        ],
                                        "funcformat": "COERCE_EXPLICIT_CALL",
                                        "funcname": [
                                          {
                                            "String": {
                                              "sval": "sum",
                                            },
                                          },
                                        ],
                                        "location": 49,
                                      },
                                    },
                                  },
                                },
                              ],
                            },
                          },
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 223 1`] = `
[
  "CREATE TEMPORARY TABLE bitwise_test(
  i2 INT2,
  i4 INT4,
  i8 INT8,
  i INTEGER,
  x INT2,
  y BIT(4)
)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "bitwise_test",
              "relpersistence": "t",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "i2",
                  "is_local": true,
                  "location": 39,
                  "typeName": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "int2",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "i4",
                  "is_local": true,
                  "location": 50,
                  "typeName": {
                    "location": 53,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "i8",
                  "is_local": true,
                  "location": 61,
                  "typeName": {
                    "location": 64,
                    "names": [
                      {
                        "String": {
                          "sval": "int8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "i",
                  "is_local": true,
                  "location": 72,
                  "typeName": {
                    "location": 74,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "x",
                  "is_local": true,
                  "location": 85,
                  "typeName": {
                    "location": 87,
                    "names": [
                      {
                        "String": {
                          "sval": "int2",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "y",
                  "is_local": true,
                  "location": 95,
                  "typeName": {
                    "location": 97,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "bit",
                        },
                      },
                    ],
                    "typemod": -1,
                    "typmods": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 4,
                          },
                          "location": 101,
                        },
                      },
                    ],
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 233 1`] = `
[
  "SELECT
  BIT_AND(i2) AS "?",
  BIT_OR(i4)  AS "?",
  BIT_XOR(i8) AS "?"
FROM bitwise_test",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 77,
                  "relname": "bitwise_test",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "name": "?",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "i2",
                                },
                              },
                            ],
                            "location": 17,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bit_and",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 31,
                  "name": "?",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "i4",
                                },
                              },
                            ],
                            "location": 38,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bit_or",
                          },
                        },
                      ],
                      "location": 31,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 53,
                  "name": "?",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "i8",
                                },
                              },
                            ],
                            "location": 61,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bit_xor",
                          },
                        },
                      ],
                      "location": 53,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 239 1`] = `
[
  "COPY bitwise_test FROM STDIN NULL 'null'",
  {
    "stmts": [
      {
        "stmt": {
          "CopyStmt": {
            "is_from": true,
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "null",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "null",
                  "location": 29,
                },
              },
            ],
            "relation": {
              "inh": true,
              "location": 5,
              "relname": "bitwise_test",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 287 1`] = `
[
  "SELECT
  -- boolean or transitions
  -- null because strict
  boolor_statefunc(NULL, NULL)  IS NULL AS "t",
  boolor_statefunc(TRUE, NULL)  IS NULL AS "t",
  boolor_statefunc(FALSE, NULL) IS NULL AS "t",
  boolor_statefunc(NULL, TRUE)  IS NULL AS "t",
  boolor_statefunc(NULL, FALSE) IS NULL AS "t",
  -- actual computations
  boolor_statefunc(TRUE, TRUE) AS "t",
  boolor_statefunc(TRUE, FALSE) AS "t",
  boolor_statefunc(FALSE, TRUE) AS "t",
  NOT boolor_statefunc(FALSE, FALSE) AS "t"",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 62,
                  "name": "t",
                  "val": {
                    "NullTest": {
                      "arg": {
                        "FuncCall": {
                          "args": [
                            {
                              "A_Const": {
                                "isnull": true,
                                "location": 79,
                              },
                            },
                            {
                              "A_Const": {
                                "isnull": true,
                                "location": 85,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "boolor_statefunc",
                              },
                            },
                          ],
                          "location": 62,
                        },
                      },
                      "location": 92,
                      "nulltesttype": "IS_NULL",
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 110,
                  "name": "t",
                  "val": {
                    "NullTest": {
                      "arg": {
                        "FuncCall": {
                          "args": [
                            {
                              "A_Const": {
                                "boolval": {
                                  "boolval": true,
                                },
                                "location": 127,
                              },
                            },
                            {
                              "A_Const": {
                                "isnull": true,
                                "location": 133,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "boolor_statefunc",
                              },
                            },
                          ],
                          "location": 110,
                        },
                      },
                      "location": 140,
                      "nulltesttype": "IS_NULL",
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 158,
                  "name": "t",
                  "val": {
                    "NullTest": {
                      "arg": {
                        "FuncCall": {
                          "args": [
                            {
                              "A_Const": {
                                "boolval": {},
                                "location": 175,
                              },
                            },
                            {
                              "A_Const": {
                                "isnull": true,
                                "location": 182,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "boolor_statefunc",
                              },
                            },
                          ],
                          "location": 158,
                        },
                      },
                      "location": 188,
                      "nulltesttype": "IS_NULL",
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 206,
                  "name": "t",
                  "val": {
                    "NullTest": {
                      "arg": {
                        "FuncCall": {
                          "args": [
                            {
                              "A_Const": {
                                "isnull": true,
                                "location": 223,
                              },
                            },
                            {
                              "A_Const": {
                                "boolval": {
                                  "boolval": true,
                                },
                                "location": 229,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "boolor_statefunc",
                              },
                            },
                          ],
                          "location": 206,
                        },
                      },
                      "location": 236,
                      "nulltesttype": "IS_NULL",
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 254,
                  "name": "t",
                  "val": {
                    "NullTest": {
                      "arg": {
                        "FuncCall": {
                          "args": [
                            {
                              "A_Const": {
                                "isnull": true,
                                "location": 271,
                              },
                            },
                            {
                              "A_Const": {
                                "boolval": {},
                                "location": 277,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "boolor_statefunc",
                              },
                            },
                          ],
                          "location": 254,
                        },
                      },
                      "location": 284,
                      "nulltesttype": "IS_NULL",
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 327,
                  "name": "t",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "A_Const": {
                            "boolval": {
                              "boolval": true,
                            },
                            "location": 344,
                          },
                        },
                        {
                          "A_Const": {
                            "boolval": {
                              "boolval": true,
                            },
                            "location": 350,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "boolor_statefunc",
                          },
                        },
                      ],
                      "location": 327,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 366,
                  "name": "t",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "A_Const": {
                            "boolval": {
                              "boolval": true,
                            },
                            "location": 383,
                          },
                        },
                        {
                          "A_Const": {
                            "boolval": {},
                            "location": 389,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "boolor_statefunc",
                          },
                        },
                      ],
                      "location": 366,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 406,
                  "name": "t",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "A_Const": {
                            "boolval": {},
                            "location": 423,
                          },
                        },
                        {
                          "A_Const": {
                            "boolval": {
                              "boolval": true,
                            },
                            "location": 430,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "boolor_statefunc",
                          },
                        },
                      ],
                      "location": 406,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 446,
                  "name": "t",
                  "val": {
                    "BoolExpr": {
                      "args": [
                        {
                          "FuncCall": {
                            "args": [
                              {
                                "A_Const": {
                                  "boolval": {},
                                  "location": 467,
                                },
                              },
                              {
                                "A_Const": {
                                  "boolval": {},
                                  "location": 474,
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "boolor_statefunc",
                                },
                              },
                            ],
                            "location": 450,
                          },
                        },
                      ],
                      "boolop": "NOT_EXPR",
                      "location": 446,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 301 1`] = `
[
  "CREATE TEMPORARY TABLE bool_test(
  b1 BOOL,
  b2 BOOL,
  b3 BOOL,
  b4 BOOL)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "bool_test",
              "relpersistence": "t",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "b1",
                  "is_local": true,
                  "location": 36,
                  "typeName": {
                    "location": 39,
                    "names": [
                      {
                        "String": {
                          "sval": "bool",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b2",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 50,
                    "names": [
                      {
                        "String": {
                          "sval": "bool",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b3",
                  "is_local": true,
                  "location": 58,
                  "typeName": {
                    "location": 61,
                    "names": [
                      {
                        "String": {
                          "sval": "bool",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b4",
                  "is_local": true,
                  "location": 69,
                  "typeName": {
                    "location": 72,
                    "names": [
                      {
                        "String": {
                          "sval": "bool",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 308 1`] = `
[
  "SELECT
  BOOL_AND(b1)   AS "n",
  BOOL_OR(b3)    AS "n"
FROM bool_test",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 61,
                  "relname": "bool_test",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "name": "n",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b1",
                                },
                              },
                            ],
                            "location": 18,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bool_and",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 34,
                  "name": "n",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b3",
                                },
                              },
                            ],
                            "location": 42,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bool_or",
                          },
                        },
                      ],
                      "location": 34,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 313 1`] = `
[
  "COPY bool_test FROM STDIN NULL 'null'",
  {
    "stmts": [
      {
        "stmt": {
          "CopyStmt": {
            "is_from": true,
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "null",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "null",
                  "location": 26,
                },
              },
            ],
            "relation": {
              "inh": true,
              "location": 5,
              "relname": "bool_test",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 328 1`] = `
[
  "SELECT
  EVERY(b1)     AS "f",
  EVERY(b2)     AS "t",
  EVERY(b3)     AS "f",
  EVERY(b4)     AS "n",
  EVERY(NOT b2) AS "f",
  EVERY(NOT b3) AS "t"
FROM bool_test",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 155,
                  "relname": "bool_test",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "name": "f",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b1",
                                },
                              },
                            ],
                            "location": 15,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "every",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 33,
                  "name": "t",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b2",
                                },
                              },
                            ],
                            "location": 39,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "every",
                          },
                        },
                      ],
                      "location": 33,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 57,
                  "name": "f",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b3",
                                },
                              },
                            ],
                            "location": 63,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "every",
                          },
                        },
                      ],
                      "location": 57,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 81,
                  "name": "n",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b4",
                                },
                              },
                            ],
                            "location": 87,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "every",
                          },
                        },
                      ],
                      "location": 81,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 105,
                  "name": "f",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "BoolExpr": {
                            "args": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "b2",
                                      },
                                    },
                                  ],
                                  "location": 115,
                                },
                              },
                            ],
                            "boolop": "NOT_EXPR",
                            "location": 111,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "every",
                          },
                        },
                      ],
                      "location": 105,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 129,
                  "name": "t",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "BoolExpr": {
                            "args": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "b3",
                                      },
                                    },
                                  ],
                                  "location": 139,
                                },
                              },
                            ],
                            "boolop": "NOT_EXPR",
                            "location": 135,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "every",
                          },
                        },
                      ],
                      "location": 129,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 337 1`] = `
[
  "SELECT
  BOOL_OR(b1)      AS "t",
  BOOL_OR(b2)      AS "t",
  BOOL_OR(b3)      AS "f",
  BOOL_OR(b4)      AS "n",
  BOOL_OR(NOT b2)  AS "f",
  BOOL_OR(NOT b3)  AS "t"
FROM bool_test",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 173,
                  "relname": "bool_test",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "name": "t",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b1",
                                },
                              },
                            ],
                            "location": 17,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bool_or",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 36,
                  "name": "t",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b2",
                                },
                              },
                            ],
                            "location": 44,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bool_or",
                          },
                        },
                      ],
                      "location": 36,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 63,
                  "name": "f",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b3",
                                },
                              },
                            ],
                            "location": 71,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bool_or",
                          },
                        },
                      ],
                      "location": 63,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 90,
                  "name": "n",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b4",
                                },
                              },
                            ],
                            "location": 98,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bool_or",
                          },
                        },
                      ],
                      "location": 90,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 117,
                  "name": "f",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "BoolExpr": {
                            "args": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "b2",
                                      },
                                    },
                                  ],
                                  "location": 129,
                                },
                              },
                            ],
                            "boolop": "NOT_EXPR",
                            "location": 125,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bool_or",
                          },
                        },
                      ],
                      "location": 117,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 144,
                  "name": "t",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "BoolExpr": {
                            "args": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "b3",
                                      },
                                    },
                                  ],
                                  "location": 156,
                                },
                              },
                            ],
                            "boolop": "NOT_EXPR",
                            "location": 152,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "bool_or",
                          },
                        },
                      ],
                      "location": 144,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 352 1`] = `
[
  "explain (costs off)
  select min(unique1) from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 47,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 33,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 356 1`] = `
[
  "  select max(unique1) from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 27,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique1",
                                },
                              },
                            ],
                            "location": 13,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 359 1`] = `
[
  "  select max(unique1) from tenk1 where unique1 < 42",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 27,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique1",
                                },
                              },
                            ],
                            "location": 13,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "unique1",
                        },
                      },
                    ],
                    "location": 39,
                  },
                },
                "location": 47,
                "name": [
                  {
                    "String": {
                      "sval": "<",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 42,
                    },
                    "location": 49,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 362 1`] = `
[
  "  select max(unique1) from tenk1 where unique1 > 42",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 27,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique1",
                                },
                              },
                            ],
                            "location": 13,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "unique1",
                        },
                      },
                    ],
                    "location": 39,
                  },
                },
                "location": 47,
                "name": [
                  {
                    "String": {
                      "sval": ">",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 42,
                    },
                    "location": 49,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 369 1`] = `
[
  "begin",
  {
    "stmts": [
      {
        "stmt": {
          "TransactionStmt": {
            "kind": "TRANS_STMT_BEGIN",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 377 1`] = `
[
  "explain (costs off)
  select max(tenthous) from tenk1 where thousand = 33",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 48,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "tenthous",
                                    },
                                  },
                                ],
                                "location": 33,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "thousand",
                            },
                          },
                        ],
                        "location": 60,
                      },
                    },
                    "location": 69,
                    "name": [
                      {
                        "String": {
                          "sval": "=",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {
                          "ival": 33,
                        },
                        "location": 71,
                      },
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 381 1`] = `
[
  "  select min(tenthous) from tenk1 where thousand = 33",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 28,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "tenthous",
                                },
                              },
                            ],
                            "location": 13,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "min",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "thousand",
                        },
                      },
                    ],
                    "location": 40,
                  },
                },
                "location": 49,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 33,
                    },
                    "location": 51,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 385 1`] = `
[
  "explain (costs off)
  select f1, (select min(unique1) from tenk1 where unique1 > f1) AS gt
    from int4_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 100,
                      "relname": "int4_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "f1",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 33,
                      "name": "gt",
                      "val": {
                        "SubLink": {
                          "location": 33,
                          "subLinkType": "EXPR_SUBLINK",
                          "subselect": {
                            "SelectStmt": {
                              "fromClause": [
                                {
                                  "RangeVar": {
                                    "inh": true,
                                    "location": 59,
                                    "relname": "tenk1",
                                    "relpersistence": "p",
                                  },
                                },
                              ],
                              "limitOption": "LIMIT_OPTION_DEFAULT",
                              "op": "SETOP_NONE",
                              "targetList": [
                                {
                                  "ResTarget": {
                                    "location": 41,
                                    "val": {
                                      "FuncCall": {
                                        "args": [
                                          {
                                            "ColumnRef": {
                                              "fields": [
                                                {
                                                  "String": {
                                                    "sval": "unique1",
                                                  },
                                                },
                                              ],
                                              "location": 45,
                                            },
                                          },
                                        ],
                                        "funcformat": "COERCE_EXPLICIT_CALL",
                                        "funcname": [
                                          {
                                            "String": {
                                              "sval": "min",
                                            },
                                          },
                                        ],
                                        "location": 41,
                                      },
                                    },
                                  },
                                },
                              ],
                              "whereClause": {
                                "A_Expr": {
                                  "kind": "AEXPR_OP",
                                  "lexpr": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "unique1",
                                          },
                                        },
                                      ],
                                      "location": 71,
                                    },
                                  },
                                  "location": 79,
                                  "name": [
                                    {
                                      "String": {
                                        "sval": ">",
                                      },
                                    },
                                  ],
                                  "rexpr": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "f1",
                                          },
                                        },
                                      ],
                                      "location": 81,
                                    },
                                  },
                                },
                              },
                            },
                          },
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 392 1`] = `
[
  "explain (costs off)
  select distinct max(unique2) from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "distinctClause": [
                  {},
                ],
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 56,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 38,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique2",
                                    },
                                  },
                                ],
                                "location": 42,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 38,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 396 1`] = `
[
  "  select max(unique2) from tenk1 order by 1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 27,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "A_Const": {
                      "ival": {
                        "ival": 1,
                      },
                      "location": 42,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique2",
                                },
                              },
                            ],
                            "location": 13,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 399 1`] = `
[
  "  select max(unique2) from tenk1 order by max(unique2)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 27,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique2",
                                },
                              },
                            ],
                            "location": 46,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 42,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique2",
                                },
                              },
                            ],
                            "location": 13,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 402 1`] = `
[
  "  select max(unique2) from tenk1 order by max(unique2)+1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 27,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique2",
                                    },
                                  },
                                ],
                                "location": 46,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 42,
                        },
                      },
                      "location": 54,
                      "name": [
                        {
                          "String": {
                            "sval": "+",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 55,
                        },
                      },
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique2",
                                },
                              },
                            ],
                            "location": 13,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 405 1`] = `
[
  "  select max(unique2), generate_series(1,3) as g from tenk1 order by g desc",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 54,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "g",
                          },
                        },
                      ],
                      "location": 69,
                    },
                  },
                  "sortby_dir": "SORTBY_DESC",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique2",
                                },
                              },
                            ],
                            "location": 13,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 23,
                  "name": "g",
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 39,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 41,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "generate_series",
                          },
                        },
                      ],
                      "location": 23,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 409 1`] = `
[
  "explain (costs off)
  select max(100) from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 43,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "A_Const": {
                                "ival": {
                                  "ival": 100,
                                },
                                "location": 33,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 414 1`] = `
[
  "create table minmaxtest(f1 int)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "minmaxtest",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "f1",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 27,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 423 1`] = `
[
  "insert into minmaxtest values(11), (12)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "minmaxtest",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 11,
                            },
                            "location": 30,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 12,
                            },
                            "location": 36,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 428 1`] = `
[
  "explain (costs off)
  select min(f1), max(f1) from minmaxtest",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 51,
                      "relname": "minmaxtest",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "f1",
                                    },
                                  },
                                ],
                                "location": 33,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 38,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "f1",
                                    },
                                  },
                                ],
                                "location": 42,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 38,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 433 1`] = `
[
  "explain (costs off)
  select distinct min(f1), max(f1) from minmaxtest",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "distinctClause": [
                  {},
                ],
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 60,
                      "relname": "minmaxtest",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 38,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "f1",
                                    },
                                  },
                                ],
                                "location": 42,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 38,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 47,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "f1",
                                    },
                                  },
                                ],
                                "location": 51,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 47,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 437 1`] = `
[
  "drop table minmaxtest cascade",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "minmaxtest",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 440 1`] = `
[
  "select max(min(unique1)) from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 30,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "FuncCall": {
                            "args": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "unique1",
                                      },
                                    },
                                  ],
                                  "location": 15,
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "min",
                                },
                              },
                            ],
                            "location": 11,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 455 1`] = `
[
  "explain (costs off) select * from t1 group by a,b,c,d",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 34,
                      "relname": "t1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 46,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 48,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 50,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "d",
                          },
                        },
                      ],
                      "location": 52,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 458 1`] = `
[
  "explain (costs off) select a,c from t1 group by a,c,d",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 36,
                      "relname": "t1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 48,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 50,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "d",
                          },
                        },
                      ],
                      "location": 52,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "c",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 461 1`] = `
[
  "explain (costs off) select *
from t1 inner join t2 on t1.a = t2.x and t1.b = t2.y
group by t1.a,t1.b,t1.c,t1.d,t2.x,t2.y,t2.z",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "JoinExpr": {
                      "jointype": "JOIN_INNER",
                      "larg": {
                        "RangeVar": {
                          "inh": true,
                          "location": 34,
                          "relname": "t1",
                          "relpersistence": "p",
                        },
                      },
                      "quals": {
                        "BoolExpr": {
                          "args": [
                            {
                              "A_Expr": {
                                "kind": "AEXPR_OP",
                                "lexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "t1",
                                        },
                                      },
                                      {
                                        "String": {
                                          "sval": "a",
                                        },
                                      },
                                    ],
                                    "location": 54,
                                  },
                                },
                                "location": 59,
                                "name": [
                                  {
                                    "String": {
                                      "sval": "=",
                                    },
                                  },
                                ],
                                "rexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "t2",
                                        },
                                      },
                                      {
                                        "String": {
                                          "sval": "x",
                                        },
                                      },
                                    ],
                                    "location": 61,
                                  },
                                },
                              },
                            },
                            {
                              "A_Expr": {
                                "kind": "AEXPR_OP",
                                "lexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "t1",
                                        },
                                      },
                                      {
                                        "String": {
                                          "sval": "b",
                                        },
                                      },
                                    ],
                                    "location": 70,
                                  },
                                },
                                "location": 75,
                                "name": [
                                  {
                                    "String": {
                                      "sval": "=",
                                    },
                                  },
                                ],
                                "rexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "t2",
                                        },
                                      },
                                      {
                                        "String": {
                                          "sval": "y",
                                        },
                                      },
                                    ],
                                    "location": 77,
                                  },
                                },
                              },
                            },
                          ],
                          "boolop": "AND_EXPR",
                          "location": 66,
                        },
                      },
                      "rarg": {
                        "RangeVar": {
                          "inh": true,
                          "location": 48,
                          "relname": "t2",
                          "relpersistence": "p",
                        },
                      },
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t1",
                          },
                        },
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 91,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t1",
                          },
                        },
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 96,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t1",
                          },
                        },
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 101,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t1",
                          },
                        },
                        {
                          "String": {
                            "sval": "d",
                          },
                        },
                      ],
                      "location": 106,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t2",
                          },
                        },
                        {
                          "String": {
                            "sval": "x",
                          },
                        },
                      ],
                      "location": 111,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t2",
                          },
                        },
                        {
                          "String": {
                            "sval": "y",
                          },
                        },
                      ],
                      "location": 116,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t2",
                          },
                        },
                        {
                          "String": {
                            "sval": "z",
                          },
                        },
                      ],
                      "location": 121,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 466 1`] = `
[
  "explain (costs off) select t1.*,t2.x,t2.z
from t1 inner join t2 on t1.a = t2.x and t1.b = t2.y
group by t1.a,t1.b,t1.c,t1.d,t2.x,t2.z",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "JoinExpr": {
                      "jointype": "JOIN_INNER",
                      "larg": {
                        "RangeVar": {
                          "inh": true,
                          "location": 47,
                          "relname": "t1",
                          "relpersistence": "p",
                        },
                      },
                      "quals": {
                        "BoolExpr": {
                          "args": [
                            {
                              "A_Expr": {
                                "kind": "AEXPR_OP",
                                "lexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "t1",
                                        },
                                      },
                                      {
                                        "String": {
                                          "sval": "a",
                                        },
                                      },
                                    ],
                                    "location": 67,
                                  },
                                },
                                "location": 72,
                                "name": [
                                  {
                                    "String": {
                                      "sval": "=",
                                    },
                                  },
                                ],
                                "rexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "t2",
                                        },
                                      },
                                      {
                                        "String": {
                                          "sval": "x",
                                        },
                                      },
                                    ],
                                    "location": 74,
                                  },
                                },
                              },
                            },
                            {
                              "A_Expr": {
                                "kind": "AEXPR_OP",
                                "lexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "t1",
                                        },
                                      },
                                      {
                                        "String": {
                                          "sval": "b",
                                        },
                                      },
                                    ],
                                    "location": 83,
                                  },
                                },
                                "location": 88,
                                "name": [
                                  {
                                    "String": {
                                      "sval": "=",
                                    },
                                  },
                                ],
                                "rexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "t2",
                                        },
                                      },
                                      {
                                        "String": {
                                          "sval": "y",
                                        },
                                      },
                                    ],
                                    "location": 90,
                                  },
                                },
                              },
                            },
                          ],
                          "boolop": "AND_EXPR",
                          "location": 79,
                        },
                      },
                      "rarg": {
                        "RangeVar": {
                          "inh": true,
                          "location": 61,
                          "relname": "t2",
                          "relpersistence": "p",
                        },
                      },
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t1",
                          },
                        },
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 104,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t1",
                          },
                        },
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 109,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t1",
                          },
                        },
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 114,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t1",
                          },
                        },
                        {
                          "String": {
                            "sval": "d",
                          },
                        },
                      ],
                      "location": 119,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t2",
                          },
                        },
                        {
                          "String": {
                            "sval": "x",
                          },
                        },
                      ],
                      "location": 124,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t2",
                          },
                        },
                        {
                          "String": {
                            "sval": "z",
                          },
                        },
                      ],
                      "location": 129,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "t1",
                              },
                            },
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 32,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "t2",
                              },
                            },
                            {
                              "String": {
                                "sval": "x",
                              },
                            },
                          ],
                          "location": 32,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 37,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "t2",
                              },
                            },
                            {
                              "String": {
                                "sval": "z",
                              },
                            },
                          ],
                          "location": 37,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 471 1`] = `
[
  "explain (costs off) select * from t3 group by a,b,c",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 34,
                      "relname": "t3",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 46,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 48,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 50,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 473 1`] = `
[
  "create temp table t1c () inherits (t1)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "inhRelations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 35,
                  "relname": "t1",
                  "relpersistence": "p",
                },
              },
            ],
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 18,
              "relname": "t1c",
              "relpersistence": "t",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 479 1`] = `
[
  "explain (costs off) select * from only t1 group by a,b,c,d",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "location": 39,
                      "relname": "t1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 51,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 53,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 55,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "d",
                          },
                        },
                      ],
                      "location": 57,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 481 1`] = `
[
  "create temp table p_t1 (
  a int,
  b int,
  c int,
  d int,
  primary key(a,b)
) partition by list(a)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 82,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 100,
                    "name": "a",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_LIST",
            },
            "relation": {
              "inh": true,
              "location": 18,
              "relname": "p_t1",
              "relpersistence": "t",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 27,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 36,
                  "typeName": {
                    "location": 38,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "c",
                  "is_local": true,
                  "location": 45,
                  "typeName": {
                    "location": 47,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "d",
                  "is_local": true,
                  "location": 54,
                  "typeName": {
                    "location": 56,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "a",
                      },
                    },
                    {
                      "String": {
                        "sval": "b",
                      },
                    },
                  ],
                  "location": 63,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 492 1`] = `
[
  "explain (costs off) select * from p_t1 group by a,b,c,d",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 34,
                      "relname": "p_t1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 48,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 50,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 52,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "d",
                          },
                        },
                      ],
                      "location": 54,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 494 1`] = `
[
  "drop table t1 cascade",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "t1",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 506 1`] = `
[
  "select f1 from t1 left join t2 using (f1) group by f1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "JoinExpr": {
                  "jointype": "JOIN_LEFT",
                  "larg": {
                    "RangeVar": {
                      "inh": true,
                      "location": 15,
                      "relname": "t1",
                      "relpersistence": "p",
                    },
                  },
                  "rarg": {
                    "RangeVar": {
                      "inh": true,
                      "location": 28,
                      "relname": "t2",
                      "relpersistence": "p",
                    },
                  },
                  "usingClause": [
                    {
                      "String": {
                        "sval": "f1",
                      },
                    },
                  ],
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "f1",
                      },
                    },
                  ],
                  "location": 51,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "f1",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 510 1`] = `
[
  "select t1.f1 from t1 left join t2 using (f1) group by f1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "JoinExpr": {
                  "jointype": "JOIN_LEFT",
                  "larg": {
                    "RangeVar": {
                      "inh": true,
                      "location": 18,
                      "relname": "t1",
                      "relpersistence": "p",
                    },
                  },
                  "rarg": {
                    "RangeVar": {
                      "inh": true,
                      "location": 31,
                      "relname": "t2",
                      "relpersistence": "p",
                    },
                  },
                  "usingClause": [
                    {
                      "String": {
                        "sval": "f1",
                      },
                    },
                  ],
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "f1",
                      },
                    },
                  ],
                  "location": 54,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t1",
                          },
                        },
                        {
                          "String": {
                            "sval": "f1",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 513 1`] = `
[
  "select f1, count(*) from
t1 x(x0,x1) left join (t1 left join t2 using(f1)) on (x0 = 0)
group by f1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "JoinExpr": {
                  "jointype": "JOIN_LEFT",
                  "larg": {
                    "RangeVar": {
                      "alias": {
                        "aliasname": "x",
                        "colnames": [
                          {
                            "String": {
                              "sval": "x0",
                            },
                          },
                          {
                            "String": {
                              "sval": "x1",
                            },
                          },
                        ],
                      },
                      "inh": true,
                      "location": 25,
                      "relname": "t1",
                      "relpersistence": "p",
                    },
                  },
                  "quals": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "x0",
                              },
                            },
                          ],
                          "location": 79,
                        },
                      },
                      "location": 82,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {},
                          "location": 84,
                        },
                      },
                    },
                  },
                  "rarg": {
                    "JoinExpr": {
                      "jointype": "JOIN_LEFT",
                      "larg": {
                        "RangeVar": {
                          "inh": true,
                          "location": 48,
                          "relname": "t1",
                          "relpersistence": "p",
                        },
                      },
                      "rarg": {
                        "RangeVar": {
                          "inh": true,
                          "location": 61,
                          "relname": "t2",
                          "relpersistence": "p",
                        },
                      },
                      "usingClause": [
                        {
                          "String": {
                            "sval": "f1",
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "f1",
                      },
                    },
                  ],
                  "location": 96,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "f1",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 11,
                  "val": {
                    "FuncCall": {
                      "agg_star": true,
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "count",
                          },
                        },
                      ],
                      "location": 11,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 518 1`] = `
[
  "select f2, count(*) from
t1 x(x0,x1) left join (t1 left join t2 using(f2)) on (x0 = 0)
group by f2",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "JoinExpr": {
                  "jointype": "JOIN_LEFT",
                  "larg": {
                    "RangeVar": {
                      "alias": {
                        "aliasname": "x",
                        "colnames": [
                          {
                            "String": {
                              "sval": "x0",
                            },
                          },
                          {
                            "String": {
                              "sval": "x1",
                            },
                          },
                        ],
                      },
                      "inh": true,
                      "location": 25,
                      "relname": "t1",
                      "relpersistence": "p",
                    },
                  },
                  "quals": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "x0",
                              },
                            },
                          ],
                          "location": 79,
                        },
                      },
                      "location": 82,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {},
                          "location": 84,
                        },
                      },
                    },
                  },
                  "rarg": {
                    "JoinExpr": {
                      "jointype": "JOIN_LEFT",
                      "larg": {
                        "RangeVar": {
                          "inh": true,
                          "location": 48,
                          "relname": "t1",
                          "relpersistence": "p",
                        },
                      },
                      "rarg": {
                        "RangeVar": {
                          "inh": true,
                          "location": 61,
                          "relname": "t2",
                          "relpersistence": "p",
                        },
                      },
                      "usingClause": [
                        {
                          "String": {
                            "sval": "f2",
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "f2",
                      },
                    },
                  ],
                  "location": 96,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "f2",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 11,
                  "val": {
                    "FuncCall": {
                      "agg_star": true,
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "count",
                          },
                        },
                      ],
                      "location": 11,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 522 1`] = `
[
  "drop table t1, t2",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "t1",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "t2",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 529 1`] = `
[
  "explain (costs off)
select sum(two order by two),max(four order by four), min(four order by four)
from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 103,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 44,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "two",
                                    },
                                  },
                                ],
                                "location": 31,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 49,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 67,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "four",
                                    },
                                  },
                                ],
                                "location": 53,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 49,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 74,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 92,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "four",
                                    },
                                  },
                                ],
                                "location": 78,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 74,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 535 1`] = `
[
  "explain (costs off)
select
  sum(two order by two), max(four order by four),
  min(four order by four), max(two order by two)
from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 131,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 46,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "two",
                                    },
                                  },
                                ],
                                "location": 33,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 52,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 70,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "four",
                                    },
                                  },
                                ],
                                "location": 56,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 52,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 79,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 97,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "four",
                                    },
                                  },
                                ],
                                "location": 83,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 79,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 104,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 121,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "two",
                                    },
                                  },
                                ],
                                "location": 108,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 104,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 550 1`] = `
[
  "explain (costs off)
select
  max(four order by four), sum(two order by two),
  min(four order by four), max(two order by two),
  sum(ten order by ten), min(ten order by ten), max(ten order by ten)
from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 202,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 47,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "four",
                                    },
                                  },
                                ],
                                "location": 33,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 54,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 71,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "two",
                                    },
                                  },
                                ],
                                "location": 58,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 54,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 79,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 97,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "four",
                                    },
                                  },
                                ],
                                "location": 83,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 79,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 104,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 121,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "two",
                                    },
                                  },
                                ],
                                "location": 108,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 104,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 129,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "ten",
                                        },
                                      },
                                    ],
                                    "location": 146,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "ten",
                                    },
                                  },
                                ],
                                "location": 133,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 129,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 152,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "ten",
                                        },
                                      },
                                    ],
                                    "location": 169,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "ten",
                                    },
                                  },
                                ],
                                "location": 156,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 152,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 175,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "ten",
                                        },
                                      },
                                    ],
                                    "location": 192,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "ten",
                                    },
                                  },
                                ],
                                "location": 179,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 175,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 560 1`] = `
[
  "explain (costs off)
select
  sum(unique1 order by ten, two), sum(unique1 order by four),
  sum(unique1 order by two, four)
from tenk1
group by ten",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 128,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 143,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "ten",
                                        },
                                      },
                                    ],
                                    "location": 50,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 55,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 33,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 61,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 82,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 65,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 61,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 91,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 112,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 117,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 95,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 91,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 570 1`] = `
[
  "explain (costs off)
select
  sum(unique1 order by two), sum(unique1 order by four),
  sum(unique1 order by four, two), sum(unique1 order by two, random()),
  sum(unique1 order by two, random(), random() + 1)
from tenk1
group by ten",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 213,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 228,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 50,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 33,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 56,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 77,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 60,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 56,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 86,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "four",
                                        },
                                      },
                                    ],
                                    "location": 107,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 113,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 90,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 86,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 119,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 140,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "FuncCall": {
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "random",
                                        },
                                      },
                                    ],
                                    "location": 145,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 123,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 119,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 158,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "two",
                                        },
                                      },
                                    ],
                                    "location": 179,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "FuncCall": {
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "random",
                                        },
                                      },
                                    ],
                                    "location": 184,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "A_Expr": {
                                    "kind": "AEXPR_OP",
                                    "lexpr": {
                                      "FuncCall": {
                                        "funcformat": "COERCE_EXPLICIT_CALL",
                                        "funcname": [
                                          {
                                            "String": {
                                              "sval": "random",
                                            },
                                          },
                                        ],
                                        "location": 194,
                                      },
                                    },
                                    "location": 203,
                                    "name": [
                                      {
                                        "String": {
                                          "sval": "+",
                                        },
                                      },
                                    ],
                                    "rexpr": {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1,
                                        },
                                        "location": 205,
                                      },
                                    },
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 162,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 158,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 579 1`] = `
[
  "select array_agg(distinct val)
from (select null as val from generate_series(1, 2))",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "subquery": {
                    "SelectStmt": {
                      "fromClause": [
                        {
                          "RangeFunction": {
                            "functions": [
                              {
                                "List": {
                                  "items": [
                                    {
                                      "FuncCall": {
                                        "args": [
                                          {
                                            "A_Const": {
                                              "ival": {
                                                "ival": 1,
                                              },
                                              "location": 77,
                                            },
                                          },
                                          {
                                            "A_Const": {
                                              "ival": {
                                                "ival": 2,
                                              },
                                              "location": 80,
                                            },
                                          },
                                        ],
                                        "funcformat": "COERCE_EXPLICIT_CALL",
                                        "funcname": [
                                          {
                                            "String": {
                                              "sval": "generate_series",
                                            },
                                          },
                                        ],
                                        "location": 61,
                                      },
                                    },
                                    {},
                                  ],
                                },
                              },
                            ],
                          },
                        },
                      ],
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "targetList": [
                        {
                          "ResTarget": {
                            "location": 44,
                            "name": "val",
                            "val": {
                              "A_Const": {
                                "isnull": true,
                                "location": 44,
                              },
                            },
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "val",
                                },
                              },
                            ],
                            "location": 26,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "array_agg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 583 1`] = `
[
  "set enable_presorted_aggregate to off",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "args": [
              {
                "A_Const": {
                  "location": 34,
                  "sval": {
                    "sval": "off",
                  },
                },
              },
            ],
            "kind": "VAR_SET_VALUE",
            "name": "enable_presorted_aggregate",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 585 1`] = `
[
  "select sum(two order by two) from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 34,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "two",
                                    },
                                  },
                                ],
                                "location": 24,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "two",
                                },
                              },
                            ],
                            "location": 11,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 601 1`] = `
[
  "select array_agg(distinct a)
  from (values (1),(2),(1),(3),(null),(2)) v(a)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 45,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 49,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 53,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 57,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 61,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 68,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 26,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "array_agg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 617 1`] = `
[
  "select aggfstr(distinct a,b,c)
  from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c),
       generate_series(1,3) i",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                      {
                        "String": {
                          "sval": "b",
                        },
                      },
                      {
                        "String": {
                          "sval": "c",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 47,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 49,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 51,
                                  "sval": {
                                    "sval": "foo",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {},
                                  "location": 59,
                                },
                              },
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 61,
                                },
                              },
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 66,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 73,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 75,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 77,
                                  "sval": {
                                    "sval": "bar",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 85,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 87,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 89,
                                  "sval": {
                                    "sval": "baz",
                                  },
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "i",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 130,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 3,
                                    },
                                    "location": 132,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 114,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 24,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 26,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "c",
                                },
                              },
                            ],
                            "location": 28,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "aggfstr",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 624 1`] = `
[
  "select aggfstr(distinct a,b,c order by b)
  from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c),
       generate_series(1,3) i",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                      {
                        "String": {
                          "sval": "b",
                        },
                      },
                      {
                        "String": {
                          "sval": "c",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 58,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 60,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 62,
                                  "sval": {
                                    "sval": "foo",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {},
                                  "location": 70,
                                },
                              },
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 72,
                                },
                              },
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 77,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 84,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 86,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 88,
                                  "sval": {
                                    "sval": "bar",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 96,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 98,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 100,
                                  "sval": {
                                    "sval": "baz",
                                  },
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "i",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 141,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 3,
                                    },
                                    "location": 143,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 125,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 39,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 24,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 26,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "c",
                                },
                              },
                            ],
                            "location": 28,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "aggfstr",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 649 1`] = `
[
  "  select aggfns(a,b,c)
    from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                      {
                        "String": {
                          "sval": "b",
                        },
                      },
                      {
                        "String": {
                          "sval": "c",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 41,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 43,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 45,
                                  "sval": {
                                    "sval": "foo",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {},
                                  "location": 53,
                                },
                              },
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 55,
                                },
                              },
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 60,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 67,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 69,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 71,
                                  "sval": {
                                    "sval": "bar",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 79,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 81,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 83,
                                  "sval": {
                                    "sval": "baz",
                                  },
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 16,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 18,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "c",
                                },
                              },
                            ],
                            "location": 20,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "aggfns",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 652 1`] = `
[
  "select * from agg_view1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "agg_view1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 655 1`] = `
[
  "create or replace view agg_view1 as
  select aggfns(distinct a,b,c)
    from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c),
         generate_series(1,3) i",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "v",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                          {
                            "String": {
                              "sval": "c",
                            },
                          },
                        ],
                      },
                      "subquery": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "valuesLists": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 86,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 88,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 90,
                                      "sval": {
                                        "sval": "foo",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {},
                                      "location": 98,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 100,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 105,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 112,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 114,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 116,
                                      "sval": {
                                        "sval": "bar",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 124,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 126,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 128,
                                      "sval": {
                                        "sval": "baz",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                  {
                    "RangeFunction": {
                      "alias": {
                        "aliasname": "i",
                      },
                      "functions": [
                        {
                          "List": {
                            "items": [
                              {
                                "FuncCall": {
                                  "args": [
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1,
                                        },
                                        "location": 171,
                                      },
                                    },
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 3,
                                        },
                                        "location": 173,
                                      },
                                    },
                                  ],
                                  "funcformat": "COERCE_EXPLICIT_CALL",
                                  "funcname": [
                                    {
                                      "String": {
                                        "sval": "generate_series",
                                      },
                                    },
                                  ],
                                  "location": 155,
                                },
                              },
                              {},
                            ],
                          },
                        },
                      ],
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 45,
                      "val": {
                        "FuncCall": {
                          "agg_distinct": true,
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 61,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 63,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "c",
                                    },
                                  },
                                ],
                                "location": 65,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "aggfns",
                              },
                            },
                          ],
                          "location": 45,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "replace": true,
            "view": {
              "inh": true,
              "location": 23,
              "relname": "agg_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 663 1`] = `
[
  "create or replace view agg_view1 as
  select aggfns(distinct a,b,c order by b)
    from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c),
         generate_series(1,3) i",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "v",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                          {
                            "String": {
                              "sval": "c",
                            },
                          },
                        ],
                      },
                      "subquery": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "valuesLists": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 97,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 99,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 101,
                                      "sval": {
                                        "sval": "foo",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {},
                                      "location": 109,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 111,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 116,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 123,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 125,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 127,
                                      "sval": {
                                        "sval": "bar",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 135,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 137,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 139,
                                      "sval": {
                                        "sval": "baz",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                  {
                    "RangeFunction": {
                      "alias": {
                        "aliasname": "i",
                      },
                      "functions": [
                        {
                          "List": {
                            "items": [
                              {
                                "FuncCall": {
                                  "args": [
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1,
                                        },
                                        "location": 182,
                                      },
                                    },
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 3,
                                        },
                                        "location": 184,
                                      },
                                    },
                                  ],
                                  "funcformat": "COERCE_EXPLICIT_CALL",
                                  "funcname": [
                                    {
                                      "String": {
                                        "sval": "generate_series",
                                      },
                                    },
                                  ],
                                  "location": 166,
                                },
                              },
                              {},
                            ],
                          },
                        },
                      ],
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 45,
                      "val": {
                        "FuncCall": {
                          "agg_distinct": true,
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "b",
                                        },
                                      },
                                    ],
                                    "location": 76,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 61,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 63,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "c",
                                    },
                                  },
                                ],
                                "location": 65,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "aggfns",
                              },
                            },
                          ],
                          "location": 45,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "replace": true,
            "view": {
              "inh": true,
              "location": 23,
              "relname": "agg_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 671 1`] = `
[
  "create or replace view agg_view1 as
  select aggfns(a,b,c order by b+1)
    from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c)",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "v",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                          {
                            "String": {
                              "sval": "c",
                            },
                          },
                        ],
                      },
                      "subquery": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "valuesLists": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 90,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 92,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 94,
                                      "sval": {
                                        "sval": "foo",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {},
                                      "location": 102,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 104,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 109,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 116,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 118,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 120,
                                      "sval": {
                                        "sval": "bar",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 128,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 130,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 132,
                                      "sval": {
                                        "sval": "baz",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 45,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "A_Expr": {
                                    "kind": "AEXPR_OP",
                                    "lexpr": {
                                      "ColumnRef": {
                                        "fields": [
                                          {
                                            "String": {
                                              "sval": "b",
                                            },
                                          },
                                        ],
                                        "location": 67,
                                      },
                                    },
                                    "location": 68,
                                    "name": [
                                      {
                                        "String": {
                                          "sval": "+",
                                        },
                                      },
                                    ],
                                    "rexpr": {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1,
                                        },
                                        "location": 69,
                                      },
                                    },
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 52,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 54,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "c",
                                    },
                                  },
                                ],
                                "location": 56,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "aggfns",
                              },
                            },
                          ],
                          "location": 45,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "replace": true,
            "view": {
              "inh": true,
              "location": 23,
              "relname": "agg_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 678 1`] = `
[
  "create or replace view agg_view1 as
  select aggfns(a,a,c order by b)
    from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c)",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "v",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                          {
                            "String": {
                              "sval": "c",
                            },
                          },
                        ],
                      },
                      "subquery": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "valuesLists": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 88,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 90,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 92,
                                      "sval": {
                                        "sval": "foo",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {},
                                      "location": 100,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 102,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 107,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 114,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 116,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 118,
                                      "sval": {
                                        "sval": "bar",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 126,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 128,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 130,
                                      "sval": {
                                        "sval": "baz",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 45,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "b",
                                        },
                                      },
                                    ],
                                    "location": 67,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 52,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 54,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "c",
                                    },
                                  },
                                ],
                                "location": 56,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "aggfns",
                              },
                            },
                          ],
                          "location": 45,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "replace": true,
            "view": {
              "inh": true,
              "location": 23,
              "relname": "agg_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 685 1`] = `
[
  "create or replace view agg_view1 as
  select aggfns(a,b,c order by c using ~<~)
    from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c)",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "v",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                          {
                            "String": {
                              "sval": "c",
                            },
                          },
                        ],
                      },
                      "subquery": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "valuesLists": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 98,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 100,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 102,
                                      "sval": {
                                        "sval": "foo",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {},
                                      "location": 110,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 112,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 117,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 124,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 126,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 128,
                                      "sval": {
                                        "sval": "bar",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 136,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 138,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 140,
                                      "sval": {
                                        "sval": "baz",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 45,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": 75,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "c",
                                        },
                                      },
                                    ],
                                    "location": 67,
                                  },
                                },
                                "sortby_dir": "SORTBY_USING",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                                "useOp": [
                                  {
                                    "String": {
                                      "sval": "~<~",
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 52,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 54,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "c",
                                    },
                                  },
                                ],
                                "location": 56,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "aggfns",
                              },
                            },
                          ],
                          "location": 45,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "replace": true,
            "view": {
              "inh": true,
              "location": 23,
              "relname": "agg_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 692 1`] = `
[
  "create or replace view agg_view1 as
  select aggfns(distinct a,b,c order by a,c using ~<~,b)
    from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c),
         generate_series(1,2) i",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "v",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                          {
                            "String": {
                              "sval": "c",
                            },
                          },
                        ],
                      },
                      "subquery": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "valuesLists": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 111,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 113,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 115,
                                      "sval": {
                                        "sval": "foo",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {},
                                      "location": 123,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 125,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "isnull": true,
                                      "location": 130,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 137,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 2,
                                      },
                                      "location": 139,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 141,
                                      "sval": {
                                        "sval": "bar",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 3,
                                      },
                                      "location": 149,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 151,
                                    },
                                  },
                                  {
                                    "A_Const": {
                                      "location": 153,
                                      "sval": {
                                        "sval": "baz",
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                  {
                    "RangeFunction": {
                      "alias": {
                        "aliasname": "i",
                      },
                      "functions": [
                        {
                          "List": {
                            "items": [
                              {
                                "FuncCall": {
                                  "args": [
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1,
                                        },
                                        "location": 196,
                                      },
                                    },
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 2,
                                        },
                                        "location": 198,
                                      },
                                    },
                                  ],
                                  "funcformat": "COERCE_EXPLICIT_CALL",
                                  "funcname": [
                                    {
                                      "String": {
                                        "sval": "generate_series",
                                      },
                                    },
                                  ],
                                  "location": 180,
                                },
                              },
                              {},
                            ],
                          },
                        },
                      ],
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 45,
                      "val": {
                        "FuncCall": {
                          "agg_distinct": true,
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "a",
                                        },
                                      },
                                    ],
                                    "location": 76,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                            {
                              "SortBy": {
                                "location": 86,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "c",
                                        },
                                      },
                                    ],
                                    "location": 78,
                                  },
                                },
                                "sortby_dir": "SORTBY_USING",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                                "useOp": [
                                  {
                                    "String": {
                                      "sval": "~<~",
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "b",
                                        },
                                      },
                                    ],
                                    "location": 90,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 61,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 63,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "c",
                                    },
                                  },
                                ],
                                "location": 65,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "aggfns",
                              },
                            },
                          ],
                          "location": 45,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "replace": true,
            "view": {
              "inh": true,
              "location": 23,
              "relname": "agg_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 700 1`] = `
[
  "drop view agg_view1",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "agg_view1",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 714 1`] = `
[
  "select string_agg(a,',') from (values('aaaa'),('bbbb'),('cccc')) g(a)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "g",
                    "colnames": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 38,
                                  "sval": {
                                    "sval": "aaaa",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 47,
                                  "sval": {
                                    "sval": "bbbb",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 56,
                                  "sval": {
                                    "sval": "cccc",
                                  },
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 18,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 20,
                            "sval": {
                              "sval": ",",
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "string_agg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 720 1`] = `
[
  "select string_agg(distinct f1, ',' order by f1) from varchar_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 53,
                  "relname": "varchar_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "f1",
                                    },
                                  },
                                ],
                                "location": 44,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "f1",
                                },
                              },
                            ],
                            "location": 27,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 31,
                            "sval": {
                              "sval": ",",
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "string_agg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 720 2`] = `
[
  "  -- ok
select string_agg(distinct f1::text, ',' order by f1) from varchar_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 67,
                  "relname": "varchar_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 15,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "f1",
                                    },
                                  },
                                ],
                                "location": 58,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "f1",
                                    },
                                  },
                                ],
                                "location": 35,
                              },
                            },
                            "location": 37,
                            "typeName": {
                              "location": 39,
                              "names": [
                                {
                                  "String": {
                                    "sval": "text",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "location": 45,
                            "sval": {
                              "sval": ",",
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "string_agg",
                          },
                        },
                      ],
                      "location": 15,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 721 1`] = `
[
  "  -- not ok
select string_agg(distinct f1, ',' order by f1::text) from varchar_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 71,
                  "relname": "varchar_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "f1",
                                        },
                                      },
                                    ],
                                    "location": 56,
                                  },
                                },
                                "location": 58,
                                "typeName": {
                                  "location": 60,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "text",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "f1",
                                },
                              },
                            ],
                            "location": 39,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 43,
                            "sval": {
                              "sval": ",",
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "string_agg",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 722 1`] = `
[
  "  -- not ok
select string_agg(distinct f1::text, ',' order by f1::text) from varchar_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 77,
                  "relname": "varchar_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "f1",
                                        },
                                      },
                                    ],
                                    "location": 62,
                                  },
                                },
                                "location": 64,
                                "typeName": {
                                  "location": 66,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "text",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "f1",
                                    },
                                  },
                                ],
                                "location": 39,
                              },
                            },
                            "location": 41,
                            "typeName": {
                              "location": 43,
                              "names": [
                                {
                                  "String": {
                                    "sval": "text",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "location": 49,
                            "sval": {
                              "sval": ",",
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "string_agg",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 723 1`] = `
[
  "  -- ok

-- string_agg bytea tests
create table bytea_test_table(v bytea)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 48,
              "relname": "bytea_test_table",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "v",
                  "is_local": true,
                  "location": 65,
                  "typeName": {
                    "location": 67,
                    "names": [
                      {
                        "String": {
                          "sval": "bytea",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 728 1`] = `
[
  "select string_agg(v, '') from bytea_test_table",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 30,
                  "relname": "bytea_test_table",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "v",
                                },
                              },
                            ],
                            "location": 18,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 21,
                            "sval": {
                              "sval": "",
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "string_agg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 730 1`] = `
[
  "insert into bytea_test_table values(decode('ff','hex'))",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "bytea_test_table",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "FuncCall": {
                            "args": [
                              {
                                "A_Const": {
                                  "location": 43,
                                  "sval": {
                                    "sval": "ff",
                                  },
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 48,
                                  "sval": {
                                    "sval": "hex",
                                  },
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "decode",
                                },
                              },
                            ],
                            "location": 36,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 740 1`] = `
[
  "drop table bytea_test_table",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "bytea_test_table",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 743 1`] = `
[
  "create table pagg_test (x int, y int)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pagg_test",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "x",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 26,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "y",
                  "is_local": true,
                  "location": 31,
                  "typeName": {
                    "location": 33,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 745 1`] = `
[
  "select (case x % 4 when 1 then null else x end), x % 10
from generate_series(1,5000) x",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "x",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 77,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 5000,
                                    },
                                    "location": 79,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 61,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "CaseExpr": {
                      "arg": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "x",
                                  },
                                },
                              ],
                              "location": 13,
                            },
                          },
                          "location": 15,
                          "name": [
                            {
                              "String": {
                                "sval": "%",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 4,
                              },
                              "location": 17,
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "CaseWhen": {
                            "expr": {
                              "A_Const": {
                                "ival": {
                                  "ival": 1,
                                },
                                "location": 24,
                              },
                            },
                            "location": 19,
                            "result": {
                              "A_Const": {
                                "isnull": true,
                                "location": 31,
                              },
                            },
                          },
                        },
                      ],
                      "defresult": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "x",
                              },
                            },
                          ],
                          "location": 41,
                        },
                      },
                      "location": 8,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 49,
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "x",
                              },
                            },
                          ],
                          "location": 49,
                        },
                      },
                      "location": 51,
                      "name": [
                        {
                          "String": {
                            "sval": "%",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10,
                          },
                          "location": 53,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 748 1`] = `
[
  "set parallel_setup_cost TO 0",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "args": [
              {
                "A_Const": {
                  "ival": {},
                  "location": 27,
                },
              },
            ],
            "kind": "VAR_SET_VALUE",
            "name": "parallel_setup_cost",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 756 1`] = `
[
  "create view v_pagg_test AS
select
	y,
	min(t) AS tmin,max(t) AS tmax,count(distinct t) AS tndistinct,
	min(b) AS bmin,max(b) AS bmax,count(distinct b) AS bndistinct,
	min(a) AS amin,max(a) AS amax,count(distinct a) AS andistinct,
	min(aa) AS aamin,max(aa) AS aamax,count(distinct aa) AS aandistinct
from (
	select
		y,
		unnest(regexp_split_to_array(a1.t, ','))::int AS t,
		unnest(regexp_split_to_array(a1.b::text, ',')) AS b,
		unnest(a1.a) AS a,
		unnest(a1.aa) AS aa
	from (
		select
			y,
			string_agg(x::text, ',') AS t,
			string_agg(x::text::bytea, ',') AS b,
			array_agg(x) AS a,
			array_agg(ARRAY[x]) AS aa
		from pagg_test
		group by y
	) a1
) a2
group by y",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "a2",
                      },
                      "subquery": {
                        "SelectStmt": {
                          "fromClause": [
                            {
                              "RangeSubselect": {
                                "alias": {
                                  "aliasname": "a1",
                                },
                                "subquery": {
                                  "SelectStmt": {
                                    "fromClause": [
                                      {
                                        "RangeVar": {
                                          "inh": true,
                                          "location": 627,
                                          "relname": "pagg_test",
                                          "relpersistence": "p",
                                        },
                                      },
                                    ],
                                    "groupClause": [
                                      {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "String": {
                                                "sval": "y",
                                              },
                                            },
                                          ],
                                          "location": 648,
                                        },
                                      },
                                    ],
                                    "limitOption": "LIMIT_OPTION_DEFAULT",
                                    "op": "SETOP_NONE",
                                    "targetList": [
                                      {
                                        "ResTarget": {
                                          "location": 491,
                                          "val": {
                                            "ColumnRef": {
                                              "fields": [
                                                {
                                                  "String": {
                                                    "sval": "y",
                                                  },
                                                },
                                              ],
                                              "location": 491,
                                            },
                                          },
                                        },
                                      },
                                      {
                                        "ResTarget": {
                                          "location": 497,
                                          "name": "t",
                                          "val": {
                                            "FuncCall": {
                                              "args": [
                                                {
                                                  "TypeCast": {
                                                    "arg": {
                                                      "ColumnRef": {
                                                        "fields": [
                                                          {
                                                            "String": {
                                                              "sval": "x",
                                                            },
                                                          },
                                                        ],
                                                        "location": 508,
                                                      },
                                                    },
                                                    "location": 509,
                                                    "typeName": {
                                                      "location": 511,
                                                      "names": [
                                                        {
                                                          "String": {
                                                            "sval": "text",
                                                          },
                                                        },
                                                      ],
                                                      "typemod": -1,
                                                    },
                                                  },
                                                },
                                                {
                                                  "A_Const": {
                                                    "location": 517,
                                                    "sval": {
                                                      "sval": ",",
                                                    },
                                                  },
                                                },
                                              ],
                                              "funcformat": "COERCE_EXPLICIT_CALL",
                                              "funcname": [
                                                {
                                                  "String": {
                                                    "sval": "string_agg",
                                                  },
                                                },
                                              ],
                                              "location": 497,
                                            },
                                          },
                                        },
                                      },
                                      {
                                        "ResTarget": {
                                          "location": 531,
                                          "name": "b",
                                          "val": {
                                            "FuncCall": {
                                              "args": [
                                                {
                                                  "TypeCast": {
                                                    "arg": {
                                                      "TypeCast": {
                                                        "arg": {
                                                          "ColumnRef": {
                                                            "fields": [
                                                              {
                                                                "String": {
                                                                  "sval": "x",
                                                                },
                                                              },
                                                            ],
                                                            "location": 542,
                                                          },
                                                        },
                                                        "location": 543,
                                                        "typeName": {
                                                          "location": 545,
                                                          "names": [
                                                            {
                                                              "String": {
                                                                "sval": "text",
                                                              },
                                                            },
                                                          ],
                                                          "typemod": -1,
                                                        },
                                                      },
                                                    },
                                                    "location": 549,
                                                    "typeName": {
                                                      "location": 551,
                                                      "names": [
                                                        {
                                                          "String": {
                                                            "sval": "bytea",
                                                          },
                                                        },
                                                      ],
                                                      "typemod": -1,
                                                    },
                                                  },
                                                },
                                                {
                                                  "A_Const": {
                                                    "location": 558,
                                                    "sval": {
                                                      "sval": ",",
                                                    },
                                                  },
                                                },
                                              ],
                                              "funcformat": "COERCE_EXPLICIT_CALL",
                                              "funcname": [
                                                {
                                                  "String": {
                                                    "sval": "string_agg",
                                                  },
                                                },
                                              ],
                                              "location": 531,
                                            },
                                          },
                                        },
                                      },
                                      {
                                        "ResTarget": {
                                          "location": 572,
                                          "name": "a",
                                          "val": {
                                            "FuncCall": {
                                              "args": [
                                                {
                                                  "ColumnRef": {
                                                    "fields": [
                                                      {
                                                        "String": {
                                                          "sval": "x",
                                                        },
                                                      },
                                                    ],
                                                    "location": 582,
                                                  },
                                                },
                                              ],
                                              "funcformat": "COERCE_EXPLICIT_CALL",
                                              "funcname": [
                                                {
                                                  "String": {
                                                    "sval": "array_agg",
                                                  },
                                                },
                                              ],
                                              "location": 572,
                                            },
                                          },
                                        },
                                      },
                                      {
                                        "ResTarget": {
                                          "location": 594,
                                          "name": "aa",
                                          "val": {
                                            "FuncCall": {
                                              "args": [
                                                {
                                                  "A_ArrayExpr": {
                                                    "elements": [
                                                      {
                                                        "ColumnRef": {
                                                          "fields": [
                                                            {
                                                              "String": {
                                                                "sval": "x",
                                                              },
                                                            },
                                                          ],
                                                          "location": 610,
                                                        },
                                                      },
                                                    ],
                                                    "location": 604,
                                                  },
                                                },
                                              ],
                                              "funcformat": "COERCE_EXPLICIT_CALL",
                                              "funcname": [
                                                {
                                                  "String": {
                                                    "sval": "array_agg",
                                                  },
                                                },
                                              ],
                                              "location": 594,
                                            },
                                          },
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 316,
                                "val": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "y",
                                        },
                                      },
                                    ],
                                    "location": 316,
                                  },
                                },
                              },
                            },
                            {
                              "ResTarget": {
                                "location": 321,
                                "name": "t",
                                "val": {
                                  "TypeCast": {
                                    "arg": {
                                      "FuncCall": {
                                        "args": [
                                          {
                                            "FuncCall": {
                                              "args": [
                                                {
                                                  "ColumnRef": {
                                                    "fields": [
                                                      {
                                                        "String": {
                                                          "sval": "a1",
                                                        },
                                                      },
                                                      {
                                                        "String": {
                                                          "sval": "t",
                                                        },
                                                      },
                                                    ],
                                                    "location": 350,
                                                  },
                                                },
                                                {
                                                  "A_Const": {
                                                    "location": 356,
                                                    "sval": {
                                                      "sval": ",",
                                                    },
                                                  },
                                                },
                                              ],
                                              "funcformat": "COERCE_EXPLICIT_CALL",
                                              "funcname": [
                                                {
                                                  "String": {
                                                    "sval": "regexp_split_to_array",
                                                  },
                                                },
                                              ],
                                              "location": 328,
                                            },
                                          },
                                        ],
                                        "funcformat": "COERCE_EXPLICIT_CALL",
                                        "funcname": [
                                          {
                                            "String": {
                                              "sval": "unnest",
                                            },
                                          },
                                        ],
                                        "location": 321,
                                      },
                                    },
                                    "location": 361,
                                    "typeName": {
                                      "location": 363,
                                      "names": [
                                        {
                                          "String": {
                                            "sval": "pg_catalog",
                                          },
                                        },
                                        {
                                          "String": {
                                            "sval": "int4",
                                          },
                                        },
                                      ],
                                      "typemod": -1,
                                    },
                                  },
                                },
                              },
                            },
                            {
                              "ResTarget": {
                                "location": 375,
                                "name": "b",
                                "val": {
                                  "FuncCall": {
                                    "args": [
                                      {
                                        "FuncCall": {
                                          "args": [
                                            {
                                              "TypeCast": {
                                                "arg": {
                                                  "ColumnRef": {
                                                    "fields": [
                                                      {
                                                        "String": {
                                                          "sval": "a1",
                                                        },
                                                      },
                                                      {
                                                        "String": {
                                                          "sval": "b",
                                                        },
                                                      },
                                                    ],
                                                    "location": 404,
                                                  },
                                                },
                                                "location": 408,
                                                "typeName": {
                                                  "location": 410,
                                                  "names": [
                                                    {
                                                      "String": {
                                                        "sval": "text",
                                                      },
                                                    },
                                                  ],
                                                  "typemod": -1,
                                                },
                                              },
                                            },
                                            {
                                              "A_Const": {
                                                "location": 416,
                                                "sval": {
                                                  "sval": ",",
                                                },
                                              },
                                            },
                                          ],
                                          "funcformat": "COERCE_EXPLICIT_CALL",
                                          "funcname": [
                                            {
                                              "String": {
                                                "sval": "regexp_split_to_array",
                                              },
                                            },
                                          ],
                                          "location": 382,
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "unnest",
                                        },
                                      },
                                    ],
                                    "location": 375,
                                  },
                                },
                              },
                            },
                            {
                              "ResTarget": {
                                "location": 430,
                                "name": "a",
                                "val": {
                                  "FuncCall": {
                                    "args": [
                                      {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "String": {
                                                "sval": "a1",
                                              },
                                            },
                                            {
                                              "String": {
                                                "sval": "a",
                                              },
                                            },
                                          ],
                                          "location": 437,
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "unnest",
                                        },
                                      },
                                    ],
                                    "location": 430,
                                  },
                                },
                              },
                            },
                            {
                              "ResTarget": {
                                "location": 451,
                                "name": "aa",
                                "val": {
                                  "FuncCall": {
                                    "args": [
                                      {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "String": {
                                                "sval": "a1",
                                              },
                                            },
                                            {
                                              "String": {
                                                "sval": "aa",
                                              },
                                            },
                                          ],
                                          "location": 458,
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "unnest",
                                        },
                                      },
                                    ],
                                    "location": 451,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "y",
                          },
                        },
                      ],
                      "location": 670,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 35,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "y",
                              },
                            },
                          ],
                          "location": 35,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 39,
                      "name": "tmin",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "t",
                                    },
                                  },
                                ],
                                "location": 43,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 39,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 54,
                      "name": "tmax",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "t",
                                    },
                                  },
                                ],
                                "location": 58,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 54,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 69,
                      "name": "tndistinct",
                      "val": {
                        "FuncCall": {
                          "agg_distinct": true,
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "t",
                                    },
                                  },
                                ],
                                "location": 84,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 69,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 103,
                      "name": "bmin",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 107,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 103,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 118,
                      "name": "bmax",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 122,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 118,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 133,
                      "name": "bndistinct",
                      "val": {
                        "FuncCall": {
                          "agg_distinct": true,
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 148,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 133,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 167,
                      "name": "amin",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 171,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 167,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 182,
                      "name": "amax",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 186,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 182,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 197,
                      "name": "andistinct",
                      "val": {
                        "FuncCall": {
                          "agg_distinct": true,
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 212,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 197,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 231,
                      "name": "aamin",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "aa",
                                    },
                                  },
                                ],
                                "location": 235,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "min",
                              },
                            },
                          ],
                          "location": 231,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 248,
                      "name": "aamax",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "aa",
                                    },
                                  },
                                ],
                                "location": 252,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "max",
                              },
                            },
                          ],
                          "location": 248,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 265,
                      "name": "aandistinct",
                      "val": {
                        "FuncCall": {
                          "agg_distinct": true,
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "aa",
                                    },
                                  },
                                ],
                                "location": 280,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 265,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "v_pagg_test",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 784 1`] = `
[
  "select * from v_pagg_test order by y",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "v_pagg_test",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "y",
                          },
                        },
                      ],
                      "location": 35,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 787 1`] = `
[
  "explain (costs off) select * from v_pagg_test order by y",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 34,
                      "relname": "v_pagg_test",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "sortClause": [
                  {
                    "SortBy": {
                      "location": -1,
                      "node": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "y",
                              },
                            },
                          ],
                          "location": 55,
                        },
                      },
                      "sortby_dir": "SORTBY_DEFAULT",
                      "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                    },
                  },
                ],
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 789 1`] = `
[
  "set max_parallel_workers_per_gather = 0",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "args": [
              {
                "A_Const": {
                  "ival": {},
                  "location": 38,
                },
              },
            ],
            "kind": "VAR_SET_VALUE",
            "name": "max_parallel_workers_per_gather",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 795 1`] = `
[
  "reset max_parallel_workers_per_gather",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "kind": "VAR_RESET",
            "name": "max_parallel_workers_per_gather",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 802 1`] = `
[
  "drop view v_pagg_test",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "v_pagg_test",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 809 1`] = `
[
  "select sum(1/ten) filter (where ten > 0) from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 46,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_filter": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "ten",
                                  },
                                },
                              ],
                              "location": 32,
                            },
                          },
                          "location": 36,
                          "name": [
                            {
                              "String": {
                                "sval": ">",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {},
                              "location": 38,
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "A_Expr": {
                            "kind": "AEXPR_OP",
                            "lexpr": {
                              "A_Const": {
                                "ival": {
                                  "ival": 1,
                                },
                                "location": 11,
                              },
                            },
                            "location": 12,
                            "name": [
                              {
                                "String": {
                                  "sval": "/",
                                },
                              },
                            ],
                            "rexpr": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "ten",
                                    },
                                  },
                                ],
                                "location": 13,
                              },
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 811 1`] = `
[
  "select ten, sum(distinct four) filter (where four::text ~ '123') from onek a
group by ten",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "alias": {
                    "aliasname": "a",
                  },
                  "inh": true,
                  "location": 70,
                  "relname": "onek",
                  "relpersistence": "p",
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "ten",
                      },
                    },
                  ],
                  "location": 86,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 12,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "agg_filter": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "TypeCast": {
                              "arg": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "four",
                                      },
                                    },
                                  ],
                                  "location": 45,
                                },
                              },
                              "location": 49,
                              "typeName": {
                                "location": 51,
                                "names": [
                                  {
                                    "String": {
                                      "sval": "text",
                                    },
                                  },
                                ],
                                "typemod": -1,
                              },
                            },
                          },
                          "location": 56,
                          "name": [
                            {
                              "String": {
                                "sval": "~",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "location": 58,
                              "sval": {
                                "sval": "123",
                              },
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 25,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 12,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 814 1`] = `
[
  "select ten, sum(distinct four) filter (where four > 10) from onek a
group by ten
having exists (select 1 from onek b where sum(distinct a.four) = b.four)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "alias": {
                    "aliasname": "a",
                  },
                  "inh": true,
                  "location": 61,
                  "relname": "onek",
                  "relpersistence": "p",
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "ten",
                      },
                    },
                  ],
                  "location": 77,
                },
              },
            ],
            "havingClause": {
              "SubLink": {
                "location": 88,
                "subLinkType": "EXISTS_SUBLINK",
                "subselect": {
                  "SelectStmt": {
                    "fromClause": [
                      {
                        "RangeVar": {
                          "alias": {
                            "aliasname": "b",
                          },
                          "inh": true,
                          "location": 110,
                          "relname": "onek",
                          "relpersistence": "p",
                        },
                      },
                    ],
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "targetList": [
                      {
                        "ResTarget": {
                          "location": 103,
                          "val": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 103,
                            },
                          },
                        },
                      },
                    ],
                    "whereClause": {
                      "A_Expr": {
                        "kind": "AEXPR_OP",
                        "lexpr": {
                          "FuncCall": {
                            "agg_distinct": true,
                            "args": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "a",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "four",
                                      },
                                    },
                                  ],
                                  "location": 136,
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "sum",
                                },
                              },
                            ],
                            "location": 123,
                          },
                        },
                        "location": 144,
                        "name": [
                          {
                            "String": {
                              "sval": "=",
                            },
                          },
                        ],
                        "rexpr": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 146,
                          },
                        },
                      },
                    },
                  },
                },
              },
            },
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 12,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "agg_filter": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "four",
                                  },
                                },
                              ],
                              "location": 45,
                            },
                          },
                          "location": 50,
                          "name": [
                            {
                              "String": {
                                "sval": ">",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 10,
                              },
                              "location": 52,
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "four",
                                },
                              },
                            ],
                            "location": 25,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 12,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 818 1`] = `
[
  "select max(foo COLLATE "C") filter (where (bar collate "POSIX") > '0')
from (values ('a', 'b')) AS v(foo,bar)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "foo",
                        },
                      },
                      {
                        "String": {
                          "sval": "bar",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 85,
                                  "sval": {
                                    "sval": "a",
                                  },
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 90,
                                  "sval": {
                                    "sval": "b",
                                  },
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_filter": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "CollateClause": {
                              "arg": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "bar",
                                      },
                                    },
                                  ],
                                  "location": 43,
                                },
                              },
                              "collname": [
                                {
                                  "String": {
                                    "sval": "POSIX",
                                  },
                                },
                              ],
                              "location": 47,
                            },
                          },
                          "location": 64,
                          "name": [
                            {
                              "String": {
                                "sval": ">",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "location": 66,
                              "sval": {
                                "sval": "0",
                              },
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "CollateClause": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "foo",
                                    },
                                  },
                                ],
                                "location": 11,
                              },
                            },
                            "collname": [
                              {
                                "String": {
                                  "sval": "C",
                                },
                              },
                            ],
                            "location": 15,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 821 1`] = `
[
  "select any_value(v) filter (where v > 2) from (values (1), (2), (3)) as v (v)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "v",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 55,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 60,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 65,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_filter": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "v",
                                  },
                                },
                              ],
                              "location": 34,
                            },
                          },
                          "location": 36,
                          "name": [
                            {
                              "String": {
                                "sval": ">",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 2,
                              },
                              "location": 38,
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "v",
                                },
                              },
                            ],
                            "location": 17,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "any_value",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 824 1`] = `
[
  "select (select count(*)
        from (values (1)) t0(inner_c))
from (values (2),(3)) t1(outer_c)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t1",
                    "colnames": [
                      {
                        "String": {
                          "sval": "outer_c",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 77,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 81,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "SubLink": {
                      "location": 7,
                      "subLinkType": "EXPR_SUBLINK",
                      "subselect": {
                        "SelectStmt": {
                          "fromClause": [
                            {
                              "RangeSubselect": {
                                "alias": {
                                  "aliasname": "t0",
                                  "colnames": [
                                    {
                                      "String": {
                                        "sval": "inner_c",
                                      },
                                    },
                                  ],
                                },
                                "subquery": {
                                  "SelectStmt": {
                                    "limitOption": "LIMIT_OPTION_DEFAULT",
                                    "op": "SETOP_NONE",
                                    "valuesLists": [
                                      {
                                        "List": {
                                          "items": [
                                            {
                                              "A_Const": {
                                                "ival": {
                                                  "ival": 1,
                                                },
                                                "location": 46,
                                              },
                                            },
                                          ],
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 15,
                                "val": {
                                  "FuncCall": {
                                    "agg_star": true,
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "count",
                                        },
                                      },
                                    ],
                                    "location": 15,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 826 1`] = `
[
  " -- inner query is aggregation query
select (select count(*) filter (where outer_c <> 0)
        from (values (1)) t0(inner_c))
from (values (2),(3)) t1(outer_c)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t1",
                    "colnames": [
                      {
                        "String": {
                          "sval": "outer_c",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 142,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 146,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 44,
                  "val": {
                    "SubLink": {
                      "location": 44,
                      "subLinkType": "EXPR_SUBLINK",
                      "subselect": {
                        "SelectStmt": {
                          "fromClause": [
                            {
                              "RangeSubselect": {
                                "alias": {
                                  "aliasname": "t0",
                                  "colnames": [
                                    {
                                      "String": {
                                        "sval": "inner_c",
                                      },
                                    },
                                  ],
                                },
                                "subquery": {
                                  "SelectStmt": {
                                    "limitOption": "LIMIT_OPTION_DEFAULT",
                                    "op": "SETOP_NONE",
                                    "valuesLists": [
                                      {
                                        "List": {
                                          "items": [
                                            {
                                              "A_Const": {
                                                "ival": {
                                                  "ival": 1,
                                                },
                                                "location": 111,
                                              },
                                            },
                                          ],
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 52,
                                "val": {
                                  "FuncCall": {
                                    "agg_filter": {
                                      "A_Expr": {
                                        "kind": "AEXPR_OP",
                                        "lexpr": {
                                          "ColumnRef": {
                                            "fields": [
                                              {
                                                "String": {
                                                  "sval": "outer_c",
                                                },
                                              },
                                            ],
                                            "location": 75,
                                          },
                                        },
                                        "location": 83,
                                        "name": [
                                          {
                                            "String": {
                                              "sval": "<>",
                                            },
                                          },
                                        ],
                                        "rexpr": {
                                          "A_Const": {
                                            "ival": {},
                                            "location": 86,
                                          },
                                        },
                                      },
                                    },
                                    "agg_star": true,
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "count",
                                        },
                                      },
                                    ],
                                    "location": 52,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 829 1`] = `
[
  " -- outer query is aggregation query
select (select count(inner_c) filter (where outer_c <> 0)
        from (values (1)) t0(inner_c))
from (values (2),(3)) t1(outer_c)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t1",
                    "colnames": [
                      {
                        "String": {
                          "sval": "outer_c",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 148,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 152,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 44,
                  "val": {
                    "SubLink": {
                      "location": 44,
                      "subLinkType": "EXPR_SUBLINK",
                      "subselect": {
                        "SelectStmt": {
                          "fromClause": [
                            {
                              "RangeSubselect": {
                                "alias": {
                                  "aliasname": "t0",
                                  "colnames": [
                                    {
                                      "String": {
                                        "sval": "inner_c",
                                      },
                                    },
                                  ],
                                },
                                "subquery": {
                                  "SelectStmt": {
                                    "limitOption": "LIMIT_OPTION_DEFAULT",
                                    "op": "SETOP_NONE",
                                    "valuesLists": [
                                      {
                                        "List": {
                                          "items": [
                                            {
                                              "A_Const": {
                                                "ival": {
                                                  "ival": 1,
                                                },
                                                "location": 117,
                                              },
                                            },
                                          ],
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 52,
                                "val": {
                                  "FuncCall": {
                                    "agg_filter": {
                                      "A_Expr": {
                                        "kind": "AEXPR_OP",
                                        "lexpr": {
                                          "ColumnRef": {
                                            "fields": [
                                              {
                                                "String": {
                                                  "sval": "outer_c",
                                                },
                                              },
                                            ],
                                            "location": 81,
                                          },
                                        },
                                        "location": 89,
                                        "name": [
                                          {
                                            "String": {
                                              "sval": "<>",
                                            },
                                          },
                                        ],
                                        "rexpr": {
                                          "A_Const": {
                                            "ival": {},
                                            "location": 92,
                                          },
                                        },
                                      },
                                    },
                                    "args": [
                                      {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "String": {
                                                "sval": "inner_c",
                                              },
                                            },
                                          ],
                                          "location": 58,
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "count",
                                        },
                                      },
                                    ],
                                    "location": 52,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 832 1`] = `
[
  " -- inner query is aggregation query
select
  (select max((select i.unique2 from tenk1 i where i.unique1 = o.unique1))
     filter (where o.unique1 < 10))
from tenk1 o",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "alias": {
                    "aliasname": "o",
                  },
                  "inh": true,
                  "location": 160,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 46,
                  "val": {
                    "SubLink": {
                      "location": 46,
                      "subLinkType": "EXPR_SUBLINK",
                      "subselect": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 54,
                                "val": {
                                  "FuncCall": {
                                    "agg_filter": {
                                      "A_Expr": {
                                        "kind": "AEXPR_OP",
                                        "lexpr": {
                                          "ColumnRef": {
                                            "fields": [
                                              {
                                                "String": {
                                                  "sval": "o",
                                                },
                                              },
                                              {
                                                "String": {
                                                  "sval": "unique1",
                                                },
                                              },
                                            ],
                                            "location": 138,
                                          },
                                        },
                                        "location": 148,
                                        "name": [
                                          {
                                            "String": {
                                              "sval": "<",
                                            },
                                          },
                                        ],
                                        "rexpr": {
                                          "A_Const": {
                                            "ival": {
                                              "ival": 10,
                                            },
                                            "location": 150,
                                          },
                                        },
                                      },
                                    },
                                    "args": [
                                      {
                                        "SubLink": {
                                          "location": 58,
                                          "subLinkType": "EXPR_SUBLINK",
                                          "subselect": {
                                            "SelectStmt": {
                                              "fromClause": [
                                                {
                                                  "RangeVar": {
                                                    "alias": {
                                                      "aliasname": "i",
                                                    },
                                                    "inh": true,
                                                    "location": 81,
                                                    "relname": "tenk1",
                                                    "relpersistence": "p",
                                                  },
                                                },
                                              ],
                                              "limitOption": "LIMIT_OPTION_DEFAULT",
                                              "op": "SETOP_NONE",
                                              "targetList": [
                                                {
                                                  "ResTarget": {
                                                    "location": 66,
                                                    "val": {
                                                      "ColumnRef": {
                                                        "fields": [
                                                          {
                                                            "String": {
                                                              "sval": "i",
                                                            },
                                                          },
                                                          {
                                                            "String": {
                                                              "sval": "unique2",
                                                            },
                                                          },
                                                        ],
                                                        "location": 66,
                                                      },
                                                    },
                                                  },
                                                },
                                              ],
                                              "whereClause": {
                                                "A_Expr": {
                                                  "kind": "AEXPR_OP",
                                                  "lexpr": {
                                                    "ColumnRef": {
                                                      "fields": [
                                                        {
                                                          "String": {
                                                            "sval": "i",
                                                          },
                                                        },
                                                        {
                                                          "String": {
                                                            "sval": "unique1",
                                                          },
                                                        },
                                                      ],
                                                      "location": 95,
                                                    },
                                                  },
                                                  "location": 105,
                                                  "name": [
                                                    {
                                                      "String": {
                                                        "sval": "=",
                                                      },
                                                    },
                                                  ],
                                                  "rexpr": {
                                                    "ColumnRef": {
                                                      "fields": [
                                                        {
                                                          "String": {
                                                            "sval": "o",
                                                          },
                                                        },
                                                        {
                                                          "String": {
                                                            "sval": "unique1",
                                                          },
                                                        },
                                                      ],
                                                      "location": 107,
                                                    },
                                                  },
                                                },
                                              },
                                            },
                                          },
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "max",
                                        },
                                      },
                                    ],
                                    "location": 54,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 836 1`] = `
[
  "					-- outer query is aggregation query

-- subquery in FILTER clause (PostgreSQL extension)
select sum(unique1) FILTER (WHERE
  unique1 IN (SELECT unique1 FROM onek where unique1 < 100)) FROM tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 194,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 101,
                  "val": {
                    "FuncCall": {
                      "agg_filter": {
                        "SubLink": {
                          "location": 138,
                          "subLinkType": "ANY_SUBLINK",
                          "subselect": {
                            "SelectStmt": {
                              "fromClause": [
                                {
                                  "RangeVar": {
                                    "inh": true,
                                    "location": 162,
                                    "relname": "onek",
                                    "relpersistence": "p",
                                  },
                                },
                              ],
                              "limitOption": "LIMIT_OPTION_DEFAULT",
                              "op": "SETOP_NONE",
                              "targetList": [
                                {
                                  "ResTarget": {
                                    "location": 149,
                                    "val": {
                                      "ColumnRef": {
                                        "fields": [
                                          {
                                            "String": {
                                              "sval": "unique1",
                                            },
                                          },
                                        ],
                                        "location": 149,
                                      },
                                    },
                                  },
                                },
                              ],
                              "whereClause": {
                                "A_Expr": {
                                  "kind": "AEXPR_OP",
                                  "lexpr": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "unique1",
                                          },
                                        },
                                      ],
                                      "location": 173,
                                    },
                                  },
                                  "location": 181,
                                  "name": [
                                    {
                                      "String": {
                                        "sval": "<",
                                      },
                                    },
                                  ],
                                  "rexpr": {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 100,
                                      },
                                      "location": 183,
                                    },
                                  },
                                },
                              },
                            },
                          },
                          "testexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "unique1",
                                  },
                                },
                              ],
                              "location": 130,
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique1",
                                },
                              },
                            ],
                            "location": 105,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 101,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 843 1`] = `
[
  "select aggfns(distinct a,b,c order by a,c using ~<~,b) filter (where a > 1)
    from (values (1,3,'foo'),(0,null,null),(2,2,'bar'),(3,1,'baz')) v(a,b,c),
    generate_series(1,2) i",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                      {
                        "String": {
                          "sval": "b",
                        },
                      },
                      {
                        "String": {
                          "sval": "c",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 94,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 96,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 98,
                                  "sval": {
                                    "sval": "foo",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {},
                                  "location": 106,
                                },
                              },
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 108,
                                },
                              },
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 113,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 120,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 122,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 124,
                                  "sval": {
                                    "sval": "bar",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 132,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 134,
                                },
                              },
                              {
                                "A_Const": {
                                  "location": 136,
                                  "sval": {
                                    "sval": "baz",
                                  },
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "i",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 174,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 2,
                                    },
                                    "location": 176,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 158,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "agg_filter": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "location": 69,
                            },
                          },
                          "location": 71,
                          "name": [
                            {
                              "String": {
                                "sval": ">",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 73,
                            },
                          },
                        },
                      },
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 38,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                        {
                          "SortBy": {
                            "location": 48,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "c",
                                    },
                                  },
                                ],
                                "location": 40,
                              },
                            },
                            "sortby_dir": "SORTBY_USING",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                            "useOp": [
                              {
                                "String": {
                                  "sval": "~<~",
                                },
                              },
                            ],
                          },
                        },
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 52,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 23,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 25,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "c",
                                },
                              },
                            ],
                            "location": 27,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "aggfns",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 848 1`] = `
[
  "select max(0) filter (where b1) from bool_test",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 37,
                  "relname": "bool_test",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_filter": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b1",
                              },
                            },
                          ],
                          "location": 28,
                        },
                      },
                      "args": [
                        {
                          "A_Const": {
                            "ival": {},
                            "location": 11,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 852 1`] = `
[
  "select max(unique1) filter (where sum(ten) > 0) from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 53,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_filter": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "FuncCall": {
                              "args": [
                                {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "ten",
                                        },
                                      },
                                    ],
                                    "location": 38,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "sum",
                                  },
                                },
                              ],
                              "location": 34,
                            },
                          },
                          "location": 43,
                          "name": [
                            {
                              "String": {
                                "sval": ">",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {},
                              "location": 45,
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "unique1",
                                },
                              },
                            ],
                            "location": 11,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "max",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 870 1`] = `
[
  "select p, sum() within group (order by x::float8)  -- error
from generate_series(1,5) x,
     (values (0::float8),(0.1),(0.25),(0.4),(0.5),(0.6),(0.75),(0.9),(1)) v(p)
group by p order by p",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "x",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 81,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 5,
                                    },
                                    "location": 83,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 65,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "p",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "TypeCast": {
                                  "arg": {
                                    "A_Const": {
                                      "ival": {},
                                      "location": 103,
                                    },
                                  },
                                  "location": 104,
                                  "typeName": {
                                    "location": 106,
                                    "names": [
                                      {
                                        "String": {
                                          "sval": "float8",
                                        },
                                      },
                                    ],
                                    "typemod": -1,
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.1",
                                  },
                                  "location": 115,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.25",
                                  },
                                  "location": 121,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.4",
                                  },
                                  "location": 128,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.5",
                                  },
                                  "location": 134,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.6",
                                  },
                                  "location": 140,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.75",
                                  },
                                  "location": 146,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.9",
                                  },
                                  "location": 153,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 159,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "p",
                      },
                    },
                  ],
                  "location": 177,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "p",
                          },
                        },
                      ],
                      "location": 188,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "p",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 10,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "x",
                                        },
                                      },
                                    ],
                                    "location": 39,
                                  },
                                },
                                "location": 40,
                                "typeName": {
                                  "location": 42,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "float8",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 10,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 875 1`] = `
[
  "select p, percentile_cont(p,p)  -- error
from generate_series(1,5) x,
     (values (0::float8),(0.1),(0.25),(0.4),(0.5),(0.6),(0.75),(0.9),(1)) v(p)
group by p order by p",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "x",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 62,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 5,
                                    },
                                    "location": 64,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 46,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "p",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "TypeCast": {
                                  "arg": {
                                    "A_Const": {
                                      "ival": {},
                                      "location": 84,
                                    },
                                  },
                                  "location": 85,
                                  "typeName": {
                                    "location": 87,
                                    "names": [
                                      {
                                        "String": {
                                          "sval": "float8",
                                        },
                                      },
                                    ],
                                    "typemod": -1,
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.1",
                                  },
                                  "location": 96,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.25",
                                  },
                                  "location": 102,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.4",
                                  },
                                  "location": 109,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.5",
                                  },
                                  "location": 115,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.6",
                                  },
                                  "location": 121,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.75",
                                  },
                                  "location": 127,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.9",
                                  },
                                  "location": 134,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 140,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "p",
                      },
                    },
                  ],
                  "location": 158,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "p",
                          },
                        },
                      ],
                      "location": 169,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "p",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 10,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "p",
                                },
                              },
                            ],
                            "location": 26,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "p",
                                },
                              },
                            ],
                            "location": 28,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "percentile_cont",
                          },
                        },
                      ],
                      "location": 10,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 880 1`] = `
[
  "select percentile_cont(0.5) within group (order by b) from aggtest",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 59,
                  "relname": "aggtest",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 51,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "0.5",
                            },
                            "location": 23,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "percentile_cont",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 893 1`] = `
[
  "select percentile_disc(array[0,0.1,0.25,0.5,0.75,0.9,1]) within group (order by thousand)
from tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 95,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "thousand",
                                    },
                                  },
                                ],
                                "location": 80,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_ArrayExpr": {
                            "elements": [
                              {
                                "A_Const": {
                                  "ival": {},
                                  "location": 29,
                                },
                              },
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.1",
                                  },
                                  "location": 31,
                                },
                              },
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.25",
                                  },
                                  "location": 35,
                                },
                              },
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.5",
                                  },
                                  "location": 40,
                                },
                              },
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.75",
                                  },
                                  "location": 44,
                                },
                              },
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.9",
                                  },
                                  "location": 49,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 53,
                                },
                              },
                            ],
                            "location": 23,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "percentile_disc",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 902 1`] = `
[
  "select ten, mode() within group (order by string4) from tenk1 group by ten",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 56,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "ten",
                      },
                    },
                  ],
                  "location": 71,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 12,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "string4",
                                    },
                                  },
                                ],
                                "location": 42,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "mode",
                          },
                        },
                      ],
                      "location": 12,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 904 1`] = `
[
  "select percentile_disc(array[0.25,0.5,0.75]) within group (order by x)
from unnest('{fred,jim,fred,jack,jill,fred,jill,jim,jim,sheila,jim,sheila}'::text[]) u(x)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "u",
                    "colnames": [
                      {
                        "String": {
                          "sval": "x",
                        },
                      },
                    ],
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "TypeCast": {
                                    "arg": {
                                      "A_Const": {
                                        "location": 83,
                                        "sval": {
                                          "sval": "{fred,jim,fred,jack,jill,fred,jill,jim,jim,sheila,jim,sheila}",
                                        },
                                      },
                                    },
                                    "location": 146,
                                    "typeName": {
                                      "arrayBounds": [
                                        {
                                          "Integer": {},
                                        },
                                      ],
                                      "location": 148,
                                      "names": [
                                        {
                                          "String": {
                                            "sval": "text",
                                          },
                                        },
                                      ],
                                      "typemod": -1,
                                    },
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "unnest",
                                  },
                                },
                              ],
                              "location": 76,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 68,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_ArrayExpr": {
                            "elements": [
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.25",
                                  },
                                  "location": 29,
                                },
                              },
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.5",
                                  },
                                  "location": 34,
                                },
                              },
                              {
                                "A_Const": {
                                  "fval": {
                                    "fval": "0.75",
                                  },
                                  "location": 38,
                                },
                              },
                            ],
                            "location": 23,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "percentile_disc",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 908 1`] = `
[
  "select pg_collation_for(percentile_disc(1) within group (order by x collate "POSIX"))
  from (values ('fred'),('jim')) v(x)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "x",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 102,
                                  "sval": {
                                    "sval": "fred",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 111,
                                  "sval": {
                                    "sval": "jim",
                                  },
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "FuncCall": {
                            "agg_order": [
                              {
                                "SortBy": {
                                  "location": -1,
                                  "node": {
                                    "CollateClause": {
                                      "arg": {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "String": {
                                                "sval": "x",
                                              },
                                            },
                                          ],
                                          "location": 66,
                                        },
                                      },
                                      "collname": [
                                        {
                                          "String": {
                                            "sval": "POSIX",
                                          },
                                        },
                                      ],
                                      "location": 68,
                                    },
                                  },
                                  "sortby_dir": "SORTBY_DEFAULT",
                                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                                },
                              },
                            ],
                            "agg_within_group": true,
                            "args": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 40,
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "percentile_disc",
                                },
                              },
                            ],
                            "location": 24,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "pg_collation_for",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 912 1`] = `
[
  "select test_rank(3) within group (order by x)
from (values (1),(1),(2),(2),(3),(3),(4)) v(x)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "x",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 60,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 64,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 68,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 72,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 76,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 80,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 4,
                                  },
                                  "location": 84,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 43,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 17,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "test_rank",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 917 1`] = `
[
  "select rank(x) within group (order by x) from generate_series(1,5) x",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "x",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 62,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 5,
                                    },
                                    "location": 64,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 46,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 38,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "x",
                                },
                              },
                            ],
                            "location": 12,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "rank",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 920 1`] = `
[
  "select array(select percentile_disc(a) within group (order by x)
               from (values (0.3),(0.7)) v(a) group by a)
  from generate_series(1,5) g(x)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "g",
                    "colnames": [
                      {
                        "String": {
                          "sval": "x",
                        },
                      },
                    ],
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 146,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 5,
                                    },
                                    "location": 148,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 130,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "SubLink": {
                      "location": 7,
                      "subLinkType": "ARRAY_SUBLINK",
                      "subselect": {
                        "SelectStmt": {
                          "fromClause": [
                            {
                              "RangeSubselect": {
                                "alias": {
                                  "aliasname": "v",
                                  "colnames": [
                                    {
                                      "String": {
                                        "sval": "a",
                                      },
                                    },
                                  ],
                                },
                                "subquery": {
                                  "SelectStmt": {
                                    "limitOption": "LIMIT_OPTION_DEFAULT",
                                    "op": "SETOP_NONE",
                                    "valuesLists": [
                                      {
                                        "List": {
                                          "items": [
                                            {
                                              "A_Const": {
                                                "fval": {
                                                  "fval": "0.3",
                                                },
                                                "location": 94,
                                              },
                                            },
                                          ],
                                        },
                                      },
                                      {
                                        "List": {
                                          "items": [
                                            {
                                              "A_Const": {
                                                "fval": {
                                                  "fval": "0.7",
                                                },
                                                "location": 100,
                                              },
                                            },
                                          ],
                                        },
                                      },
                                    ],
                                  },
                                },
                              },
                            },
                          ],
                          "groupClause": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 120,
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 20,
                                "val": {
                                  "FuncCall": {
                                    "agg_order": [
                                      {
                                        "SortBy": {
                                          "location": -1,
                                          "node": {
                                            "ColumnRef": {
                                              "fields": [
                                                {
                                                  "String": {
                                                    "sval": "x",
                                                  },
                                                },
                                              ],
                                              "location": 62,
                                            },
                                          },
                                          "sortby_dir": "SORTBY_DEFAULT",
                                          "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                                        },
                                      },
                                    ],
                                    "agg_within_group": true,
                                    "args": [
                                      {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "String": {
                                                "sval": "a",
                                              },
                                            },
                                          ],
                                          "location": 36,
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "percentile_disc",
                                        },
                                      },
                                    ],
                                    "location": 20,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 925 1`] = `
[
  "select rank(sum(x)) within group (order by x) from generate_series(1,5) x",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "x",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 67,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 5,
                                    },
                                    "location": 69,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 51,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 43,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "FuncCall": {
                            "args": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "x",
                                      },
                                    },
                                  ],
                                  "location": 16,
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "sum",
                                },
                              },
                            ],
                            "location": 12,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "rank",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 928 1`] = `
[
  "select rank(3) within group (order by x) from (values ('fred'),('jim')) v(x)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "x",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 55,
                                  "sval": {
                                    "sval": "fred",
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "location": 64,
                                  "sval": {
                                    "sval": "jim",
                                  },
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 38,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 12,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "rank",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 938 1`] = `
[
  "select percent_rank(0) within group (order by x) from generate_series(1,0) x",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "x",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 70,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {},
                                    "location": 72,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 54,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 46,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_Const": {
                            "ival": {},
                            "location": 20,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "percent_rank",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 941 1`] = `
[
  "create view aggordview1 as
select ten,
       percentile_disc(0.5) within group (order by thousand) as p50,
       percentile_disc(0.5) within group (order by thousand) filter (where hundred=1) as px,
       rank(5,'AZZZZ',50) within group (order by hundred, string4 desc, hundred)
  from tenk1
 group by ten order by ten",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 289,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ten",
                          },
                        },
                      ],
                      "location": 305,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "sortClause": [
                  {
                    "SortBy": {
                      "location": -1,
                      "node": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ten",
                              },
                            },
                          ],
                          "location": 318,
                        },
                      },
                      "sortby_dir": "SORTBY_DEFAULT",
                      "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                    },
                  },
                ],
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 34,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ten",
                              },
                            },
                          ],
                          "location": 34,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 46,
                      "name": "p50",
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "thousand",
                                        },
                                      },
                                    ],
                                    "location": 90,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "agg_within_group": true,
                          "args": [
                            {
                              "A_Const": {
                                "fval": {
                                  "fval": "0.5",
                                },
                                "location": 62,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "percentile_disc",
                              },
                            },
                          ],
                          "location": 46,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 115,
                      "name": "px",
                      "val": {
                        "FuncCall": {
                          "agg_filter": {
                            "A_Expr": {
                              "kind": "AEXPR_OP",
                              "lexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "hundred",
                                      },
                                    },
                                  ],
                                  "location": 183,
                                },
                              },
                              "location": 190,
                              "name": [
                                {
                                  "String": {
                                    "sval": "=",
                                  },
                                },
                              ],
                              "rexpr": {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 191,
                                },
                              },
                            },
                          },
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "thousand",
                                        },
                                      },
                                    ],
                                    "location": 159,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "agg_within_group": true,
                          "args": [
                            {
                              "A_Const": {
                                "fval": {
                                  "fval": "0.5",
                                },
                                "location": 131,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "percentile_disc",
                              },
                            },
                          ],
                          "location": 115,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 208,
                      "val": {
                        "FuncCall": {
                          "agg_order": [
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "hundred",
                                        },
                                      },
                                    ],
                                    "location": 250,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "string4",
                                        },
                                      },
                                    ],
                                    "location": 259,
                                  },
                                },
                                "sortby_dir": "SORTBY_DESC",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                            {
                              "SortBy": {
                                "location": -1,
                                "node": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "hundred",
                                        },
                                      },
                                    ],
                                    "location": 273,
                                  },
                                },
                                "sortby_dir": "SORTBY_DEFAULT",
                                "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                              },
                            },
                          ],
                          "agg_within_group": true,
                          "args": [
                            {
                              "A_Const": {
                                "ival": {
                                  "ival": 5,
                                },
                                "location": 213,
                              },
                            },
                            {
                              "A_Const": {
                                "location": 215,
                                "sval": {
                                  "sval": "AZZZZ",
                                },
                              },
                            },
                            {
                              "A_Const": {
                                "ival": {
                                  "ival": 50,
                                },
                                "location": 223,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "rank",
                              },
                            },
                          ],
                          "location": 208,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "aggordview1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 949 1`] = `
[
  "select pg_get_viewdef('aggordview1')",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "A_Const": {
                            "location": 22,
                            "sval": {
                              "sval": "aggordview1",
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "pg_get_viewdef",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 954 1`] = `
[
  "select least_agg(q1,q2) from int8_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 29,
                  "relname": "int8_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "q1",
                                },
                              },
                            ],
                            "location": 17,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "q2",
                                },
                              },
                            ],
                            "location": 20,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "least_agg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 957 1`] = `
[
  "select cleast_agg(q1,q2) from int8_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 30,
                  "relname": "int8_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "q1",
                                },
                              },
                            ],
                            "location": 18,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "q2",
                                },
                              },
                            ],
                            "location": 21,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "cleast_agg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 965 1`] = `
[
  "create type avg_state as (total bigint, count bigint)",
  {
    "stmts": [
      {
        "stmt": {
          "CompositeTypeStmt": {
            "coldeflist": [
              {
                "ColumnDef": {
                  "colname": "total",
                  "is_local": true,
                  "location": 26,
                  "typeName": {
                    "location": 32,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "count",
                  "is_local": true,
                  "location": 40,
                  "typeName": {
                    "location": 46,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
            "typevar": {
              "location": 12,
              "relname": "avg_state",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 967 1`] = `
[
  "create or replace function avg_transfn(state avg_state, n int) returns avg_state as
$$
declare new_state avg_state;
begin
	raise notice 'avg_transfn called with %', n;
	if state is null then
		if n is not null then
			new_state.total := n;
			new_state.count := 1;
			return new_state;
		end if;
		return null;
	elsif n is not null then
		state.total := state.total + n;
		state.count := state.count + 1;
		return state;
	end if;

	return null;
end
$$ language plpgsql",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "avg_transfn",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
declare new_state avg_state;
begin
	raise notice 'avg_transfn called with %', n;
	if state is null then
		if n is not null then
			new_state.total := n;
			new_state.count := 1;
			return new_state;
		end if;
		return null;
	elsif n is not null then
		state.total := state.total + n;
		state.count := state.count + 1;
		return state;
	end if;

	return null;
end
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 81,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 452,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 45,
                    "names": [
                      {
                        "String": {
                          "sval": "avg_state",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "state",
                },
              },
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 58,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "n",
                },
              },
            ],
            "replace": true,
            "returnType": {
              "location": 71,
              "names": [
                {
                  "String": {
                    "sval": "avg_state",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 989 1`] = `
[
  "create function avg_finalfn(state avg_state) returns int4 as
$$
begin
	if state is null then
		return NULL;
	else
		return state.total / state.count;
	end if;
end
$$ language plpgsql",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "avg_finalfn",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
begin
	if state is null then
		return NULL;
	else
		return state.total / state.count;
	end if;
end
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 58,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 166,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 34,
                    "names": [
                      {
                        "String": {
                          "sval": "avg_state",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "state",
                },
              },
            ],
            "returnType": {
              "location": 53,
              "names": [
                {
                  "String": {
                    "sval": "int4",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1000 1`] = `
[
  "create function sum_finalfn(state avg_state) returns int4 as
$$
begin
	if state is null then
		return NULL;
	else
		return state.total;
	end if;
end
$$ language plpgsql",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "sum_finalfn",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
begin
	if state is null then
		return NULL;
	else
		return state.total;
	end if;
end
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 58,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 152,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 34,
                    "names": [
                      {
                        "String": {
                          "sval": "avg_state",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "state",
                },
              },
            ],
            "returnType": {
              "location": 53,
              "names": [
                {
                  "String": {
                    "sval": "int4",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1011 1`] = `
[
  "create aggregate my_avg(int4)
(
   stype = avg_state,
   sfunc = avg_transfn,
   finalfunc = avg_finalfn
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 24,
                          "names": [
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 43,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_state",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 35,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 65,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_transfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 57,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 93,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_finalfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "finalfunc",
                  "location": 81,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "my_avg",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1018 1`] = `
[
  "create aggregate my_sum(int4)
(
   stype = avg_state,
   sfunc = avg_transfn,
   finalfunc = sum_finalfn
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 24,
                          "names": [
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 43,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_state",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 35,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 65,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_transfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 57,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 93,
                      "names": [
                        {
                          "String": {
                            "sval": "sum_finalfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "finalfunc",
                  "location": 81,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "my_sum",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1026 1`] = `
[
  "select my_avg(one),my_avg(one) from (values(1),(3)) t(one)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "one",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 44,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 48,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 14,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_avg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 26,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_avg",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1029 1`] = `
[
  "select my_avg(one),my_sum(one) from (values(1),(3)) t(one)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "one",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 44,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 48,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 14,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_avg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 26,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_sum",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1032 1`] = `
[
  "select my_avg(distinct one),my_sum(distinct one) from (values(1),(3),(1)) t(one)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "one",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 62,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 66,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 70,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 23,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_avg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 28,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 44,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_sum",
                          },
                        },
                      ],
                      "location": 28,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1035 1`] = `
[
  "select my_avg(distinct one),my_sum(one) from (values(1),(3)) t(one)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "one",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 53,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 57,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_distinct": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 23,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_avg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 28,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 35,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_sum",
                          },
                        },
                      ],
                      "location": 28,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1038 1`] = `
[
  "select my_avg(one) filter (where one > 1),my_sum(one) from (values(1),(3)) t(one)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "one",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 67,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 71,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_filter": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "one",
                                  },
                                },
                              ],
                              "location": 33,
                            },
                          },
                          "location": 37,
                          "name": [
                            {
                              "String": {
                                "sval": ">",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 39,
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 14,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_avg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 42,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 49,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_sum",
                          },
                        },
                      ],
                      "location": 42,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1041 1`] = `
[
  "select my_avg(one),my_sum(two) from (values(1,2),(3,4)) t(one,two)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "one",
                        },
                      },
                      {
                        "String": {
                          "sval": "two",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 44,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 46,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 50,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 4,
                                  },
                                  "location": 52,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 14,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_avg",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "two",
                                },
                              },
                            ],
                            "location": 26,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_sum",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1044 1`] = `
[
  "select
  percentile_cont(0.5) within group (order by a),
  percentile_disc(0.5) within group (order by a)
from (values(1::float8),(3),(5),(7)) t(a)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "TypeCast": {
                                  "arg": {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 119,
                                    },
                                  },
                                  "location": 120,
                                  "typeName": {
                                    "location": 122,
                                    "names": [
                                      {
                                        "String": {
                                          "sval": "float8",
                                        },
                                      },
                                    ],
                                    "typemod": -1,
                                  },
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 131,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 5,
                                  },
                                  "location": 135,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 7,
                                  },
                                  "location": 139,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 53,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "0.5",
                            },
                            "location": 25,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "percentile_cont",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 59,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 103,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "0.5",
                            },
                            "location": 75,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "percentile_disc",
                          },
                        },
                      ],
                      "location": 59,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1055 1`] = `
[
  "select
  rank(4) within group (order by a),
  dense_rank(4) within group (order by a)
from (values(1),(3),(5),(7)) t(a)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 99,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 103,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 5,
                                  },
                                  "location": 107,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 7,
                                  },
                                  "location": 111,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 40,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 4,
                            },
                            "location": 14,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "rank",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 46,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 83,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 4,
                            },
                            "location": 57,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "dense_rank",
                          },
                        },
                      ],
                      "location": 46,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1061 1`] = `
[
  "create aggregate my_sum_init(int4)
(
   stype = avg_state,
   sfunc = avg_transfn,
   finalfunc = sum_finalfn,
   initcond = '(10,0)'
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 29,
                          "names": [
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 48,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_state",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 40,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 70,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_transfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 62,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 98,
                      "names": [
                        {
                          "String": {
                            "sval": "sum_finalfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "finalfunc",
                  "location": 86,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "(10,0)",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "initcond",
                  "location": 114,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "my_sum_init",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1069 1`] = `
[
  "create aggregate my_avg_init(int4)
(
   stype = avg_state,
   sfunc = avg_transfn,
   finalfunc = avg_finalfn,
   initcond = '(10,0)'
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 29,
                          "names": [
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 48,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_state",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 40,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 70,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_transfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 62,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 98,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_finalfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "finalfunc",
                  "location": 86,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "(10,0)",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "initcond",
                  "location": 114,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "my_avg_init",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1077 1`] = `
[
  "create aggregate my_avg_init2(int4)
(
   stype = avg_state,
   sfunc = avg_transfn,
   finalfunc = avg_finalfn,
   initcond = '(4,0)'
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 30,
                          "names": [
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 49,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_state",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 41,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 71,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_transfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 63,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 99,
                      "names": [
                        {
                          "String": {
                            "sval": "avg_finalfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "finalfunc",
                  "location": 87,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "(4,0)",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "initcond",
                  "location": 115,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "my_avg_init2",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1086 1`] = `
[
  "select my_sum_init(one),my_avg_init(one) from (values(1),(3)) t(one)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "one",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 54,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 58,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 19,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_sum_init",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 24,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 36,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_avg_init",
                          },
                        },
                      ],
                      "location": 24,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1089 1`] = `
[
  "select my_sum_init(one),my_avg_init2(one) from (values(1),(3)) t(one)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "one",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 55,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 59,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 19,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_sum_init",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 24,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 37,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_avg_init2",
                          },
                        },
                      ],
                      "location": 24,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1091 1`] = `
[
  "rollback",
  {
    "stmts": [
      {
        "stmt": {
          "TransactionStmt": {
            "kind": "TRANS_STMT_ROLLBACK",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1097 1`] = `
[
  "create or replace function sum_transfn(state int4, n int4) returns int4 as
$$
declare new_state int4;
begin
	raise notice 'sum_transfn called with %', n;
	if state is null then
		if n is not null then
			new_state := n;
			return new_state;
		end if;
		return null;
	elsif n is not null then
		state := state + n;
		return state;
	end if;

	return null;
end
$$ language plpgsql",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "sum_transfn",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
declare new_state int4;
begin
	raise notice 'sum_transfn called with %', n;
	if state is null then
		if n is not null then
			new_state := n;
			return new_state;
		end if;
		return null;
	elsif n is not null then
		state := state + n;
		return state;
	end if;

	return null;
end
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 72,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 361,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 45,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "state",
                },
              },
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 53,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "n",
                },
              },
            ],
            "replace": true,
            "returnType": {
              "location": 67,
              "names": [
                {
                  "String": {
                    "sval": "int4",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1117 1`] = `
[
  "create function halfsum_finalfn(state int4) returns int4 as
$$
begin
	if state is null then
		return NULL;
	else
		return state / 2;
	end if;
end
$$ language plpgsql",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "halfsum_finalfn",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
begin
	if state is null then
		return NULL;
	else
		return state / 2;
	end if;
end
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 57,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 149,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 38,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "state",
                },
              },
            ],
            "returnType": {
              "location": 52,
              "names": [
                {
                  "String": {
                    "sval": "int4",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1128 1`] = `
[
  "create aggregate my_sum(int4)
(
   stype = int4,
   sfunc = sum_transfn
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 24,
                          "names": [
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 43,
                      "names": [
                        {
                          "String": {
                            "sval": "int4",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 35,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 60,
                      "names": [
                        {
                          "String": {
                            "sval": "sum_transfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 52,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "my_sum",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1134 1`] = `
[
  "create aggregate my_half_sum(int4)
(
   stype = int4,
   sfunc = sum_transfn,
   finalfunc = halfsum_finalfn
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 29,
                          "names": [
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 48,
                      "names": [
                        {
                          "String": {
                            "sval": "int4",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 40,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 65,
                      "names": [
                        {
                          "String": {
                            "sval": "sum_transfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 57,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 93,
                      "names": [
                        {
                          "String": {
                            "sval": "halfsum_finalfn",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "finalfunc",
                  "location": 81,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "my_half_sum",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1142 1`] = `
[
  "select my_sum(one),my_half_sum(one) from (values(1),(2),(3),(4)) t(one)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "one",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 49,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 53,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 57,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 4,
                                  },
                                  "location": 61,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 14,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_sum",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "one",
                                },
                              },
                            ],
                            "location": 31,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "my_half_sum",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1163 1`] = `
[
  "CREATE AGGREGATE balk(int4)
(
    SFUNC = balkifnull(int8, int4),
    STYPE = int8,
    PARALLEL = SAFE,
    INITCOND = '0'
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 22,
                          "names": [
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 42,
                      "names": [
                        {
                          "String": {
                            "sval": "balkifnull",
                          },
                        },
                      ],
                      "typemod": -1,
                      "typmods": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "int8",
                                },
                              },
                            ],
                            "location": 53,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "int4",
                                },
                              },
                            ],
                            "location": 59,
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 34,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 78,
                      "names": [
                        {
                          "String": {
                            "sval": "int8",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 70,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 99,
                      "names": [
                        {
                          "String": {
                            "sval": "safe",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "parallel",
                  "location": 88,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "0",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "initcond",
                  "location": 109,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "balk",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1171 1`] = `
[
  "SELECT balk(hundred) FROM tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 26,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "hundred",
                                },
                              },
                            ],
                            "location": 12,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "balk",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1191 1`] = `
[
  "CREATE AGGREGATE balk(int4)
(
    SFUNC = int4_sum(int8, int4),
    STYPE = int8,
    COMBINEFUNC = balkifnull(int8, int8),
    PARALLEL = SAFE,
    INITCOND = '0'
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 22,
                          "names": [
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 42,
                      "names": [
                        {
                          "String": {
                            "sval": "int4_sum",
                          },
                        },
                      ],
                      "typemod": -1,
                      "typmods": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "int8",
                                },
                              },
                            ],
                            "location": 51,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "int4",
                                },
                              },
                            ],
                            "location": 57,
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 34,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 76,
                      "names": [
                        {
                          "String": {
                            "sval": "int8",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 68,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 100,
                      "names": [
                        {
                          "String": {
                            "sval": "balkifnull",
                          },
                        },
                      ],
                      "typemod": -1,
                      "typmods": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "int8",
                                },
                              },
                            ],
                            "location": 111,
                          },
                        },
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "int8",
                                },
                              },
                            ],
                            "location": 117,
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "combinefunc",
                  "location": 86,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 139,
                      "names": [
                        {
                          "String": {
                            "sval": "safe",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "parallel",
                  "location": 128,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "0",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "initcond",
                  "location": 149,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "balk",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1201 1`] = `
[
  "ALTER TABLE tenk1 set (parallel_workers = 4)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "List": {
                      "items": [
                        {
                          "DefElem": {
                            "arg": {
                              "Integer": {
                                "ival": 4,
                              },
                            },
                            "defaction": "DEFELEM_UNSPEC",
                            "defname": "parallel_workers",
                            "location": 23,
                          },
                        },
                      ],
                    },
                  },
                  "subtype": "AT_SetRelOptions",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "tenk1",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1205 1`] = `
[
  "EXPLAIN (COSTS OFF) SELECT balk(hundred) FROM tenk1",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 46,
                      "relname": "tenk1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "hundred",
                                    },
                                  },
                                ],
                                "location": 32,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "balk",
                              },
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1213 1`] = `
[
  "CREATE FUNCTION rwagg_sfunc(x anyarray, y anyarray) RETURNS anyarray
LANGUAGE plpgsql IMMUTABLE AS $$
BEGIN
    RETURN array_fill(y[1], ARRAY[4]);
END;
$$",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "rwagg_sfunc",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 69,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "immutable",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "volatility",
                  "location": 86,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
BEGIN
    RETURN array_fill(y[1], ARRAY[4]);
END;
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 96,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 30,
                    "names": [
                      {
                        "String": {
                          "sval": "anyarray",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "x",
                },
              },
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "anyarray",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "y",
                },
              },
            ],
            "returnType": {
              "location": 60,
              "names": [
                {
                  "String": {
                    "sval": "anyarray",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1220 1`] = `
[
  "CREATE FUNCTION rwagg_finalfunc(x anyarray) RETURNS anyarray
LANGUAGE plpgsql STRICT IMMUTABLE AS $$
DECLARE
    res x%TYPE;
BEGIN
    -- assignment is essential for this test, it expands the array to R/W
    res := array_fill(x[1], ARRAY[4]);
    RETURN res;
END;
$$",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "rwagg_finalfunc",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 61,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "Boolean": {
                      "boolval": true,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "strict",
                  "location": 78,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "immutable",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "volatility",
                  "location": 85,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
DECLARE
    res x%TYPE;
BEGIN
    -- assignment is essential for this test, it expands the array to R/W
    res := array_fill(x[1], ARRAY[4]);
    RETURN res;
END;
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 95,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 34,
                    "names": [
                      {
                        "String": {
                          "sval": "anyarray",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "x",
                },
              },
            ],
            "returnType": {
              "location": 52,
              "names": [
                {
                  "String": {
                    "sval": "anyarray",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1231 1`] = `
[
  "CREATE AGGREGATE rwagg(anyarray) (
    STYPE = anyarray,
    SFUNC = rwagg_sfunc,
    FINALFUNC = rwagg_finalfunc
)",
  {
    "stmts": [
      {
        "stmt": {
          "DefineStmt": {
            "args": [
              {
                "List": {
                  "items": [
                    {
                      "FunctionParameter": {
                        "argType": {
                          "location": 23,
                          "names": [
                            {
                              "String": {
                                "sval": "anyarray",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                        "mode": "FUNC_PARAM_DEFAULT",
                      },
                    },
                  ],
                },
              },
              {
                "Integer": {},
              },
            ],
            "definition": [
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 47,
                      "names": [
                        {
                          "String": {
                            "sval": "anyarray",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "stype",
                  "location": 39,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 69,
                      "names": [
                        {
                          "String": {
                            "sval": "rwagg_sfunc",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "sfunc",
                  "location": 61,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "TypeName": {
                      "location": 98,
                      "names": [
                        {
                          "String": {
                            "sval": "rwagg_finalfunc",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "finalfunc",
                  "location": 86,
                },
              },
            ],
            "defnames": [
              {
                "String": {
                  "sval": "rwagg",
                },
              },
            ],
            "kind": "OBJECT_AGGREGATE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1237 1`] = `
[
  "CREATE FUNCTION eatarray(x real[]) RETURNS real[]
LANGUAGE plpgsql STRICT IMMUTABLE AS $$
BEGIN
    x[1] := x[1] + 1;
    RETURN x;
END;
$$",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "eatarray",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 50,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "Boolean": {
                      "boolval": true,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "strict",
                  "location": 67,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "immutable",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "volatility",
                  "location": 74,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
BEGIN
    x[1] := x[1] + 1;
    RETURN x;
END;
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 84,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "arrayBounds": [
                      {
                        "Integer": {},
                      },
                    ],
                    "location": 27,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "float4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "x",
                },
              },
            ],
            "returnType": {
              "arrayBounds": [
                {
                  "Integer": {},
                },
              ],
              "location": 43,
              "names": [
                {
                  "String": {
                    "sval": "pg_catalog",
                  },
                },
                {
                  "String": {
                    "sval": "float4",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1245 1`] = `
[
  "SELECT eatarray(rwagg(ARRAY[1.0::real])), eatarray(rwagg(ARRAY[1.0::real]))",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "FuncCall": {
                            "args": [
                              {
                                "A_ArrayExpr": {
                                  "elements": [
                                    {
                                      "TypeCast": {
                                        "arg": {
                                          "A_Const": {
                                            "fval": {
                                              "fval": "1.0",
                                            },
                                            "location": 28,
                                          },
                                        },
                                        "location": 31,
                                        "typeName": {
                                          "location": 33,
                                          "names": [
                                            {
                                              "String": {
                                                "sval": "pg_catalog",
                                              },
                                            },
                                            {
                                              "String": {
                                                "sval": "float4",
                                              },
                                            },
                                          ],
                                          "typemod": -1,
                                        },
                                      },
                                    },
                                  ],
                                  "location": 22,
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "rwagg",
                                },
                              },
                            ],
                            "location": 16,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "eatarray",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 42,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "FuncCall": {
                            "args": [
                              {
                                "A_ArrayExpr": {
                                  "elements": [
                                    {
                                      "TypeCast": {
                                        "arg": {
                                          "A_Const": {
                                            "fval": {
                                              "fval": "1.0",
                                            },
                                            "location": 63,
                                          },
                                        },
                                        "location": 66,
                                        "typeName": {
                                          "location": 68,
                                          "names": [
                                            {
                                              "String": {
                                                "sval": "pg_catalog",
                                              },
                                            },
                                            {
                                              "String": {
                                                "sval": "float4",
                                              },
                                            },
                                          ],
                                          "typemod": -1,
                                        },
                                      },
                                    },
                                  ],
                                  "location": 57,
                                },
                              },
                            ],
                            "funcformat": "COERCE_EXPLICIT_CALL",
                            "funcname": [
                              {
                                "String": {
                                  "sval": "rwagg",
                                },
                              },
                            ],
                            "location": 51,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "eatarray",
                          },
                        },
                      ],
                      "location": 42,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1262 1`] = `
[
  "EXPLAIN (COSTS OFF, VERBOSE)
SELECT variance(unique1::int4), sum(unique1::int8), regr_count(unique1::float8, unique1::float8)
FROM (SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1) u",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
              {
                "DefElem": {
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "verbose",
                  "location": 20,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "u",
                      },
                      "subquery": {
                        "SelectStmt": {
                          "all": true,
                          "larg": {
                            "all": true,
                            "larg": {
                              "all": true,
                              "larg": {
                                "fromClause": [
                                  {
                                    "RangeVar": {
                                      "inh": true,
                                      "location": 146,
                                      "relname": "tenk1",
                                      "relpersistence": "p",
                                    },
                                  },
                                ],
                                "limitOption": "LIMIT_OPTION_DEFAULT",
                                "op": "SETOP_NONE",
                                "targetList": [
                                  {
                                    "ResTarget": {
                                      "location": 139,
                                      "val": {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "A_Star": {},
                                            },
                                          ],
                                          "location": 139,
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                              "limitOption": "LIMIT_OPTION_DEFAULT",
                              "op": "SETOP_UNION",
                              "rarg": {
                                "fromClause": [
                                  {
                                    "RangeVar": {
                                      "inh": true,
                                      "location": 182,
                                      "relname": "tenk1",
                                      "relpersistence": "p",
                                    },
                                  },
                                ],
                                "limitOption": "LIMIT_OPTION_DEFAULT",
                                "op": "SETOP_NONE",
                                "targetList": [
                                  {
                                    "ResTarget": {
                                      "location": 175,
                                      "val": {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "A_Star": {},
                                            },
                                          ],
                                          "location": 175,
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            "limitOption": "LIMIT_OPTION_DEFAULT",
                            "op": "SETOP_UNION",
                            "rarg": {
                              "fromClause": [
                                {
                                  "RangeVar": {
                                    "inh": true,
                                    "location": 218,
                                    "relname": "tenk1",
                                    "relpersistence": "p",
                                  },
                                },
                              ],
                              "limitOption": "LIMIT_OPTION_DEFAULT",
                              "op": "SETOP_NONE",
                              "targetList": [
                                {
                                  "ResTarget": {
                                    "location": 211,
                                    "val": {
                                      "ColumnRef": {
                                        "fields": [
                                          {
                                            "A_Star": {},
                                          },
                                        ],
                                        "location": 211,
                                      },
                                    },
                                  },
                                },
                              ],
                            },
                          },
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_UNION",
                          "rarg": {
                            "fromClause": [
                              {
                                "RangeVar": {
                                  "inh": true,
                                  "location": 254,
                                  "relname": "tenk1",
                                  "relpersistence": "p",
                                },
                              },
                            ],
                            "limitOption": "LIMIT_OPTION_DEFAULT",
                            "op": "SETOP_NONE",
                            "targetList": [
                              {
                                "ResTarget": {
                                  "location": 247,
                                  "val": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "A_Star": {},
                                        },
                                      ],
                                      "location": 247,
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 36,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "unique1",
                                        },
                                      },
                                    ],
                                    "location": 45,
                                  },
                                },
                                "location": 52,
                                "typeName": {
                                  "location": 54,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "int4",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "variance",
                              },
                            },
                          ],
                          "location": 36,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 61,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "unique1",
                                        },
                                      },
                                    ],
                                    "location": 65,
                                  },
                                },
                                "location": 72,
                                "typeName": {
                                  "location": 74,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "int8",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 61,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 81,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "unique1",
                                        },
                                      },
                                    ],
                                    "location": 92,
                                  },
                                },
                                "location": 99,
                                "typeName": {
                                  "location": 101,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "float8",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "unique1",
                                        },
                                      },
                                    ],
                                    "location": 109,
                                  },
                                },
                                "location": 116,
                                "typeName": {
                                  "location": 118,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "float8",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "regr_count",
                              },
                            },
                          ],
                          "location": 81,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1269 1`] = `
[
  "SELECT variance(unique1::int4), sum(unique1::int8), regr_count(unique1::float8, unique1::float8)
FROM (SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1) u",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "u",
                  },
                  "subquery": {
                    "SelectStmt": {
                      "all": true,
                      "larg": {
                        "all": true,
                        "larg": {
                          "all": true,
                          "larg": {
                            "fromClause": [
                              {
                                "RangeVar": {
                                  "inh": true,
                                  "location": 117,
                                  "relname": "tenk1",
                                  "relpersistence": "p",
                                },
                              },
                            ],
                            "limitOption": "LIMIT_OPTION_DEFAULT",
                            "op": "SETOP_NONE",
                            "targetList": [
                              {
                                "ResTarget": {
                                  "location": 110,
                                  "val": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "A_Star": {},
                                        },
                                      ],
                                      "location": 110,
                                    },
                                  },
                                },
                              },
                            ],
                          },
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_UNION",
                          "rarg": {
                            "fromClause": [
                              {
                                "RangeVar": {
                                  "inh": true,
                                  "location": 153,
                                  "relname": "tenk1",
                                  "relpersistence": "p",
                                },
                              },
                            ],
                            "limitOption": "LIMIT_OPTION_DEFAULT",
                            "op": "SETOP_NONE",
                            "targetList": [
                              {
                                "ResTarget": {
                                  "location": 146,
                                  "val": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "A_Star": {},
                                        },
                                      ],
                                      "location": 146,
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                        "limitOption": "LIMIT_OPTION_DEFAULT",
                        "op": "SETOP_UNION",
                        "rarg": {
                          "fromClause": [
                            {
                              "RangeVar": {
                                "inh": true,
                                "location": 189,
                                "relname": "tenk1",
                                "relpersistence": "p",
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 182,
                                "val": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "A_Star": {},
                                      },
                                    ],
                                    "location": 182,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_UNION",
                      "rarg": {
                        "fromClause": [
                          {
                            "RangeVar": {
                              "inh": true,
                              "location": 225,
                              "relname": "tenk1",
                              "relpersistence": "p",
                            },
                          },
                        ],
                        "limitOption": "LIMIT_OPTION_DEFAULT",
                        "op": "SETOP_NONE",
                        "targetList": [
                          {
                            "ResTarget": {
                              "location": 218,
                              "val": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "A_Star": {},
                                    },
                                  ],
                                  "location": 218,
                                },
                              },
                            },
                          },
                        ],
                      },
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 16,
                              },
                            },
                            "location": 23,
                            "typeName": {
                              "location": 25,
                              "names": [
                                {
                                  "String": {
                                    "sval": "int4",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "variance",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 32,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 36,
                              },
                            },
                            "location": 43,
                            "typeName": {
                              "location": 45,
                              "names": [
                                {
                                  "String": {
                                    "sval": "int8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 32,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 52,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 63,
                              },
                            },
                            "location": 70,
                            "typeName": {
                              "location": 72,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 80,
                              },
                            },
                            "location": 87,
                            "typeName": {
                              "location": 89,
                              "names": [
                                {
                                  "String": {
                                    "sval": "float8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "regr_count",
                          },
                        },
                      ],
                      "location": 52,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1277 1`] = `
[
  "EXPLAIN (COSTS OFF, VERBOSE)
SELECT variance(unique1::int8), avg(unique1::numeric)
FROM (SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1) u",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
              {
                "DefElem": {
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "verbose",
                  "location": 20,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "u",
                      },
                      "subquery": {
                        "SelectStmt": {
                          "all": true,
                          "larg": {
                            "all": true,
                            "larg": {
                              "all": true,
                              "larg": {
                                "fromClause": [
                                  {
                                    "RangeVar": {
                                      "inh": true,
                                      "location": 103,
                                      "relname": "tenk1",
                                      "relpersistence": "p",
                                    },
                                  },
                                ],
                                "limitOption": "LIMIT_OPTION_DEFAULT",
                                "op": "SETOP_NONE",
                                "targetList": [
                                  {
                                    "ResTarget": {
                                      "location": 96,
                                      "val": {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "A_Star": {},
                                            },
                                          ],
                                          "location": 96,
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                              "limitOption": "LIMIT_OPTION_DEFAULT",
                              "op": "SETOP_UNION",
                              "rarg": {
                                "fromClause": [
                                  {
                                    "RangeVar": {
                                      "inh": true,
                                      "location": 139,
                                      "relname": "tenk1",
                                      "relpersistence": "p",
                                    },
                                  },
                                ],
                                "limitOption": "LIMIT_OPTION_DEFAULT",
                                "op": "SETOP_NONE",
                                "targetList": [
                                  {
                                    "ResTarget": {
                                      "location": 132,
                                      "val": {
                                        "ColumnRef": {
                                          "fields": [
                                            {
                                              "A_Star": {},
                                            },
                                          ],
                                          "location": 132,
                                        },
                                      },
                                    },
                                  },
                                ],
                              },
                            },
                            "limitOption": "LIMIT_OPTION_DEFAULT",
                            "op": "SETOP_UNION",
                            "rarg": {
                              "fromClause": [
                                {
                                  "RangeVar": {
                                    "inh": true,
                                    "location": 175,
                                    "relname": "tenk1",
                                    "relpersistence": "p",
                                  },
                                },
                              ],
                              "limitOption": "LIMIT_OPTION_DEFAULT",
                              "op": "SETOP_NONE",
                              "targetList": [
                                {
                                  "ResTarget": {
                                    "location": 168,
                                    "val": {
                                      "ColumnRef": {
                                        "fields": [
                                          {
                                            "A_Star": {},
                                          },
                                        ],
                                        "location": 168,
                                      },
                                    },
                                  },
                                },
                              ],
                            },
                          },
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_UNION",
                          "rarg": {
                            "fromClause": [
                              {
                                "RangeVar": {
                                  "inh": true,
                                  "location": 211,
                                  "relname": "tenk1",
                                  "relpersistence": "p",
                                },
                              },
                            ],
                            "limitOption": "LIMIT_OPTION_DEFAULT",
                            "op": "SETOP_NONE",
                            "targetList": [
                              {
                                "ResTarget": {
                                  "location": 204,
                                  "val": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "A_Star": {},
                                        },
                                      ],
                                      "location": 204,
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 36,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "unique1",
                                        },
                                      },
                                    ],
                                    "location": 45,
                                  },
                                },
                                "location": 52,
                                "typeName": {
                                  "location": 54,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "int8",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "variance",
                              },
                            },
                          ],
                          "location": 36,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 61,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "unique1",
                                        },
                                      },
                                    ],
                                    "location": 65,
                                  },
                                },
                                "location": 72,
                                "typeName": {
                                  "location": 74,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "pg_catalog",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "numeric",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "avg",
                              },
                            },
                          ],
                          "location": 61,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1284 1`] = `
[
  "SELECT variance(unique1::int8), avg(unique1::numeric)
FROM (SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1
      UNION ALL SELECT * FROM tenk1) u",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "u",
                  },
                  "subquery": {
                    "SelectStmt": {
                      "all": true,
                      "larg": {
                        "all": true,
                        "larg": {
                          "all": true,
                          "larg": {
                            "fromClause": [
                              {
                                "RangeVar": {
                                  "inh": true,
                                  "location": 74,
                                  "relname": "tenk1",
                                  "relpersistence": "p",
                                },
                              },
                            ],
                            "limitOption": "LIMIT_OPTION_DEFAULT",
                            "op": "SETOP_NONE",
                            "targetList": [
                              {
                                "ResTarget": {
                                  "location": 67,
                                  "val": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "A_Star": {},
                                        },
                                      ],
                                      "location": 67,
                                    },
                                  },
                                },
                              },
                            ],
                          },
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_UNION",
                          "rarg": {
                            "fromClause": [
                              {
                                "RangeVar": {
                                  "inh": true,
                                  "location": 110,
                                  "relname": "tenk1",
                                  "relpersistence": "p",
                                },
                              },
                            ],
                            "limitOption": "LIMIT_OPTION_DEFAULT",
                            "op": "SETOP_NONE",
                            "targetList": [
                              {
                                "ResTarget": {
                                  "location": 103,
                                  "val": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "A_Star": {},
                                        },
                                      ],
                                      "location": 103,
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                        "limitOption": "LIMIT_OPTION_DEFAULT",
                        "op": "SETOP_UNION",
                        "rarg": {
                          "fromClause": [
                            {
                              "RangeVar": {
                                "inh": true,
                                "location": 146,
                                "relname": "tenk1",
                                "relpersistence": "p",
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 139,
                                "val": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "A_Star": {},
                                      },
                                    ],
                                    "location": 139,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_UNION",
                      "rarg": {
                        "fromClause": [
                          {
                            "RangeVar": {
                              "inh": true,
                              "location": 182,
                              "relname": "tenk1",
                              "relpersistence": "p",
                            },
                          },
                        ],
                        "limitOption": "LIMIT_OPTION_DEFAULT",
                        "op": "SETOP_NONE",
                        "targetList": [
                          {
                            "ResTarget": {
                              "location": 175,
                              "val": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "A_Star": {},
                                    },
                                  ],
                                  "location": 175,
                                },
                              },
                            },
                          },
                        ],
                      },
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 16,
                              },
                            },
                            "location": 23,
                            "typeName": {
                              "location": 25,
                              "names": [
                                {
                                  "String": {
                                    "sval": "int8",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "variance",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 32,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "TypeCast": {
                            "arg": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "unique1",
                                    },
                                  },
                                ],
                                "location": 36,
                              },
                            },
                            "location": 43,
                            "typeName": {
                              "location": 45,
                              "names": [
                                {
                                  "String": {
                                    "sval": "pg_catalog",
                                  },
                                },
                                {
                                  "String": {
                                    "sval": "numeric",
                                  },
                                },
                              ],
                              "typemod": -1,
                            },
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "avg",
                          },
                        },
                      ],
                      "location": 32,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1293 1`] = `
[
  "SELECT dense_rank(x) WITHIN GROUP (ORDER BY x) FROM (VALUES (1),(1),(2),(2),(3),(3)) v(x) GROUP BY (x) ORDER BY 1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "v",
                    "colnames": [
                      {
                        "String": {
                          "sval": "x",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 61,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 65,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 69,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 73,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 77,
                                },
                              },
                            ],
                          },
                        },
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 81,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "x",
                      },
                    },
                  ],
                  "location": 100,
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "A_Const": {
                      "ival": {
                        "ival": 1,
                      },
                      "location": 112,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "x",
                                    },
                                  },
                                ],
                                "location": 44,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "agg_within_group": true,
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "x",
                                },
                              },
                            ],
                            "location": 18,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "dense_rank",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1299 1`] = `
[
  "SELECT min(x ORDER BY y) FROM (VALUES(1, NULL)) AS d(x,y)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeSubselect": {
                  "alias": {
                    "aliasname": "d",
                    "colnames": [
                      {
                        "String": {
                          "sval": "x",
                        },
                      },
                      {
                        "String": {
                          "sval": "y",
                        },
                      },
                    ],
                  },
                  "subquery": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 38,
                                },
                              },
                              {
                                "A_Const": {
                                  "isnull": true,
                                  "location": 41,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "agg_order": [
                        {
                          "SortBy": {
                            "location": -1,
                            "node": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "y",
                                    },
                                  },
                                ],
                                "location": 22,
                              },
                            },
                            "sortby_dir": "SORTBY_DEFAULT",
                            "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                          },
                        },
                      ],
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "x",
                                },
                              },
                            ],
                            "location": 11,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "min",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1303 1`] = `
[
  "select v||'a', case v||'a' when 'aa' then 1 else 0 end, count(*)
  from unnest(array['a','b']) u(v)
 group by v||'a' order by 1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "u",
                    "colnames": [
                      {
                        "String": {
                          "sval": "v",
                        },
                      },
                    ],
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_ArrayExpr": {
                                    "elements": [
                                      {
                                        "A_Const": {
                                          "location": 85,
                                          "sval": {
                                            "sval": "a",
                                          },
                                        },
                                      },
                                      {
                                        "A_Const": {
                                          "location": 89,
                                          "sval": {
                                            "sval": "b",
                                          },
                                        },
                                      },
                                    ],
                                    "location": 79,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "unnest",
                                  },
                                },
                              ],
                              "location": 72,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "groupClause": [
              {
                "A_Expr": {
                  "kind": "AEXPR_OP",
                  "lexpr": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "v",
                          },
                        },
                      ],
                      "location": 110,
                    },
                  },
                  "location": 111,
                  "name": [
                    {
                      "String": {
                        "sval": "||",
                      },
                    },
                  ],
                  "rexpr": {
                    "A_Const": {
                      "location": 113,
                      "sval": {
                        "sval": "a",
                      },
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "A_Const": {
                      "ival": {
                        "ival": 1,
                      },
                      "location": 126,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "v",
                              },
                            },
                          ],
                          "location": 7,
                        },
                      },
                      "location": 8,
                      "name": [
                        {
                          "String": {
                            "sval": "||",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "location": 10,
                          "sval": {
                            "sval": "a",
                          },
                        },
                      },
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 15,
                  "val": {
                    "CaseExpr": {
                      "arg": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "v",
                                  },
                                },
                              ],
                              "location": 20,
                            },
                          },
                          "location": 21,
                          "name": [
                            {
                              "String": {
                                "sval": "||",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "location": 23,
                              "sval": {
                                "sval": "a",
                              },
                            },
                          },
                        },
                      },
                      "args": [
                        {
                          "CaseWhen": {
                            "expr": {
                              "A_Const": {
                                "location": 32,
                                "sval": {
                                  "sval": "aa",
                                },
                              },
                            },
                            "location": 27,
                            "result": {
                              "A_Const": {
                                "ival": {
                                  "ival": 1,
                                },
                                "location": 42,
                              },
                            },
                          },
                        },
                      ],
                      "defresult": {
                        "A_Const": {
                          "ival": {},
                          "location": 49,
                        },
                      },
                      "location": 15,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 56,
                  "val": {
                    "FuncCall": {
                      "agg_star": true,
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "count",
                          },
                        },
                      ],
                      "location": 56,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1313 1`] = `
[
  "set enable_memoize to off",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "args": [
              {
                "A_Const": {
                  "location": 22,
                  "sval": {
                    "sval": "off",
                  },
                },
              },
            ],
            "kind": "VAR_SET_VALUE",
            "name": "enable_memoize",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1315 1`] = `
[
  "  select 1 from tenk1
   where (hundred, thousand) in (select twothousand, twothousand from onek)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 16,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 1,
                      },
                      "location": 9,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "SubLink": {
                "location": 51,
                "subLinkType": "ANY_SUBLINK",
                "subselect": {
                  "SelectStmt": {
                    "fromClause": [
                      {
                        "RangeVar": {
                          "inh": true,
                          "location": 92,
                          "relname": "onek",
                          "relpersistence": "p",
                        },
                      },
                    ],
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "targetList": [
                      {
                        "ResTarget": {
                          "location": 62,
                          "val": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "twothousand",
                                  },
                                },
                              ],
                              "location": 62,
                            },
                          },
                        },
                      },
                      {
                        "ResTarget": {
                          "location": 75,
                          "val": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "twothousand",
                                  },
                                },
                              ],
                              "location": 75,
                            },
                          },
                        },
                      },
                    ],
                  },
                },
                "testexpr": {
                  "RowExpr": {
                    "args": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "hundred",
                              },
                            },
                          ],
                          "location": 32,
                        },
                      },
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "thousand",
                              },
                            },
                          ],
                          "location": 41,
                        },
                      },
                    ],
                    "location": 31,
                    "row_format": "COERCE_IMPLICIT_CAST",
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1326 1`] = `
[
  "select unique1, count(*), sum(twothousand) from tenk1
group by unique1
having sum(fivethous) > 4975
order by sum(twothousand)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 48,
                  "relname": "tenk1",
                  "relpersistence": "p",
                },
              },
            ],
            "groupClause": [
              {
                "ColumnRef": {
                  "fields": [
                    {
                      "String": {
                        "sval": "unique1",
                      },
                    },
                  ],
                  "location": 63,
                },
              },
            ],
            "havingClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "FuncCall": {
                    "args": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "fivethous",
                              },
                            },
                          ],
                          "location": 82,
                        },
                      },
                    ],
                    "funcformat": "COERCE_EXPLICIT_CALL",
                    "funcname": [
                      {
                        "String": {
                          "sval": "sum",
                        },
                      },
                    ],
                    "location": 78,
                  },
                },
                "location": 93,
                "name": [
                  {
                    "String": {
                      "sval": ">",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 4975,
                    },
                    "location": 95,
                  },
                },
              },
            },
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "twothousand",
                                },
                              },
                            ],
                            "location": 113,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 109,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "unique1",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 16,
                  "val": {
                    "FuncCall": {
                      "agg_star": true,
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "count",
                          },
                        },
                      ],
                      "location": 16,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 26,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "twothousand",
                                },
                              },
                            ],
                            "location": 30,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "sum",
                          },
                        },
                      ],
                      "location": 26,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1331 1`] = `
[
  "set work_mem to default",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "kind": "VAR_SET_DEFAULT",
            "name": "work_mem",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1341 1`] = `
[
  "create table agg_data_2k as
select g from generate_series(0, 1999) g",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_data_2k",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeFunction": {
                      "alias": {
                        "aliasname": "g",
                      },
                      "functions": [
                        {
                          "List": {
                            "items": [
                              {
                                "FuncCall": {
                                  "args": [
                                    {
                                      "A_Const": {
                                        "ival": {},
                                        "location": 58,
                                      },
                                    },
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1999,
                                        },
                                        "location": 61,
                                      },
                                    },
                                  ],
                                  "funcformat": "COERCE_EXPLICIT_CALL",
                                  "funcname": [
                                    {
                                      "String": {
                                        "sval": "generate_series",
                                      },
                                    },
                                  ],
                                  "location": 42,
                                },
                              },
                              {},
                            ],
                          },
                        },
                      ],
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 35,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "g",
                              },
                            },
                          ],
                          "location": 35,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1345 1`] = `
[
  "create table agg_data_20k as
select g from generate_series(0, 19999) g",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_data_20k",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeFunction": {
                      "alias": {
                        "aliasname": "g",
                      },
                      "functions": [
                        {
                          "List": {
                            "items": [
                              {
                                "FuncCall": {
                                  "args": [
                                    {
                                      "A_Const": {
                                        "ival": {},
                                        "location": 59,
                                      },
                                    },
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 19999,
                                        },
                                        "location": 62,
                                      },
                                    },
                                  ],
                                  "funcformat": "COERCE_EXPLICIT_CALL",
                                  "funcname": [
                                    {
                                      "String": {
                                        "sval": "generate_series",
                                      },
                                    },
                                  ],
                                  "location": 43,
                                },
                              },
                              {},
                            ],
                          },
                        },
                      ],
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 36,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "g",
                              },
                            },
                          ],
                          "location": 36,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1353 1`] = `
[
  "set jit_above_cost = 0",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "args": [
              {
                "A_Const": {
                  "ival": {},
                  "location": 21,
                },
              },
            ],
            "kind": "VAR_SET_VALUE",
            "name": "jit_above_cost",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1355 1`] = `
[
  "explain (costs off)
select g%10000 as c1, sum(g::numeric) as c2, count(*) as c3
  from agg_data_20k group by g%10000",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 87,
                      "relname": "agg_data_20k",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "g",
                              },
                            },
                          ],
                          "location": 109,
                        },
                      },
                      "location": 110,
                      "name": [
                        {
                          "String": {
                            "sval": "%",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10000,
                          },
                          "location": 111,
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "name": "c1",
                      "val": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "g",
                                  },
                                },
                              ],
                              "location": 27,
                            },
                          },
                          "location": 28,
                          "name": [
                            {
                              "String": {
                                "sval": "%",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 10000,
                              },
                              "location": 29,
                            },
                          },
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 42,
                      "name": "c2",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "g",
                                        },
                                      },
                                    ],
                                    "location": 46,
                                  },
                                },
                                "location": 47,
                                "typeName": {
                                  "location": 49,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "pg_catalog",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "numeric",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 42,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 65,
                      "name": "c3",
                      "val": {
                        "FuncCall": {
                          "agg_star": true,
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 65,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1359 1`] = `
[
  "create table agg_group_1 as
select g%10000 as c1, sum(g::numeric) as c2, count(*) as c3
  from agg_data_20k group by g%10000",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_group_1",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 95,
                      "relname": "agg_data_20k",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "g",
                              },
                            },
                          ],
                          "location": 117,
                        },
                      },
                      "location": 118,
                      "name": [
                        {
                          "String": {
                            "sval": "%",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10000,
                          },
                          "location": 119,
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 35,
                      "name": "c1",
                      "val": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "g",
                                  },
                                },
                              ],
                              "location": 35,
                            },
                          },
                          "location": 36,
                          "name": [
                            {
                              "String": {
                                "sval": "%",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 10000,
                              },
                              "location": 37,
                            },
                          },
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 50,
                      "name": "c2",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "g",
                                        },
                                      },
                                    ],
                                    "location": 54,
                                  },
                                },
                                "location": 55,
                                "typeName": {
                                  "location": 57,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "pg_catalog",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "numeric",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 50,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 73,
                      "name": "c3",
                      "val": {
                        "FuncCall": {
                          "agg_star": true,
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 73,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1363 1`] = `
[
  "create table agg_group_2 as
select * from
  (values (100), (300), (500)) as r(a),
  lateral (
    select (g/2)::numeric as c1,
           array_agg(g::numeric) as c2,
	   count(*) as c3
    from agg_data_2k
    where g < r.a
    group by g/2) as s",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_group_2",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "r",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                      },
                      "subquery": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "valuesLists": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 100,
                                      },
                                      "location": 53,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 300,
                                      },
                                      "location": 60,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 500,
                                      },
                                      "location": 67,
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "s",
                      },
                      "lateral": true,
                      "subquery": {
                        "SelectStmt": {
                          "fromClause": [
                            {
                              "RangeVar": {
                                "inh": true,
                                "location": 195,
                                "relname": "agg_data_2k",
                                "relpersistence": "p",
                              },
                            },
                          ],
                          "groupClause": [
                            {
                              "A_Expr": {
                                "kind": "AEXPR_OP",
                                "lexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "g",
                                        },
                                      },
                                    ],
                                    "location": 238,
                                  },
                                },
                                "location": 239,
                                "name": [
                                  {
                                    "String": {
                                      "sval": "/",
                                    },
                                  },
                                ],
                                "rexpr": {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 2,
                                    },
                                    "location": 240,
                                  },
                                },
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 105,
                                "name": "c1",
                                "val": {
                                  "TypeCast": {
                                    "arg": {
                                      "A_Expr": {
                                        "kind": "AEXPR_OP",
                                        "lexpr": {
                                          "ColumnRef": {
                                            "fields": [
                                              {
                                                "String": {
                                                  "sval": "g",
                                                },
                                              },
                                            ],
                                            "location": 106,
                                          },
                                        },
                                        "location": 107,
                                        "name": [
                                          {
                                            "String": {
                                              "sval": "/",
                                            },
                                          },
                                        ],
                                        "rexpr": {
                                          "A_Const": {
                                            "ival": {
                                              "ival": 2,
                                            },
                                            "location": 108,
                                          },
                                        },
                                      },
                                    },
                                    "location": 110,
                                    "typeName": {
                                      "location": 112,
                                      "names": [
                                        {
                                          "String": {
                                            "sval": "pg_catalog",
                                          },
                                        },
                                        {
                                          "String": {
                                            "sval": "numeric",
                                          },
                                        },
                                      ],
                                      "typemod": -1,
                                    },
                                  },
                                },
                              },
                            },
                            {
                              "ResTarget": {
                                "location": 138,
                                "name": "c2",
                                "val": {
                                  "FuncCall": {
                                    "args": [
                                      {
                                        "TypeCast": {
                                          "arg": {
                                            "ColumnRef": {
                                              "fields": [
                                                {
                                                  "String": {
                                                    "sval": "g",
                                                  },
                                                },
                                              ],
                                              "location": 148,
                                            },
                                          },
                                          "location": 149,
                                          "typeName": {
                                            "location": 151,
                                            "names": [
                                              {
                                                "String": {
                                                  "sval": "pg_catalog",
                                                },
                                              },
                                              {
                                                "String": {
                                                  "sval": "numeric",
                                                },
                                              },
                                            ],
                                            "typemod": -1,
                                          },
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "array_agg",
                                        },
                                      },
                                    ],
                                    "location": 138,
                                  },
                                },
                              },
                            },
                            {
                              "ResTarget": {
                                "location": 171,
                                "name": "c3",
                                "val": {
                                  "FuncCall": {
                                    "agg_star": true,
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "count",
                                        },
                                      },
                                    ],
                                    "location": 171,
                                  },
                                },
                              },
                            },
                          ],
                          "whereClause": {
                            "A_Expr": {
                              "kind": "AEXPR_OP",
                              "lexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "g",
                                      },
                                    },
                                  ],
                                  "location": 217,
                                },
                              },
                              "location": 219,
                              "name": [
                                {
                                  "String": {
                                    "sval": "<",
                                  },
                                },
                              ],
                              "rexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "r",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "a",
                                      },
                                    },
                                  ],
                                  "location": 221,
                                },
                              },
                            },
                          },
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 35,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 35,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1374 1`] = `
[
  "set jit_above_cost to default",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "kind": "VAR_SET_DEFAULT",
            "name": "jit_above_cost",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1376 1`] = `
[
  "create table agg_group_3 as
select (g/2)::numeric as c1, sum(7::int4) as c2, count(*) as c3
  from agg_data_2k group by g/2",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_group_3",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 99,
                      "relname": "agg_data_2k",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "g",
                              },
                            },
                          ],
                          "location": 120,
                        },
                      },
                      "location": 121,
                      "name": [
                        {
                          "String": {
                            "sval": "/",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 122,
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 35,
                      "name": "c1",
                      "val": {
                        "TypeCast": {
                          "arg": {
                            "A_Expr": {
                              "kind": "AEXPR_OP",
                              "lexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "g",
                                      },
                                    },
                                  ],
                                  "location": 36,
                                },
                              },
                              "location": 37,
                              "name": [
                                {
                                  "String": {
                                    "sval": "/",
                                  },
                                },
                              ],
                              "rexpr": {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 38,
                                },
                              },
                            },
                          },
                          "location": 40,
                          "typeName": {
                            "location": 42,
                            "names": [
                              {
                                "String": {
                                  "sval": "pg_catalog",
                                },
                              },
                              {
                                "String": {
                                  "sval": "numeric",
                                },
                              },
                            ],
                            "typemod": -1,
                          },
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 57,
                      "name": "c2",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 7,
                                    },
                                    "location": 61,
                                  },
                                },
                                "location": 62,
                                "typeName": {
                                  "location": 64,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "int4",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 57,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 77,
                      "name": "c3",
                      "val": {
                        "FuncCall": {
                          "agg_star": true,
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 77,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1380 1`] = `
[
  "create table agg_group_4 as
select (g/2)::numeric as c1, array_agg(g::numeric) as c2, count(*) as c3
  from agg_data_2k group by g/2",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_group_4",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 108,
                      "relname": "agg_data_2k",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "g",
                              },
                            },
                          ],
                          "location": 129,
                        },
                      },
                      "location": 130,
                      "name": [
                        {
                          "String": {
                            "sval": "/",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 131,
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 35,
                      "name": "c1",
                      "val": {
                        "TypeCast": {
                          "arg": {
                            "A_Expr": {
                              "kind": "AEXPR_OP",
                              "lexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "g",
                                      },
                                    },
                                  ],
                                  "location": 36,
                                },
                              },
                              "location": 37,
                              "name": [
                                {
                                  "String": {
                                    "sval": "/",
                                  },
                                },
                              ],
                              "rexpr": {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 38,
                                },
                              },
                            },
                          },
                          "location": 40,
                          "typeName": {
                            "location": 42,
                            "names": [
                              {
                                "String": {
                                  "sval": "pg_catalog",
                                },
                              },
                              {
                                "String": {
                                  "sval": "numeric",
                                },
                              },
                            ],
                            "typemod": -1,
                          },
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 57,
                      "name": "c2",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "g",
                                        },
                                      },
                                    ],
                                    "location": 67,
                                  },
                                },
                                "location": 68,
                                "typeName": {
                                  "location": 70,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "pg_catalog",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "numeric",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "array_agg",
                              },
                            },
                          ],
                          "location": 57,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 86,
                      "name": "c3",
                      "val": {
                        "FuncCall": {
                          "agg_star": true,
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 86,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1395 1`] = `
[
  "create table agg_hash_1 as
select g%10000 as c1, sum(g::numeric) as c2, count(*) as c3
  from agg_data_20k group by g%10000",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_hash_1",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 94,
                      "relname": "agg_data_20k",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "g",
                              },
                            },
                          ],
                          "location": 116,
                        },
                      },
                      "location": 117,
                      "name": [
                        {
                          "String": {
                            "sval": "%",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10000,
                          },
                          "location": 118,
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 34,
                      "name": "c1",
                      "val": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "g",
                                  },
                                },
                              ],
                              "location": 34,
                            },
                          },
                          "location": 35,
                          "name": [
                            {
                              "String": {
                                "sval": "%",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 10000,
                              },
                              "location": 36,
                            },
                          },
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 49,
                      "name": "c2",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "g",
                                        },
                                      },
                                    ],
                                    "location": 53,
                                  },
                                },
                                "location": 54,
                                "typeName": {
                                  "location": 56,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "pg_catalog",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "numeric",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 49,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 72,
                      "name": "c3",
                      "val": {
                        "FuncCall": {
                          "agg_star": true,
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 72,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1399 1`] = `
[
  "create table agg_hash_2 as
select * from
  (values (100), (300), (500)) as r(a),
  lateral (
    select (g/2)::numeric as c1,
           array_agg(g::numeric) as c2,
	   count(*) as c3
    from agg_data_2k
    where g < r.a
    group by g/2) as s",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_hash_2",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "r",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                      },
                      "subquery": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "valuesLists": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 100,
                                      },
                                      "location": 52,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 300,
                                      },
                                      "location": 59,
                                    },
                                  },
                                ],
                              },
                            },
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 500,
                                      },
                                      "location": 66,
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "s",
                      },
                      "lateral": true,
                      "subquery": {
                        "SelectStmt": {
                          "fromClause": [
                            {
                              "RangeVar": {
                                "inh": true,
                                "location": 194,
                                "relname": "agg_data_2k",
                                "relpersistence": "p",
                              },
                            },
                          ],
                          "groupClause": [
                            {
                              "A_Expr": {
                                "kind": "AEXPR_OP",
                                "lexpr": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "g",
                                        },
                                      },
                                    ],
                                    "location": 237,
                                  },
                                },
                                "location": 238,
                                "name": [
                                  {
                                    "String": {
                                      "sval": "/",
                                    },
                                  },
                                ],
                                "rexpr": {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 2,
                                    },
                                    "location": 239,
                                  },
                                },
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 104,
                                "name": "c1",
                                "val": {
                                  "TypeCast": {
                                    "arg": {
                                      "A_Expr": {
                                        "kind": "AEXPR_OP",
                                        "lexpr": {
                                          "ColumnRef": {
                                            "fields": [
                                              {
                                                "String": {
                                                  "sval": "g",
                                                },
                                              },
                                            ],
                                            "location": 105,
                                          },
                                        },
                                        "location": 106,
                                        "name": [
                                          {
                                            "String": {
                                              "sval": "/",
                                            },
                                          },
                                        ],
                                        "rexpr": {
                                          "A_Const": {
                                            "ival": {
                                              "ival": 2,
                                            },
                                            "location": 107,
                                          },
                                        },
                                      },
                                    },
                                    "location": 109,
                                    "typeName": {
                                      "location": 111,
                                      "names": [
                                        {
                                          "String": {
                                            "sval": "pg_catalog",
                                          },
                                        },
                                        {
                                          "String": {
                                            "sval": "numeric",
                                          },
                                        },
                                      ],
                                      "typemod": -1,
                                    },
                                  },
                                },
                              },
                            },
                            {
                              "ResTarget": {
                                "location": 137,
                                "name": "c2",
                                "val": {
                                  "FuncCall": {
                                    "args": [
                                      {
                                        "TypeCast": {
                                          "arg": {
                                            "ColumnRef": {
                                              "fields": [
                                                {
                                                  "String": {
                                                    "sval": "g",
                                                  },
                                                },
                                              ],
                                              "location": 147,
                                            },
                                          },
                                          "location": 148,
                                          "typeName": {
                                            "location": 150,
                                            "names": [
                                              {
                                                "String": {
                                                  "sval": "pg_catalog",
                                                },
                                              },
                                              {
                                                "String": {
                                                  "sval": "numeric",
                                                },
                                              },
                                            ],
                                            "typemod": -1,
                                          },
                                        },
                                      },
                                    ],
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "array_agg",
                                        },
                                      },
                                    ],
                                    "location": 137,
                                  },
                                },
                              },
                            },
                            {
                              "ResTarget": {
                                "location": 170,
                                "name": "c3",
                                "val": {
                                  "FuncCall": {
                                    "agg_star": true,
                                    "funcformat": "COERCE_EXPLICIT_CALL",
                                    "funcname": [
                                      {
                                        "String": {
                                          "sval": "count",
                                        },
                                      },
                                    ],
                                    "location": 170,
                                  },
                                },
                              },
                            },
                          ],
                          "whereClause": {
                            "A_Expr": {
                              "kind": "AEXPR_OP",
                              "lexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "g",
                                      },
                                    },
                                  ],
                                  "location": 216,
                                },
                              },
                              "location": 218,
                              "name": [
                                {
                                  "String": {
                                    "sval": "<",
                                  },
                                },
                              ],
                              "rexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "r",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "a",
                                      },
                                    },
                                  ],
                                  "location": 220,
                                },
                              },
                            },
                          },
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 34,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 34,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1412 1`] = `
[
  "create table agg_hash_3 as
select (g/2)::numeric as c1, sum(7::int4) as c2, count(*) as c3
  from agg_data_2k group by g/2",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_hash_3",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 98,
                      "relname": "agg_data_2k",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "g",
                              },
                            },
                          ],
                          "location": 119,
                        },
                      },
                      "location": 120,
                      "name": [
                        {
                          "String": {
                            "sval": "/",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 121,
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 34,
                      "name": "c1",
                      "val": {
                        "TypeCast": {
                          "arg": {
                            "A_Expr": {
                              "kind": "AEXPR_OP",
                              "lexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "g",
                                      },
                                    },
                                  ],
                                  "location": 35,
                                },
                              },
                              "location": 36,
                              "name": [
                                {
                                  "String": {
                                    "sval": "/",
                                  },
                                },
                              ],
                              "rexpr": {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 37,
                                },
                              },
                            },
                          },
                          "location": 39,
                          "typeName": {
                            "location": 41,
                            "names": [
                              {
                                "String": {
                                  "sval": "pg_catalog",
                                },
                              },
                              {
                                "String": {
                                  "sval": "numeric",
                                },
                              },
                            ],
                            "typemod": -1,
                          },
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 56,
                      "name": "c2",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 7,
                                    },
                                    "location": 60,
                                  },
                                },
                                "location": 61,
                                "typeName": {
                                  "location": 63,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "int4",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sum",
                              },
                            },
                          ],
                          "location": 56,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 76,
                      "name": "c3",
                      "val": {
                        "FuncCall": {
                          "agg_star": true,
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 76,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1416 1`] = `
[
  "create table agg_hash_4 as
select (g/2)::numeric as c1, array_agg(g::numeric) as c2, count(*) as c3
  from agg_data_2k group by g/2",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTableAsStmt": {
            "into": {
              "onCommit": "ONCOMMIT_NOOP",
              "rel": {
                "inh": true,
                "location": 13,
                "relname": "agg_hash_4",
                "relpersistence": "p",
              },
            },
            "objtype": "OBJECT_TABLE",
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 107,
                      "relname": "agg_data_2k",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "g",
                              },
                            },
                          ],
                          "location": 128,
                        },
                      },
                      "location": 129,
                      "name": [
                        {
                          "String": {
                            "sval": "/",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 130,
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 34,
                      "name": "c1",
                      "val": {
                        "TypeCast": {
                          "arg": {
                            "A_Expr": {
                              "kind": "AEXPR_OP",
                              "lexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "g",
                                      },
                                    },
                                  ],
                                  "location": 35,
                                },
                              },
                              "location": 36,
                              "name": [
                                {
                                  "String": {
                                    "sval": "/",
                                  },
                                },
                              ],
                              "rexpr": {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 37,
                                },
                              },
                            },
                          },
                          "location": 39,
                          "typeName": {
                            "location": 41,
                            "names": [
                              {
                                "String": {
                                  "sval": "pg_catalog",
                                },
                              },
                              {
                                "String": {
                                  "sval": "numeric",
                                },
                              },
                            ],
                            "typemod": -1,
                          },
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 56,
                      "name": "c2",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "TypeCast": {
                                "arg": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "String": {
                                          "sval": "g",
                                        },
                                      },
                                    ],
                                    "location": 66,
                                  },
                                },
                                "location": 67,
                                "typeName": {
                                  "location": 69,
                                  "names": [
                                    {
                                      "String": {
                                        "sval": "pg_catalog",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "numeric",
                                      },
                                    },
                                  ],
                                  "typemod": -1,
                                },
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "array_agg",
                              },
                            },
                          ],
                          "location": 56,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 85,
                      "name": "c3",
                      "val": {
                        "FuncCall": {
                          "agg_star": true,
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 85,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1420 1`] = `
[
  "set enable_sort = true",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "args": [
              {
                "A_Const": {
                  "location": 18,
                  "sval": {
                    "sval": "true",
                  },
                },
              },
            ],
            "kind": "VAR_SET_VALUE",
            "name": "enable_sort",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1429 1`] = `
[
  "(select * from agg_hash_2 except select * from agg_group_2)
  union all
(select * from agg_group_2 except select * from agg_hash_2)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "all": true,
            "larg": {
              "larg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 15,
                      "relname": "agg_hash_2",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 8,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 8,
                        },
                      },
                    },
                  },
                ],
              },
              "limitOption": "LIMIT_OPTION_DEFAULT",
              "op": "SETOP_EXCEPT",
              "rarg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 47,
                      "relname": "agg_group_2",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 40,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 40,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_UNION",
            "rarg": {
              "larg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 87,
                      "relname": "agg_group_2",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 80,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 80,
                        },
                      },
                    },
                  },
                ],
              },
              "limitOption": "LIMIT_OPTION_DEFAULT",
              "op": "SETOP_EXCEPT",
              "rarg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 120,
                      "relname": "agg_hash_2",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 113,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 113,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1433 1`] = `
[
  "(select * from agg_hash_3 except select * from agg_group_3)
  union all
(select * from agg_group_3 except select * from agg_hash_3)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "all": true,
            "larg": {
              "larg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 15,
                      "relname": "agg_hash_3",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 8,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 8,
                        },
                      },
                    },
                  },
                ],
              },
              "limitOption": "LIMIT_OPTION_DEFAULT",
              "op": "SETOP_EXCEPT",
              "rarg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 47,
                      "relname": "agg_group_3",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 40,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 40,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_UNION",
            "rarg": {
              "larg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 87,
                      "relname": "agg_group_3",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 80,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 80,
                        },
                      },
                    },
                  },
                ],
              },
              "limitOption": "LIMIT_OPTION_DEFAULT",
              "op": "SETOP_EXCEPT",
              "rarg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 120,
                      "relname": "agg_hash_3",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 113,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 113,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1437 1`] = `
[
  "(select * from agg_hash_4 except select * from agg_group_4)
  union all
(select * from agg_group_4 except select * from agg_hash_4)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "all": true,
            "larg": {
              "larg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 15,
                      "relname": "agg_hash_4",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 8,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 8,
                        },
                      },
                    },
                  },
                ],
              },
              "limitOption": "LIMIT_OPTION_DEFAULT",
              "op": "SETOP_EXCEPT",
              "rarg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 47,
                      "relname": "agg_group_4",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 40,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 40,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_UNION",
            "rarg": {
              "larg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 87,
                      "relname": "agg_group_4",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 80,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 80,
                        },
                      },
                    },
                  },
                ],
              },
              "limitOption": "LIMIT_OPTION_DEFAULT",
              "op": "SETOP_EXCEPT",
              "rarg": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 120,
                      "relname": "agg_hash_4",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 113,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 113,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`aggregates.sql > line 1441 1`] = `
[
  "drop table agg_group_1",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "agg_group_1",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;
