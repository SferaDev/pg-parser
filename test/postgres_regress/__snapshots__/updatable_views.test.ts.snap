// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`updatable_views.sql > line 6 1`] = `
[
  "SET extra_float_digits = 0",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "args": [
              {
                "A_Const": {
                  "ival": {},
                  "location": 25,
                },
              },
            ],
            "kind": "VAR_SET_VALUE",
            "name": "extra_float_digits",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 14 1`] = `
[
  "CREATE VIEW ro_view1 AS SELECT DISTINCT a, b FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "distinctClause": [
                  {},
                ],
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 50,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 40,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 40,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 43,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 43,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "ro_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 14 2`] = `
[
  " -- DISTINCT not supported
CREATE VIEW ro_view2 AS SELECT a, b FROM base_tbl GROUP BY a, b",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 68,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "groupClause": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 86,
                    },
                  },
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 89,
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 58,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 58,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 61,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 61,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 39,
              "relname": "ro_view2",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 15 1`] = `
[
  " -- GROUP BY not supported
CREATE VIEW ro_view3 AS SELECT 1 FROM base_tbl HAVING max(a) > 0",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 65,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "havingClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "FuncCall": {
                        "args": [
                          {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "location": 85,
                            },
                          },
                        ],
                        "funcformat": "COERCE_EXPLICIT_CALL",
                        "funcname": [
                          {
                            "String": {
                              "sval": "max",
                            },
                          },
                        ],
                        "location": 81,
                      },
                    },
                    "location": 88,
                    "name": [
                      {
                        "String": {
                          "sval": ">",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {},
                        "location": 90,
                      },
                    },
                  },
                },
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 58,
                      "val": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 58,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 39,
              "relname": "ro_view3",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 16 1`] = `
[
  " -- HAVING not supported
CREATE VIEW ro_view4 AS SELECT count(*) FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 70,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 56,
                      "val": {
                        "FuncCall": {
                          "agg_star": true,
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "count",
                              },
                            },
                          ],
                          "location": 56,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 37,
              "relname": "ro_view4",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 17 1`] = `
[
  " -- Aggregate functions not supported
CREATE VIEW ro_view5 AS SELECT a, rank() OVER() FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 91,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 69,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 69,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 72,
                      "val": {
                        "FuncCall": {
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "rank",
                              },
                            },
                          ],
                          "location": 72,
                          "over": {
                            "frameOptions": 1058,
                            "location": 83,
                          },
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 50,
              "relname": "ro_view5",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 18 1`] = `
[
  " -- Window functions not supported
CREATE VIEW ro_view6 AS SELECT a, b FROM base_tbl UNION SELECT -a, b FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "larg": {
                  "fromClause": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 76,
                        "relname": "base_tbl",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "limitOption": "LIMIT_OPTION_DEFAULT",
                  "op": "SETOP_NONE",
                  "targetList": [
                    {
                      "ResTarget": {
                        "location": 66,
                        "val": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 66,
                          },
                        },
                      },
                    },
                    {
                      "ResTarget": {
                        "location": 69,
                        "val": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 69,
                          },
                        },
                      },
                    },
                  ],
                },
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_UNION",
                "rarg": {
                  "fromClause": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 109,
                        "relname": "base_tbl",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "limitOption": "LIMIT_OPTION_DEFAULT",
                  "op": "SETOP_NONE",
                  "targetList": [
                    {
                      "ResTarget": {
                        "location": 98,
                        "val": {
                          "A_Expr": {
                            "kind": "AEXPR_OP",
                            "location": 98,
                            "name": [
                              {
                                "String": {
                                  "sval": "-",
                                },
                              },
                            ],
                            "rexpr": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 99,
                              },
                            },
                          },
                        },
                      },
                    },
                    {
                      "ResTarget": {
                        "location": 102,
                        "val": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 102,
                          },
                        },
                      },
                    },
                  ],
                },
              },
            },
            "view": {
              "inh": true,
              "location": 47,
              "relname": "ro_view6",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 19 1`] = `
[
  " -- Set ops not supported
CREATE VIEW ro_view7 AS WITH t AS (SELECT a, b FROM base_tbl) SELECT * FROM t",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 102,
                      "relname": "t",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 95,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 95,
                        },
                      },
                    },
                  },
                ],
                "withClause": {
                  "ctes": [
                    {
                      "CommonTableExpr": {
                        "ctematerialized": "CTEMaterializeDefault",
                        "ctename": "t",
                        "ctequery": {
                          "SelectStmt": {
                            "fromClause": [
                              {
                                "RangeVar": {
                                  "inh": true,
                                  "location": 78,
                                  "relname": "base_tbl",
                                  "relpersistence": "p",
                                },
                              },
                            ],
                            "limitOption": "LIMIT_OPTION_DEFAULT",
                            "op": "SETOP_NONE",
                            "targetList": [
                              {
                                "ResTarget": {
                                  "location": 68,
                                  "val": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "a",
                                          },
                                        },
                                      ],
                                      "location": 68,
                                    },
                                  },
                                },
                              },
                              {
                                "ResTarget": {
                                  "location": 71,
                                  "val": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "b",
                                          },
                                        },
                                      ],
                                      "location": 71,
                                    },
                                  },
                                },
                              },
                            ],
                          },
                        },
                        "location": 55,
                      },
                    },
                  ],
                  "location": 50,
                },
              },
            },
            "view": {
              "inh": true,
              "location": 38,
              "relname": "ro_view7",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 20 1`] = `
[
  " -- WITH not supported
CREATE VIEW ro_view8 AS SELECT a, b FROM base_tbl ORDER BY a OFFSET 1",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 64,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOffset": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 91,
                  },
                },
                "limitOption": "LIMIT_OPTION_COUNT",
                "op": "SETOP_NONE",
                "sortClause": [
                  {
                    "SortBy": {
                      "location": -1,
                      "node": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 82,
                        },
                      },
                      "sortby_dir": "SORTBY_DEFAULT",
                      "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                    },
                  },
                ],
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 54,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 54,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 57,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 57,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 35,
              "relname": "ro_view8",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 21 1`] = `
[
  " -- OFFSET not supported
CREATE VIEW ro_view9 AS SELECT a, b FROM base_tbl ORDER BY a LIMIT 1",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 66,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitCount": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 92,
                  },
                },
                "limitOption": "LIMIT_OPTION_COUNT",
                "op": "SETOP_NONE",
                "sortClause": [
                  {
                    "SortBy": {
                      "location": -1,
                      "node": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 84,
                        },
                      },
                      "sortby_dir": "SORTBY_DEFAULT",
                      "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                    },
                  },
                ],
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 56,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 56,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 59,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 59,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 37,
              "relname": "ro_view9",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 22 1`] = `
[
  " -- LIMIT not supported
CREATE VIEW ro_view10 AS SELECT 1 AS a",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 56,
                      "name": "a",
                      "val": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 56,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 36,
              "relname": "ro_view10",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 23 1`] = `
[
  " -- No base relations
CREATE VIEW ro_view11 AS SELECT b1.a, b2.b FROM base_tbl b1, base_tbl b2",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "alias": {
                        "aliasname": "b1",
                      },
                      "inh": true,
                      "location": 70,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                  {
                    "RangeVar": {
                      "alias": {
                        "aliasname": "b2",
                      },
                      "inh": true,
                      "location": 83,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 54,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b1",
                              },
                            },
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 54,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 60,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b2",
                              },
                            },
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 60,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 34,
              "relname": "ro_view11",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 24 1`] = `
[
  " -- Multiple base relations
CREATE VIEW ro_view12 AS SELECT * FROM generate_series(1, 10) AS g(a)",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeFunction": {
                      "alias": {
                        "aliasname": "g",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                      },
                      "functions": [
                        {
                          "List": {
                            "items": [
                              {
                                "FuncCall": {
                                  "args": [
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1,
                                        },
                                        "location": 83,
                                      },
                                    },
                                    {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 10,
                                        },
                                        "location": 86,
                                      },
                                    },
                                  ],
                                  "funcformat": "COERCE_EXPLICIT_CALL",
                                  "funcname": [
                                    {
                                      "String": {
                                        "sval": "generate_series",
                                      },
                                    },
                                  ],
                                  "location": 67,
                                },
                              },
                              {},
                            ],
                          },
                        },
                      ],
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 60,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 60,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 40,
              "relname": "ro_view12",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 25 1`] = `
[
  " -- SRF in rangetable
CREATE VIEW ro_view13 AS SELECT a, b FROM (SELECT * FROM base_tbl) AS t",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "t",
                      },
                      "subquery": {
                        "SelectStmt": {
                          "fromClause": [
                            {
                              "RangeVar": {
                                "inh": true,
                                "location": 79,
                                "relname": "base_tbl",
                                "relpersistence": "p",
                              },
                            },
                          ],
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "targetList": [
                            {
                              "ResTarget": {
                                "location": 72,
                                "val": {
                                  "ColumnRef": {
                                    "fields": [
                                      {
                                        "A_Star": {},
                                      },
                                    ],
                                    "location": 72,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 54,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 54,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 57,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 57,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 34,
              "relname": "ro_view13",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 26 1`] = `
[
  " -- Subselect in rangetable
CREATE VIEW rw_view14 AS SELECT ctid, a, b FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 76,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 60,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ctid",
                              },
                            },
                          ],
                          "location": 60,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 66,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 66,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 69,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 69,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 40,
              "relname": "rw_view14",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 27 1`] = `
[
  " -- System columns may be part of an updatable view
CREATE VIEW rw_view15 AS SELECT a, upper(b) FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 101,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 84,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 84,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 87,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                ],
                                "location": 93,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "upper",
                              },
                            },
                          ],
                          "location": 87,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 64,
              "relname": "rw_view15",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 28 1`] = `
[
  " -- Expression/function may be part of an updatable view
CREATE VIEW rw_view16 AS SELECT a, b, a AS aa FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 108,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 89,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 89,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 92,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 92,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 95,
                      "name": "aa",
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 95,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 69,
              "relname": "rw_view16",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 29 1`] = `
[
  " -- Repeated column may be part of an updatable view
CREATE VIEW ro_view17 AS SELECT * FROM ro_view1",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 92,
                      "relname": "ro_view1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 85,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 85,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 65,
              "relname": "ro_view17",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 30 1`] = `
[
  " -- Base relation not updatable
CREATE VIEW ro_view18 AS SELECT * FROM (VALUES(1)) AS tmp(a)",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeSubselect": {
                      "alias": {
                        "aliasname": "tmp",
                        "colnames": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                      },
                      "subquery": {
                        "SelectStmt": {
                          "limitOption": "LIMIT_OPTION_DEFAULT",
                          "op": "SETOP_NONE",
                          "valuesLists": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "A_Const": {
                                      "ival": {
                                        "ival": 1,
                                      },
                                      "location": 79,
                                    },
                                  },
                                ],
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 64,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 64,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 44,
              "relname": "ro_view18",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 31 1`] = `
[
  " -- VALUES in rangetable
CREATE SEQUENCE uv_seq",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSeqStmt": {
            "sequence": {
              "inh": true,
              "location": 41,
              "relname": "uv_seq",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 33 1`] = `
[
  " -- View based on a sequence
CREATE VIEW ro_view20 AS SELECT a, b, generate_series(1, a) g FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 96,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 61,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 61,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 64,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 64,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 67,
                      "name": "g",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "A_Const": {
                                "ival": {
                                  "ival": 1,
                                },
                                "location": 83,
                              },
                            },
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 86,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "generate_series",
                              },
                            },
                          ],
                          "location": 67,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 41,
              "relname": "ro_view20",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 34 1`] = `
[
  " -- SRF in targetlist not supported

SELECT table_name, is_insertable_into
  FROM information_schema.tables
 WHERE table_name LIKE E'r_\\\\_view%'
 ORDER BY table_name",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 82,
                  "relname": "tables",
                  "relpersistence": "p",
                  "schemaname": "information_schema",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 155,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 44,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 44,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 56,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_insertable_into",
                          },
                        },
                      ],
                      "location": 56,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_LIKE",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "table_name",
                        },
                      },
                    ],
                    "location": 115,
                  },
                },
                "location": 126,
                "name": [
                  {
                    "String": {
                      "sval": "~~",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "location": 131,
                    "sval": {
                      "sval": "r_\\_view%",
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 41 1`] = `
[
  "SELECT table_name, is_updatable, is_insertable_into
  FROM information_schema.views
 WHERE table_name LIKE E'r_\\\\_view%'
 ORDER BY table_name",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 59,
                  "relname": "views",
                  "relpersistence": "p",
                  "schemaname": "information_schema",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 131,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_updatable",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 33,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_insertable_into",
                          },
                        },
                      ],
                      "location": 33,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_LIKE",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "table_name",
                        },
                      },
                    ],
                    "location": 91,
                  },
                },
                "location": 102,
                "name": [
                  {
                    "String": {
                      "sval": "~~",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "location": 107,
                    "sval": {
                      "sval": "r_\\_view%",
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 46 1`] = `
[
  "SELECT table_name, column_name, is_updatable
  FROM information_schema.columns
 WHERE table_name LIKE E'r_\\\\_view%'
 ORDER BY table_name, ordinal_position",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 52,
                  "relname": "columns",
                  "relpersistence": "p",
                  "schemaname": "information_schema",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 126,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ordinal_position",
                          },
                        },
                      ],
                      "location": 138,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "column_name",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 32,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_updatable",
                          },
                        },
                      ],
                      "location": 32,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_LIKE",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "table_name",
                        },
                      },
                    ],
                    "location": 86,
                  },
                },
                "location": 97,
                "name": [
                  {
                    "String": {
                      "sval": "~~",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "location": 102,
                    "sval": {
                      "sval": "r_\\_view%",
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 52 1`] = `
[
  "DELETE FROM ro_view1",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "ro_view1",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 66 1`] = `
[
  "INSERT INTO rw_view14 VALUES (null, 3, 'Row 3')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "rw_view14",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 30,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 36,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 39,
                            "sval": {
                              "sval": "Row 3",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 66 2`] = `
[
  " -- should fail
INSERT INTO rw_view14 (a, b) VALUES (3, 'Row 3')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 39,
                  "name": "a",
                },
              },
              {
                "ResTarget": {
                  "location": 42,
                  "name": "b",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view14",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 53,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 56,
                            "sval": {
                              "sval": "Row 3",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 67 1`] = `
[
  " -- should be OK
UPDATE rw_view14 SET ctid=null WHERE a=3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "rw_view14",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 38,
                  "name": "ctid",
                  "val": {
                    "A_Const": {
                      "isnull": true,
                      "location": 43,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 54,
                  },
                },
                "location": 55,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 56,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 68 1`] = `
[
  " -- should fail
UPDATE rw_view14 SET b='ROW 3' WHERE a=3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view14",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "b",
                  "val": {
                    "A_Const": {
                      "location": 39,
                      "sval": {
                        "sval": "ROW 3",
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 53,
                  },
                },
                "location": 54,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 55,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 69 1`] = `
[
  " -- should be OK
SELECT * FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 31,
                  "relname": "base_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 24,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 24,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 73 1`] = `
[
  " -- should fail
INSERT INTO rw_view15 (a) VALUES (3)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 39,
                  "name": "a",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view15",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 50,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 74 1`] = `
[
  " -- should be OK
INSERT INTO rw_view15 (a) VALUES (3) ON CONFLICT DO NOTHING",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 40,
                  "name": "a",
                },
              },
            ],
            "onConflictClause": {
              "action": "ONCONFLICT_NOTHING",
              "location": 54,
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 29,
              "relname": "rw_view15",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 51,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 75 1`] = `
[
  " -- succeeds
SELECT * FROM rw_view15",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 27,
                  "relname": "rw_view15",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 20,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 20,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 85 1`] = `
[
  " -- should fail
UPDATE rw_view15 SET upper='ROW 3' WHERE a=3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view15",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "upper",
                  "val": {
                    "A_Const": {
                      "location": 43,
                      "sval": {
                        "sval": "ROW 3",
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 57,
                  },
                },
                "location": 58,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 59,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 87 1`] = `
[
  " -- should fail
UPDATE rw_view15 SET a=4 WHERE a=3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view15",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "a",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 4,
                      },
                      "location": 39,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 47,
                  },
                },
                "location": 48,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 49,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 93 1`] = `
[
  " -- should be OK
UPDATE rw_view16 SET a=3, aa=-3 WHERE a=3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "rw_view16",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 38,
                  "name": "a",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 3,
                      },
                      "location": 40,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 43,
                  "name": "aa",
                  "val": {
                    "A_Const": {
                      "ival": {},
                      "location": 46,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 55,
                  },
                },
                "location": 56,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 57,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 94 1`] = `
[
  " -- should fail
UPDATE rw_view16 SET aa=-3 WHERE a=3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view16",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "aa",
                  "val": {
                    "A_Const": {
                      "ival": {},
                      "location": 40,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 49,
                  },
                },
                "location": 50,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 51,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 97 1`] = `
[
  " -- should be OK
-- Read-only views
INSERT INTO ro_view17 VALUES (3, 'ROW 3')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 48,
              "relname": "ro_view17",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 66,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 69,
                            "sval": {
                              "sval": "ROW 3",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 107 1`] = `
[
  "CREATE RULE rw_view16_ins_rule AS ON INSERT TO rw_view16
  WHERE NEW.a > 0 DO INSTEAD INSERT INTO base_tbl VALUES (NEW.a, NEW.b)",
  {
    "stmts": [
      {
        "stmt": {
          "RuleStmt": {
            "actions": [
              {
                "InsertStmt": {
                  "override": "OVERRIDING_NOT_SET",
                  "relation": {
                    "inh": true,
                    "location": 98,
                    "relname": "base_tbl",
                    "relpersistence": "p",
                  },
                  "selectStmt": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "new",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "a",
                                      },
                                    },
                                  ],
                                  "location": 115,
                                },
                              },
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "new",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "b",
                                      },
                                    },
                                  ],
                                  "location": 122,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "event": "CMD_INSERT",
            "instead": true,
            "relation": {
              "inh": true,
              "location": 47,
              "relname": "rw_view16",
              "relpersistence": "p",
            },
            "rulename": "rw_view16_ins_rule",
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "new",
                        },
                      },
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 65,
                  },
                },
                "location": 71,
                "name": [
                  {
                    "String": {
                      "sval": ">",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {},
                    "location": 73,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 115 1`] = `
[
  " -- should fail
DELETE FROM rw_view16 WHERE a=2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view16",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 44,
                  },
                },
                "location": 45,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 46,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 116 1`] = `
[
  " -- should fail

DROP TABLE base_tbl CASCADE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "base_tbl",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 127 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT * FROM base_tbl WHERE a>0",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 38,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 53,
                      },
                    },
                    "location": 54,
                    "name": [
                      {
                        "String": {
                          "sval": ">",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {},
                        "location": 55,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 129 1`] = `
[
  "SELECT table_name, is_insertable_into
  FROM information_schema.tables
 WHERE table_name = 'rw_view1'",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 45,
                  "relname": "tables",
                  "relpersistence": "p",
                  "schemaname": "information_schema",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_insertable_into",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "table_name",
                        },
                      },
                    ],
                    "location": 78,
                  },
                },
                "location": 89,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "location": 91,
                    "sval": {
                      "sval": "rw_view1",
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 133 1`] = `
[
  "SELECT table_name, is_updatable, is_insertable_into
  FROM information_schema.views
 WHERE table_name = 'rw_view1'",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 59,
                  "relname": "views",
                  "relpersistence": "p",
                  "schemaname": "information_schema",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_updatable",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 33,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_insertable_into",
                          },
                        },
                      ],
                      "location": 33,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "table_name",
                        },
                      },
                    ],
                    "location": 91,
                  },
                },
                "location": 102,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "location": 104,
                    "sval": {
                      "sval": "rw_view1",
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 137 1`] = `
[
  "SELECT table_name, column_name, is_updatable
  FROM information_schema.columns
 WHERE table_name = 'rw_view1'
 ORDER BY ordinal_position",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 52,
                  "relname": "columns",
                  "relpersistence": "p",
                  "schemaname": "information_schema",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ordinal_position",
                          },
                        },
                      ],
                      "location": 120,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "column_name",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 32,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_updatable",
                          },
                        },
                      ],
                      "location": 32,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "table_name",
                        },
                      },
                    ],
                    "location": 86,
                  },
                },
                "location": 97,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "location": 99,
                    "sval": {
                      "sval": "rw_view1",
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 142 1`] = `
[
  "INSERT INTO rw_view1 VALUES (3, 'Row 3')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 29,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 32,
                            "sval": {
                              "sval": "Row 3",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 148 1`] = `
[
  "EXPLAIN (costs off) UPDATE rw_view1 SET a=6 WHERE a=5",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "UpdateStmt": {
                "relation": {
                  "inh": true,
                  "location": 27,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 40,
                      "name": "a",
                      "val": {
                        "A_Const": {
                          "ival": {
                            "ival": 6,
                          },
                          "location": 42,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 50,
                      },
                    },
                    "location": 51,
                    "name": [
                      {
                        "String": {
                          "sval": "=",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {
                          "ival": 5,
                        },
                        "location": 52,
                      },
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 155 1`] = `
[
  "CREATE RULE base_tbl_log AS ON INSERT TO rw_view1 DO ALSO
  INSERT INTO base_tbl_hist(a,b) VALUES(new.a, new.b)",
  {
    "stmts": [
      {
        "stmt": {
          "RuleStmt": {
            "actions": [
              {
                "InsertStmt": {
                  "cols": [
                    {
                      "ResTarget": {
                        "location": 86,
                        "name": "a",
                      },
                    },
                    {
                      "ResTarget": {
                        "location": 88,
                        "name": "b",
                      },
                    },
                  ],
                  "override": "OVERRIDING_NOT_SET",
                  "relation": {
                    "inh": true,
                    "location": 72,
                    "relname": "base_tbl_hist",
                    "relpersistence": "p",
                  },
                  "selectStmt": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "new",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "a",
                                      },
                                    },
                                  ],
                                  "location": 98,
                                },
                              },
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "new",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "b",
                                      },
                                    },
                                  ],
                                  "location": 105,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "event": "CMD_INSERT",
            "relation": {
              "inh": true,
              "location": 41,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "rulename": "base_tbl_log",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 175 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT b AS bb, a AS aa FROM base_tbl WHERE a>0",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 53,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "name": "bb",
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 40,
                      "name": "aa",
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 40,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 68,
                      },
                    },
                    "location": 69,
                    "name": [
                      {
                        "String": {
                          "sval": ">",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {},
                        "location": 70,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 191 1`] = `
[
  "INSERT INTO rw_view2 VALUES (3, 'Row 3')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 29,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 32,
                            "sval": {
                              "sval": "Row 3",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 198 1`] = `
[
  "EXPLAIN (costs off) UPDATE rw_view2 SET aaa=5 WHERE aaa=4",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "UpdateStmt": {
                "relation": {
                  "inh": true,
                  "location": 27,
                  "relname": "rw_view2",
                  "relpersistence": "p",
                },
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 40,
                      "name": "aaa",
                      "val": {
                        "A_Const": {
                          "ival": {
                            "ival": 5,
                          },
                          "location": 44,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "aaa",
                            },
                          },
                        ],
                        "location": 52,
                      },
                    },
                    "location": 55,
                    "name": [
                      {
                        "String": {
                          "sval": "=",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {
                          "ival": 4,
                        },
                        "location": 56,
                      },
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 208 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT * FROM base_tbl WHERE a>0 OFFSET 0",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 38,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOffset": {
                  "A_Const": {
                    "ival": {},
                    "location": 64,
                  },
                },
                "limitOption": "LIMIT_OPTION_COUNT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 53,
                      },
                    },
                    "location": 54,
                    "name": [
                      {
                        "String": {
                          "sval": ">",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {},
                        "location": 55,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 208 2`] = `
[
  " -- not updatable without rules/triggers
CREATE VIEW rw_view2 AS SELECT * FROM rw_view1 WHERE a<10",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 79,
                      "relname": "rw_view1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 72,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 72,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 94,
                      },
                    },
                    "location": 95,
                    "name": [
                      {
                        "String": {
                          "sval": "<",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {
                          "ival": 10,
                        },
                        "location": 96,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 53,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 226 1`] = `
[
  "CREATE RULE rw_view1_ins_rule AS ON INSERT TO rw_view1
  DO INSTEAD INSERT INTO base_tbl VALUES (NEW.a, NEW.b) RETURNING *",
  {
    "stmts": [
      {
        "stmt": {
          "RuleStmt": {
            "actions": [
              {
                "InsertStmt": {
                  "override": "OVERRIDING_NOT_SET",
                  "relation": {
                    "inh": true,
                    "location": 80,
                    "relname": "base_tbl",
                    "relpersistence": "p",
                  },
                  "returningList": [
                    {
                      "ResTarget": {
                        "location": 121,
                        "val": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "A_Star": {},
                              },
                            ],
                            "location": 121,
                          },
                        },
                      },
                    },
                  ],
                  "selectStmt": {
                    "SelectStmt": {
                      "limitOption": "LIMIT_OPTION_DEFAULT",
                      "op": "SETOP_NONE",
                      "valuesLists": [
                        {
                          "List": {
                            "items": [
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "new",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "a",
                                      },
                                    },
                                  ],
                                  "location": 97,
                                },
                              },
                              {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "new",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "b",
                                      },
                                    },
                                  ],
                                  "location": 104,
                                },
                              },
                            ],
                          },
                        },
                      ],
                    },
                  },
                },
              },
            ],
            "event": "CMD_INSERT",
            "instead": true,
            "relation": {
              "inh": true,
              "location": 46,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "rulename": "rw_view1_ins_rule",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 244 1`] = `
[
  "CREATE RULE rw_view1_upd_rule AS ON UPDATE TO rw_view1
  DO INSTEAD UPDATE base_tbl SET b=NEW.b WHERE a=OLD.a RETURNING NEW.*",
  {
    "stmts": [
      {
        "stmt": {
          "RuleStmt": {
            "actions": [
              {
                "UpdateStmt": {
                  "relation": {
                    "inh": true,
                    "location": 75,
                    "relname": "base_tbl",
                    "relpersistence": "p",
                  },
                  "returningList": [
                    {
                      "ResTarget": {
                        "location": 120,
                        "val": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "new",
                                },
                              },
                              {
                                "A_Star": {},
                              },
                            ],
                            "location": 120,
                          },
                        },
                      },
                    },
                  ],
                  "targetList": [
                    {
                      "ResTarget": {
                        "location": 88,
                        "name": "b",
                        "val": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "new",
                                },
                              },
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 90,
                          },
                        },
                      },
                    },
                  ],
                  "whereClause": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 102,
                        },
                      },
                      "location": 103,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "old",
                              },
                            },
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 104,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "event": "CMD_UPDATE",
            "instead": true,
            "relation": {
              "inh": true,
              "location": 46,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "rulename": "rw_view1_upd_rule",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 262 1`] = `
[
  "CREATE RULE rw_view1_del_rule AS ON DELETE TO rw_view1
  DO INSTEAD DELETE FROM base_tbl WHERE a=OLD.a RETURNING OLD.*",
  {
    "stmts": [
      {
        "stmt": {
          "RuleStmt": {
            "actions": [
              {
                "DeleteStmt": {
                  "relation": {
                    "inh": true,
                    "location": 80,
                    "relname": "base_tbl",
                    "relpersistence": "p",
                  },
                  "returningList": [
                    {
                      "ResTarget": {
                        "location": 113,
                        "val": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "old",
                                },
                              },
                              {
                                "A_Star": {},
                              },
                            ],
                            "location": 113,
                          },
                        },
                      },
                    },
                  ],
                  "whereClause": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 95,
                        },
                      },
                      "location": 96,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "old",
                              },
                            },
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 97,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "event": "CMD_DELETE",
            "instead": true,
            "relation": {
              "inh": true,
              "location": 46,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "rulename": "rw_view1_del_rule",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 280 1`] = `
[
  "INSERT INTO rw_view2 VALUES (3, 'Row 3') RETURNING *",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "returningList": [
              {
                "ResTarget": {
                  "location": 51,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 51,
                    },
                  },
                },
              },
            ],
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 29,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 32,
                            "sval": {
                              "sval": "Row 3",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 286 1`] = `
[
  "EXPLAIN (costs off) UPDATE rw_view2 SET a=3 WHERE a=2",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "UpdateStmt": {
                "relation": {
                  "inh": true,
                  "location": 27,
                  "relname": "rw_view2",
                  "relpersistence": "p",
                },
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 40,
                      "name": "a",
                      "val": {
                        "A_Const": {
                          "ival": {
                            "ival": 3,
                          },
                          "location": 42,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 50,
                      },
                    },
                    "location": 51,
                    "name": [
                      {
                        "String": {
                          "sval": "=",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {
                          "ival": 2,
                        },
                        "location": 52,
                      },
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 304 1`] = `
[
  "SELECT table_name, is_updatable, is_insertable_into,
       is_trigger_updatable, is_trigger_deletable,
       is_trigger_insertable_into
  FROM information_schema.views
 WHERE table_name LIKE 'rw_view%'
 ORDER BY table_name",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 145,
                  "relname": "views",
                  "relpersistence": "p",
                  "schemaname": "information_schema",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 214,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "table_name",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_updatable",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 33,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_insertable_into",
                          },
                        },
                      ],
                      "location": 33,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 60,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_trigger_updatable",
                          },
                        },
                      ],
                      "location": 60,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 82,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_trigger_deletable",
                          },
                        },
                      ],
                      "location": 82,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 111,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "is_trigger_insertable_into",
                          },
                        },
                      ],
                      "location": 111,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_LIKE",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "table_name",
                        },
                      },
                    ],
                    "location": 177,
                  },
                },
                "location": 188,
                "name": [
                  {
                    "String": {
                      "sval": "~~",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "location": 193,
                    "sval": {
                      "sval": "rw_view%",
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 316 1`] = `
[
  "CREATE FUNCTION rw_view1_trig_fn()
RETURNS trigger AS
$$
BEGIN
  IF TG_OP = 'INSERT' THEN
    INSERT INTO base_tbl VALUES (NEW.a, NEW.b);
    RETURN NEW;
  ELSIF TG_OP = 'UPDATE' THEN
    UPDATE base_tbl SET b=NEW.b WHERE a=OLD.a;
    RETURN NEW;
  ELSIF TG_OP = 'DELETE' THEN
    DELETE FROM base_tbl WHERE a=OLD.a;
    RETURN OLD;
  END IF;
END;
$$
LANGUAGE plpgsql",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "rw_view1_trig_fn",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
BEGIN
  IF TG_OP = 'INSERT' THEN
    INSERT INTO base_tbl VALUES (NEW.a, NEW.b);
    RETURN NEW;
  ELSIF TG_OP = 'UPDATE' THEN
    UPDATE base_tbl SET b=NEW.b WHERE a=OLD.a;
    RETURN NEW;
  ELSIF TG_OP = 'DELETE' THEN
    DELETE FROM base_tbl WHERE a=OLD.a;
    RETURN OLD;
  END IF;
END;
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 51,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 351,
                },
              },
            ],
            "returnType": {
              "location": 43,
              "names": [
                {
                  "String": {
                    "sval": "trigger",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 334 1`] = `
[
  "CREATE TRIGGER rw_view1_ins_trig INSTEAD OF INSERT ON rw_view1
  FOR EACH ROW EXECUTE PROCEDURE rw_view1_trig_fn()",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTrigStmt": {
            "events": 4,
            "funcname": [
              {
                "String": {
                  "sval": "rw_view1_trig_fn",
                },
              },
            ],
            "relation": {
              "inh": true,
              "location": 54,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "row": true,
            "timing": 64,
            "trigname": "rw_view1_ins_trig",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 354 1`] = `
[
  "CREATE TRIGGER rw_view1_upd_trig INSTEAD OF UPDATE ON rw_view1
  FOR EACH ROW EXECUTE PROCEDURE rw_view1_trig_fn()",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTrigStmt": {
            "events": 16,
            "funcname": [
              {
                "String": {
                  "sval": "rw_view1_trig_fn",
                },
              },
            ],
            "relation": {
              "inh": true,
              "location": 54,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "row": true,
            "timing": 64,
            "trigname": "rw_view1_upd_trig",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 374 1`] = `
[
  "CREATE TRIGGER rw_view1_del_trig INSTEAD OF DELETE ON rw_view1
  FOR EACH ROW EXECUTE PROCEDURE rw_view1_trig_fn()",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTrigStmt": {
            "events": 8,
            "funcname": [
              {
                "String": {
                  "sval": "rw_view1_trig_fn",
                },
              },
            ],
            "relation": {
              "inh": true,
              "location": 54,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "row": true,
            "timing": 64,
            "trigname": "rw_view1_del_trig",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 411 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT b AS bb, a AS aa FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 53,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "name": "bb",
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 40,
                      "name": "aa",
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 40,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 413 1`] = `
[
  "CREATE FUNCTION rw_view1_aa(x rw_view1)
  RETURNS int AS $$ SELECT x.aa $$ LANGUAGE sql",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "rw_view1_aa",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": " SELECT x.aa ",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 54,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "sql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 75,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 30,
                    "names": [
                      {
                        "String": {
                          "sval": "rw_view1",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                  "name": "x",
                },
              },
            ],
            "returnType": {
              "location": 50,
              "names": [
                {
                  "String": {
                    "sval": "pg_catalog",
                  },
                },
                {
                  "String": {
                    "sval": "int4",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 416 1`] = `
[
  "UPDATE rw_view1 v SET bb='Updated row 2' WHERE rw_view1_aa(v)=2
  RETURNING rw_view1_aa(v), v.bb",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "alias": {
                "aliasname": "v",
              },
              "inh": true,
              "location": 7,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "returningList": [
              {
                "ResTarget": {
                  "location": 76,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "v",
                                },
                              },
                            ],
                            "location": 88,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "rw_view1_aa",
                          },
                        },
                      ],
                      "location": 76,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 92,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "v",
                          },
                        },
                        {
                          "String": {
                            "sval": "bb",
                          },
                        },
                      ],
                      "location": 92,
                    },
                  },
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 22,
                  "name": "bb",
                  "val": {
                    "A_Const": {
                      "location": 25,
                      "sval": {
                        "sval": "Updated row 2",
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "FuncCall": {
                    "args": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "v",
                              },
                            },
                          ],
                          "location": 59,
                        },
                      },
                    ],
                    "funcformat": "COERCE_EXPLICIT_CALL",
                    "funcname": [
                      {
                        "String": {
                          "sval": "rw_view1_aa",
                        },
                      },
                    ],
                    "location": 47,
                  },
                },
                "location": 61,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 62,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 420 1`] = `
[
  "EXPLAIN (costs off)
UPDATE rw_view1 v SET bb='Updated row 2' WHERE rw_view1_aa(v)=2
  RETURNING rw_view1_aa(v), v.bb",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "UpdateStmt": {
                "relation": {
                  "alias": {
                    "aliasname": "v",
                  },
                  "inh": true,
                  "location": 27,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
                "returningList": [
                  {
                    "ResTarget": {
                      "location": 96,
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "v",
                                    },
                                  },
                                ],
                                "location": 108,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "rw_view1_aa",
                              },
                            },
                          ],
                          "location": 96,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 112,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "v",
                              },
                            },
                            {
                              "String": {
                                "sval": "bb",
                              },
                            },
                          ],
                          "location": 112,
                        },
                      },
                    },
                  },
                ],
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 42,
                      "name": "bb",
                      "val": {
                        "A_Const": {
                          "location": 45,
                          "sval": {
                            "sval": "Updated row 2",
                          },
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "FuncCall": {
                        "args": [
                          {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "v",
                                  },
                                },
                              ],
                              "location": 79,
                            },
                          },
                        ],
                        "funcformat": "COERCE_EXPLICIT_CALL",
                        "funcname": [
                          {
                            "String": {
                              "sval": "rw_view1_aa",
                            },
                          },
                        ],
                        "location": 67,
                      },
                    },
                    "location": 81,
                    "name": [
                      {
                        "String": {
                          "sval": "=",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {
                          "ival": 2,
                        },
                        "location": 82,
                      },
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 432 1`] = `
[
  "SET SESSION AUTHORIZATION regress_view_user1",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "args": [
              {
                "A_Const": {
                  "location": 26,
                  "sval": {
                    "sval": "regress_view_user1",
                  },
                },
              },
            ],
            "kind": "VAR_SET_VALUE",
            "name": "session_authorization",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 438 1`] = `
[
  "GRANT SELECT ON base_tbl TO regress_view_user2",
  {
    "stmts": [
      {
        "stmt": {
          "GrantStmt": {
            "behavior": "DROP_RESTRICT",
            "grantees": [
              {
                "RoleSpec": {
                  "location": 28,
                  "rolename": "regress_view_user2",
                  "roletype": "ROLESPEC_CSTRING",
                },
              },
            ],
            "is_grant": true,
            "objects": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 16,
                  "relname": "base_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "privileges": [
              {
                "AccessPriv": {
                  "priv_name": "select",
                },
              },
            ],
            "targtype": "ACL_TARGET_OBJECT",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 446 1`] = `
[
  " -- ok
SELECT * FROM rw_view1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 21,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 14,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 14,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 447 1`] = `
[
  " -- ok
SELECT * FROM rw_view2",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 21,
                  "relname": "rw_view2",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 14,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 14,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 448 1`] = `
[
  " -- ok

INSERT INTO base_tbl VALUES (3, 'Row 3', 3.0)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 20,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 37,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 40,
                            "sval": {
                              "sval": "Row 3",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "3.0",
                            },
                            "location": 49,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 452 1`] = `
[
  " -- not allowed

UPDATE base_tbl SET a=a, c=c",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "a",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 39,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 42,
                  "name": "c",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 44,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 454 1`] = `
[
  " -- ok
UPDATE base_tbl SET b=b",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 14,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 27,
                  "name": "b",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 29,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 455 1`] = `
[
  " -- not allowed
UPDATE rw_view1 SET bb=bb, cc=cc",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "bb",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "bb",
                          },
                        },
                      ],
                      "location": 39,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 43,
                  "name": "cc",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "cc",
                          },
                        },
                      ],
                      "location": 46,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 456 1`] = `
[
  " -- ok
UPDATE rw_view1 SET aa=aa",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 14,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 27,
                  "name": "aa",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "aa",
                          },
                        },
                      ],
                      "location": 30,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 457 1`] = `
[
  " -- not allowed
UPDATE rw_view2 SET aa=aa, cc=cc",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "aa",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "aa",
                          },
                        },
                      ],
                      "location": 39,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 43,
                  "name": "cc",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "cc",
                          },
                        },
                      ],
                      "location": 46,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 458 1`] = `
[
  " -- ok
UPDATE rw_view2 SET bb=bb",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 14,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 27,
                  "name": "bb",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "bb",
                          },
                        },
                      ],
                      "location": 30,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 459 1`] = `
[
  " -- not allowed

DELETE FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 29,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 461 1`] = `
[
  " -- not allowed
DELETE FROM rw_view1",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 462 1`] = `
[
  " -- not allowed
DELETE FROM rw_view2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 463 1`] = `
[
  " -- not allowed
RESET SESSION AUTHORIZATION",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "kind": "VAR_RESET",
            "name": "session_authorization",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 473 1`] = `
[
  " -- ok
DELETE FROM base_tbl WHERE a=1",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 19,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 34,
                  },
                },
                "location": 35,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 36,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 474 1`] = `
[
  " -- ok
DELETE FROM rw_view1 WHERE aa=2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 19,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "aa",
                        },
                      },
                    ],
                    "location": 34,
                  },
                },
                "location": 36,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 37,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 475 1`] = `
[
  " -- not allowed
DELETE FROM rw_view2 WHERE aa=2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "aa",
                        },
                      },
                    ],
                    "location": 43,
                  },
                },
                "location": 45,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 46,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 504 1`] = `
[
  "  -- not allowed
SELECT * FROM rw_view1 FOR UPDATE",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 31,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "lockingClause": [
              {
                "LockingClause": {
                  "strength": "LCS_FORUPDATE",
                  "waitPolicy": "LockWaitBlock",
                },
              },
            ],
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 24,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 24,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 505 1`] = `
[
  "  -- not allowed
UPDATE rw_view1 SET b = 'foo' WHERE a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "b",
                  "val": {
                    "A_Const": {
                      "location": 41,
                      "sval": {
                        "sval": "foo",
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 53,
                  },
                },
                "location": 55,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 57,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 510 1`] = `
[
  "  -- not allowed
SELECT * FROM rw_view2 FOR UPDATE",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 31,
                  "relname": "rw_view2",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "lockingClause": [
              {
                "LockingClause": {
                  "strength": "LCS_FORUPDATE",
                  "waitPolicy": "LockWaitBlock",
                },
              },
            ],
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 24,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 24,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 511 1`] = `
[
  "  -- not allowed
UPDATE rw_view2 SET b = 'bar' WHERE a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "b",
                  "val": {
                    "A_Const": {
                      "location": 41,
                      "sval": {
                        "sval": "bar",
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 53,
                  },
                },
                "location": 55,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 57,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 588 1`] = `
[
  " -- not allowed
UPDATE base_tbl SET a=a",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "a",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 38,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 602 1`] = `
[
  " -- not allowed
UPDATE rw_view1 SET cc=cc",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "cc",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "cc",
                          },
                        },
                      ],
                      "location": 39,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 604 1`] = `
[
  " -- not allowed
UPDATE rw_view1 SET bb=bb",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "bb",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "bb",
                          },
                        },
                      ],
                      "location": 39,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 650 1`] = `
[
  "  -- not allowed
UPDATE rw_view2 SET aaa=aaa",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "aaa",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "aaa",
                          },
                        },
                      ],
                      "location": 41,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 655 1`] = `
[
  "GRANT SELECT ON base_tbl TO regress_view_user1",
  {
    "stmts": [
      {
        "stmt": {
          "GrantStmt": {
            "behavior": "DROP_RESTRICT",
            "grantees": [
              {
                "RoleSpec": {
                  "location": 28,
                  "rolename": "regress_view_user1",
                  "roletype": "ROLESPEC_CSTRING",
                },
              },
            ],
            "is_grant": true,
            "objects": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 16,
                  "relname": "base_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "privileges": [
              {
                "AccessPriv": {
                  "priv_name": "select",
                },
              },
            ],
            "targtype": "ACL_TARGET_OBJECT",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 659 1`] = `
[
  " -- ok
UPDATE rw_view1 SET aa=aa, bb=bb",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 14,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 27,
                  "name": "aa",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "aa",
                          },
                        },
                      ],
                      "location": 30,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 34,
                  "name": "bb",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "bb",
                          },
                        },
                      ],
                      "location": 37,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 676 1`] = `
[
  "  -- not allowed
UPDATE rw_view2 SET bbb=bbb",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "bbb",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "bbb",
                          },
                        },
                      ],
                      "location": 41,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 691 1`] = `
[
  "  -- not allowed
UPDATE rw_view2 SET ccc=ccc",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "ccc",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ccc",
                          },
                        },
                      ],
                      "location": 41,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 702 1`] = `
[
  "GRANT SELECT ON base_tbl TO regress_view_user3",
  {
    "stmts": [
      {
        "stmt": {
          "GrantStmt": {
            "behavior": "DROP_RESTRICT",
            "grantees": [
              {
                "RoleSpec": {
                  "location": 28,
                  "rolename": "regress_view_user3",
                  "roletype": "ROLESPEC_CSTRING",
                },
              },
            ],
            "is_grant": true,
            "objects": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 16,
                  "relname": "base_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "privileges": [
              {
                "AccessPriv": {
                  "priv_name": "select",
                },
              },
            ],
            "targtype": "ACL_TARGET_OBJECT",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 713 1`] = `
[
  "REVOKE SELECT, UPDATE ON base_tbl FROM regress_view_user1",
  {
    "stmts": [
      {
        "stmt": {
          "GrantStmt": {
            "behavior": "DROP_RESTRICT",
            "grantees": [
              {
                "RoleSpec": {
                  "location": 39,
                  "rolename": "regress_view_user1",
                  "roletype": "ROLESPEC_CSTRING",
                },
              },
            ],
            "objects": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 25,
                  "relname": "base_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "privileges": [
              {
                "AccessPriv": {
                  "priv_name": "select",
                },
              },
              {
                "AccessPriv": {
                  "priv_name": "update",
                },
              },
            ],
            "targtype": "ACL_TARGET_OBJECT",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 733 1`] = `
[
  "REVOKE SELECT, UPDATE ON base_tbl FROM regress_view_user2",
  {
    "stmts": [
      {
        "stmt": {
          "GrantStmt": {
            "behavior": "DROP_RESTRICT",
            "grantees": [
              {
                "RoleSpec": {
                  "location": 39,
                  "rolename": "regress_view_user2",
                  "roletype": "ROLESPEC_CSTRING",
                },
              },
            ],
            "objects": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 25,
                  "relname": "base_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "privileges": [
              {
                "AccessPriv": {
                  "priv_name": "select",
                },
              },
              {
                "AccessPriv": {
                  "priv_name": "update",
                },
              },
            ],
            "targtype": "ACL_TARGET_OBJECT",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 751 1`] = `
[
  "DROP USER regress_view_user1",
  {
    "stmts": [
      {
        "stmt": {
          "DropRoleStmt": {
            "roles": [
              {
                "RoleSpec": {
                  "location": 10,
                  "rolename": "regress_view_user1",
                  "roletype": "ROLESPEC_CSTRING",
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 791 1`] = `
[
  "CREATE TRIGGER rw_view1_ins_trig AFTER INSERT ON base_tbl
  FOR EACH ROW EXECUTE PROCEDURE rw_view1_trig_fn()",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTrigStmt": {
            "events": 4,
            "funcname": [
              {
                "String": {
                  "sval": "rw_view1_trig_fn",
                },
              },
            ],
            "relation": {
              "inh": true,
              "location": 49,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "row": true,
            "trigname": "rw_view1_ins_trig",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 799 1`] = `
[
  "DROP VIEW rw_view1",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "rw_view1",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 809 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT * FROM base_tbl ORDER BY a+b",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 38,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "sortClause": [
                  {
                    "SortBy": {
                      "location": -1,
                      "node": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "location": 56,
                            },
                          },
                          "location": 57,
                          "name": [
                            {
                              "String": {
                                "sval": "+",
                              },
                            },
                          ],
                          "rexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "b",
                                  },
                                },
                              ],
                              "location": 58,
                            },
                          },
                        },
                      },
                      "sortby_dir": "SORTBY_DEFAULT",
                      "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                    },
                  },
                ],
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 816 1`] = `
[
  "EXPLAIN (verbose, costs off) UPDATE rw_view1 SET b = b + 1 RETURNING *",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "verbose",
                  "location": 9,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 18,
                },
              },
            ],
            "query": {
              "UpdateStmt": {
                "relation": {
                  "inh": true,
                  "location": 36,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
                "returningList": [
                  {
                    "ResTarget": {
                      "location": 69,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 69,
                        },
                      },
                    },
                  },
                ],
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 49,
                      "name": "b",
                      "val": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "b",
                                  },
                                },
                              ],
                              "location": 53,
                            },
                          },
                          "location": 55,
                          "name": [
                            {
                              "String": {
                                "sval": "+",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 57,
                            },
                          },
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 827 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT * FROM base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 38,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 829 1`] = `
[
  "UPDATE rw_view1 SET arr[1] = 42, arr[2] = 77 WHERE a = 3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "indirection": [
                    {
                      "A_Indices": {
                        "uidx": {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 24,
                          },
                        },
                      },
                    },
                  ],
                  "location": 20,
                  "name": "arr",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 42,
                      },
                      "location": 29,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "indirection": [
                    {
                      "A_Indices": {
                        "uidx": {
                          "A_Const": {
                            "ival": {
                              "ival": 2,
                            },
                            "location": 37,
                          },
                        },
                      },
                    },
                  ],
                  "location": 33,
                  "name": "arr",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 77,
                      },
                      "location": 42,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 51,
                  },
                },
                "location": 53,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 55,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 840 1`] = `
[
  "CREATE VIEW rw_view1 AS
  SELECT ctid, sin(a) s, a, cos(a) c
  FROM base_tbl
  WHERE a != 0
  ORDER BY abs(a)",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 68,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "sortClause": [
                  {
                    "SortBy": {
                      "location": -1,
                      "node": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 107,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "abs",
                              },
                            },
                          ],
                          "location": 103,
                        },
                      },
                      "sortby_dir": "SORTBY_DEFAULT",
                      "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                    },
                  },
                ],
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 33,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ctid",
                              },
                            },
                          ],
                          "location": 33,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 39,
                      "name": "s",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 43,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "sin",
                              },
                            },
                          ],
                          "location": 39,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 49,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 49,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 52,
                      "name": "c",
                      "val": {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 56,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "cos",
                              },
                            },
                          ],
                          "location": 52,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 85,
                      },
                    },
                    "location": 87,
                    "name": [
                      {
                        "String": {
                          "sval": "<>",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {},
                        "location": 90,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 846 1`] = `
[
  " -- should fail
INSERT INTO rw_view1 (s, c, a) VALUES (null, null, 1.1)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 38,
                  "name": "s",
                },
              },
              {
                "ResTarget": {
                  "location": 41,
                  "name": "c",
                },
              },
              {
                "ResTarget": {
                  "location": 44,
                  "name": "a",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 55,
                          },
                        },
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 61,
                          },
                        },
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "1.1",
                            },
                            "location": 67,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 847 1`] = `
[
  " -- should fail
INSERT INTO rw_view1 (a) VALUES (1.1) RETURNING a, s, c",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 38,
                  "name": "a",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "returningList": [
              {
                "ResTarget": {
                  "location": 64,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 64,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 67,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "s",
                          },
                        },
                      ],
                      "location": 67,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 70,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 70,
                    },
                  },
                },
              },
            ],
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "1.1",
                            },
                            "location": 49,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 848 1`] = `
[
  " -- OK
UPDATE rw_view1 SET s = s WHERE a = 1.1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 14,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 27,
                  "name": "s",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "s",
                          },
                        },
                      ],
                      "location": 31,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 39,
                  },
                },
                "location": 41,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "fval": {
                      "fval": "1.1",
                    },
                    "location": 43,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 849 1`] = `
[
  " -- should fail
UPDATE rw_view1 SET a = 1.05 WHERE a = 1.1 RETURNING s",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "returningList": [
              {
                "ResTarget": {
                  "location": 69,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "s",
                          },
                        },
                      ],
                      "location": 69,
                    },
                  },
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "a",
                  "val": {
                    "A_Const": {
                      "fval": {
                        "fval": "1.05",
                      },
                      "location": 40,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 51,
                  },
                },
                "location": 53,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "fval": {
                      "fval": "1.1",
                    },
                    "location": 55,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 850 1`] = `
[
  " -- OK
DELETE FROM rw_view1 WHERE a = 1.05",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 19,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 34,
                  },
                },
                "location": 36,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "fval": {
                      "fval": "1.05",
                    },
                    "location": 38,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 851 1`] = `
[
  " -- OK

CREATE VIEW rw_view2 AS
  SELECT s, c, s/c t, a base_a, ctid
  FROM rw_view1",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 76,
                      "relname": "rw_view1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 41,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "s",
                              },
                            },
                          ],
                          "location": 41,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 44,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "c",
                              },
                            },
                          ],
                          "location": 44,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 47,
                      "name": "t",
                      "val": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "s",
                                  },
                                },
                              ],
                              "location": 47,
                            },
                          },
                          "location": 48,
                          "name": [
                            {
                              "String": {
                                "sval": "/",
                              },
                            },
                          ],
                          "rexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "c",
                                  },
                                },
                              ],
                              "location": 49,
                            },
                          },
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 54,
                      "name": "base_a",
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 54,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 64,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ctid",
                              },
                            },
                          ],
                          "location": 64,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 20,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 857 1`] = `
[
  " -- should fail
INSERT INTO rw_view2(s, c, base_a) VALUES (null, null, 1.1)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "s",
                },
              },
              {
                "ResTarget": {
                  "location": 40,
                  "name": "c",
                },
              },
              {
                "ResTarget": {
                  "location": 43,
                  "name": "base_a",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 59,
                          },
                        },
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 65,
                          },
                        },
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "1.1",
                            },
                            "location": 71,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 858 1`] = `
[
  " -- should fail
INSERT INTO rw_view2(base_a) VALUES (1.1) RETURNING t",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "base_a",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "returningList": [
              {
                "ResTarget": {
                  "location": 68,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t",
                          },
                        },
                      ],
                      "location": 68,
                    },
                  },
                },
              },
            ],
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "1.1",
                            },
                            "location": 53,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 859 1`] = `
[
  " -- OK
UPDATE rw_view2 SET s = s WHERE base_a = 1.1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 14,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 27,
                  "name": "s",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "s",
                          },
                        },
                      ],
                      "location": 31,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "base_a",
                        },
                      },
                    ],
                    "location": 39,
                  },
                },
                "location": 46,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "fval": {
                      "fval": "1.1",
                    },
                    "location": 48,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 860 1`] = `
[
  " -- should fail
UPDATE rw_view2 SET t = t WHERE base_a = 1.1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "t",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t",
                          },
                        },
                      ],
                      "location": 40,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "base_a",
                        },
                      },
                    ],
                    "location": 48,
                  },
                },
                "location": 55,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "fval": {
                      "fval": "1.1",
                    },
                    "location": 57,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 861 1`] = `
[
  " -- should fail
UPDATE rw_view2 SET base_a = 1.05 WHERE base_a = 1.1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "base_a",
                  "val": {
                    "A_Const": {
                      "fval": {
                        "fval": "1.05",
                      },
                      "location": 45,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "base_a",
                        },
                      },
                    ],
                    "location": 56,
                  },
                },
                "location": 63,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "fval": {
                      "fval": "1.1",
                    },
                    "location": 65,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 862 1`] = `
[
  " -- OK
DELETE FROM rw_view2 WHERE base_a = 1.05 RETURNING base_a, s, c, t",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 19,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "returningList": [
              {
                "ResTarget": {
                  "location": 58,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "base_a",
                          },
                        },
                      ],
                      "location": 58,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 66,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "s",
                          },
                        },
                      ],
                      "location": 66,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 69,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 69,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 72,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "t",
                          },
                        },
                      ],
                      "location": 72,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "base_a",
                        },
                      },
                    ],
                    "location": 34,
                  },
                },
                "location": 41,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "fval": {
                      "fval": "1.05",
                    },
                    "location": 43,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 863 1`] = `
[
  " -- OK

CREATE VIEW rw_view3 AS
  SELECT s, c, s/c t, ctid
  FROM rw_view1",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 66,
                      "relname": "rw_view1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 41,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "s",
                              },
                            },
                          ],
                          "location": 41,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 44,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "c",
                              },
                            },
                          ],
                          "location": 44,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 47,
                      "name": "t",
                      "val": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "s",
                                  },
                                },
                              ],
                              "location": 47,
                            },
                          },
                          "location": 48,
                          "name": [
                            {
                              "String": {
                                "sval": "/",
                              },
                            },
                          ],
                          "rexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "c",
                                  },
                                },
                              ],
                              "location": 49,
                            },
                          },
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 54,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ctid",
                              },
                            },
                          ],
                          "location": 54,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 20,
              "relname": "rw_view3",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 869 1`] = `
[
  "INSERT INTO rw_view3 VALUES (null, null, null, null)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "rw_view3",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 29,
                          },
                        },
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 35,
                          },
                        },
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 41,
                          },
                        },
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 47,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 869 2`] = `
[
  " -- should fail
INSERT INTO rw_view3(s) VALUES (null)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "s",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view3",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 48,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 870 1`] = `
[
  " -- should fail
UPDATE rw_view3 SET s = s",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view3",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "s",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "s",
                          },
                        },
                      ],
                      "location": 40,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 871 1`] = `
[
  " -- should fail
DELETE FROM rw_view3 WHERE s = sin(0.1)",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view3",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "s",
                        },
                      },
                    ],
                    "location": 43,
                  },
                },
                "location": 45,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "FuncCall": {
                    "args": [
                      {
                        "A_Const": {
                          "fval": {
                            "fval": "0.1",
                          },
                          "location": 51,
                        },
                      },
                    ],
                    "funcformat": "COERCE_EXPLICIT_CALL",
                    "funcname": [
                      {
                        "String": {
                          "sval": "sin",
                        },
                      },
                    ],
                    "location": 47,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 872 1`] = `
[
  " -- should be OK
SELECT * FROM base_tbl ORDER BY a",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 31,
                  "relname": "base_tbl",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 49,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 24,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 24,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 890 1`] = `
[
  "SELECT events & 4 != 0 AS upd,
       events & 8 != 0 AS ins,
       events & 16 != 0 AS del
  FROM pg_catalog.pg_relation_is_updatable('rw_view3'::regclass, false) t(events)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "t",
                    "colnames": [
                      {
                        "String": {
                          "sval": "events",
                        },
                      },
                    ],
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "TypeCast": {
                                    "arg": {
                                      "A_Const": {
                                        "location": 136,
                                        "sval": {
                                          "sval": "rw_view3",
                                        },
                                      },
                                    },
                                    "location": 146,
                                    "typeName": {
                                      "location": 148,
                                      "names": [
                                        {
                                          "String": {
                                            "sval": "regclass",
                                          },
                                        },
                                      ],
                                      "typemod": -1,
                                    },
                                  },
                                },
                                {
                                  "A_Const": {
                                    "boolval": {},
                                    "location": 158,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "pg_catalog",
                                  },
                                },
                                {
                                  "String": {
                                    "sval": "pg_relation_is_updatable",
                                  },
                                },
                              ],
                              "location": 100,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "name": "upd",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "events",
                                  },
                                },
                              ],
                              "location": 7,
                            },
                          },
                          "location": 14,
                          "name": [
                            {
                              "String": {
                                "sval": "&",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 4,
                              },
                              "location": 16,
                            },
                          },
                        },
                      },
                      "location": 18,
                      "name": [
                        {
                          "String": {
                            "sval": "<>",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {},
                          "location": 21,
                        },
                      },
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 38,
                  "name": "ins",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "events",
                                  },
                                },
                              ],
                              "location": 38,
                            },
                          },
                          "location": 45,
                          "name": [
                            {
                              "String": {
                                "sval": "&",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 8,
                              },
                              "location": 47,
                            },
                          },
                        },
                      },
                      "location": 49,
                      "name": [
                        {
                          "String": {
                            "sval": "<>",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {},
                          "location": 52,
                        },
                      },
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 69,
                  "name": "del",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "events",
                                  },
                                },
                              ],
                              "location": 69,
                            },
                          },
                          "location": 76,
                          "name": [
                            {
                              "String": {
                                "sval": "&",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 16,
                              },
                              "location": 78,
                            },
                          },
                        },
                      },
                      "location": 81,
                      "name": [
                        {
                          "String": {
                            "sval": "<>",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {},
                          "location": 84,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 902 1`] = `
[
  "INSERT INTO base_tbl (id) VALUES (1)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 22,
                  "name": "id",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 34,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 906 1`] = `
[
  "  -- error
INSERT INTO rw_view1 (id, idplus1) VALUES (6, 7)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 33,
                  "name": "id",
                },
              },
              {
                "ResTarget": {
                  "location": 37,
                  "name": "idplus1",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 6,
                            },
                            "location": 54,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 7,
                            },
                            "location": 57,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 911 1`] = `
[
  "UPDATE base_tbl SET id = 2000 WHERE id = 2",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 20,
                  "name": "id",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 2000,
                      },
                      "location": 25,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "id",
                        },
                      },
                    ],
                    "location": 36,
                  },
                },
                "location": 39,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 41,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 925 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT * FROM base_tbl_parent",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 38,
                      "relname": "base_tbl_parent",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 928 1`] = `
[
  "SELECT * FROM rw_view1 ORDER BY a",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 32,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 935 1`] = `
[
  "UPDATE rw_view1 SET a = a*10 WHERE a IN (-1, 1)",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 20,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 24,
                        },
                      },
                      "location": 25,
                      "name": [
                        {
                          "String": {
                            "sval": "*",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10,
                          },
                          "location": 26,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_IN",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 35,
                  },
                },
                "location": 37,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "List": {
                    "items": [
                      {
                        "A_Const": {
                          "ival": {},
                          "location": 41,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 45,
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 935 2`] = `
[
  " -- Should produce -10 and 10
UPDATE ONLY rw_view1 SET a = a*10 WHERE a IN (-2, 2)",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "location": 42,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 55,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 59,
                        },
                      },
                      "location": 60,
                      "name": [
                        {
                          "String": {
                            "sval": "*",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10,
                          },
                          "location": 61,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_IN",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 70,
                  },
                },
                "location": 72,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "List": {
                    "items": [
                      {
                        "A_Const": {
                          "ival": {},
                          "location": 76,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 80,
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 936 1`] = `
[
  " -- Should produce -20 and 20
UPDATE rw_view2 SET a = a*10 WHERE a IN (-3, 3)",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 37,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 50,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 54,
                        },
                      },
                      "location": 55,
                      "name": [
                        {
                          "String": {
                            "sval": "*",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10,
                          },
                          "location": 56,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_IN",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 65,
                  },
                },
                "location": 67,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "List": {
                    "items": [
                      {
                        "A_Const": {
                          "ival": {},
                          "location": 71,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 3,
                          },
                          "location": 75,
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 937 1`] = `
[
  " -- Should produce -30 only
UPDATE ONLY rw_view2 SET a = a*10 WHERE a IN (-4, 4)",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "location": 40,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 53,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 57,
                        },
                      },
                      "location": 58,
                      "name": [
                        {
                          "String": {
                            "sval": "*",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10,
                          },
                          "location": 59,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_IN",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 68,
                  },
                },
                "location": 70,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "List": {
                    "items": [
                      {
                        "A_Const": {
                          "ival": {},
                          "location": 74,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 4,
                          },
                          "location": 78,
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 940 1`] = `
[
  " -- Should delete -5 and 5
DELETE FROM ONLY rw_view1 WHERE a IN (-6, 6)",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "location": 44,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_IN",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 59,
                  },
                },
                "location": 61,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "List": {
                    "items": [
                      {
                        "A_Const": {
                          "ival": {},
                          "location": 65,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 6,
                          },
                          "location": 69,
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 941 1`] = `
[
  " -- Should delete -6 and 6
DELETE FROM rw_view2 WHERE a IN (-7, 7)",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 39,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_IN",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 54,
                  },
                },
                "location": 56,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "List": {
                    "items": [
                      {
                        "A_Const": {
                          "ival": {},
                          "location": 60,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 7,
                          },
                          "location": 64,
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 942 1`] = `
[
  " -- Should delete -7 only
DELETE FROM ONLY rw_view2 WHERE a IN (-8, 8)",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "location": 43,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_IN",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 58,
                  },
                },
                "location": 60,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "List": {
                    "items": [
                      {
                        "A_Const": {
                          "ival": {},
                          "location": 64,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 8,
                          },
                          "location": 68,
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 943 1`] = `
[
  " -- Should delete -8 only

SELECT * FROM ONLY base_tbl_parent ORDER BY a",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "location": 46,
                  "relname": "base_tbl_parent",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 71,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 34,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 34,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 948 1`] = `
[
  "CREATE TABLE other_tbl_parent (id int)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "other_tbl_parent",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "id",
                  "is_local": true,
                  "location": 31,
                  "typeName": {
                    "location": 34,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 953 1`] = `
[
  "EXPLAIN (costs off)
UPDATE rw_view1 SET a = a + 1000 FROM other_tbl_parent WHERE a = id",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "UpdateStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 58,
                      "relname": "other_tbl_parent",
                      "relpersistence": "p",
                    },
                  },
                ],
                "relation": {
                  "inh": true,
                  "location": 27,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 40,
                      "name": "a",
                      "val": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "location": 44,
                            },
                          },
                          "location": 46,
                          "name": [
                            {
                              "String": {
                                "sval": "+",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 1000,
                              },
                              "location": 48,
                            },
                          },
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 81,
                      },
                    },
                    "location": 83,
                    "name": [
                      {
                        "String": {
                          "sval": "=",
                        },
                      },
                    ],
                    "rexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "id",
                            },
                          },
                        ],
                        "location": 85,
                      },
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 960 1`] = `
[
  "DROP TABLE base_tbl_parent, base_tbl_child CASCADE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "base_tbl_parent",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "base_tbl_child",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 968 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT * FROM base_tbl WHERE a < b
  WITH LOCAL CHECK OPTION",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 38,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 53,
                      },
                    },
                    "location": 55,
                    "name": [
                      {
                        "String": {
                          "sval": "<",
                        },
                      },
                    ],
                    "rexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                        ],
                        "location": 57,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "LOCAL_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 971 1`] = `
[
  "SELECT * FROM information_schema.views WHERE table_name = 'rw_view1'",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "views",
                  "relpersistence": "p",
                  "schemaname": "information_schema",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "table_name",
                        },
                      },
                    ],
                    "location": 45,
                  },
                },
                "location": 56,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "location": 58,
                    "sval": {
                      "sval": "rw_view1",
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 977 1`] = `
[
  " -- should fail
INSERT INTO rw_view1(a) VALUES (9)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "a",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 9,
                            },
                            "location": 48,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 999 1`] = `
[
  "UPDATE rw_view2 SET a = a - 10",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 20,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 24,
                        },
                      },
                      "location": 26,
                      "name": [
                        {
                          "String": {
                            "sval": "-",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10,
                          },
                          "location": 28,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 999 2`] = `
[
  " -- should fail
UPDATE rw_view2 SET a = a + 10",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 40,
                        },
                      },
                      "location": 42,
                      "name": [
                        {
                          "String": {
                            "sval": "+",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 10,
                          },
                          "location": 44,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1000 1`] = `
[
  " -- should fail

CREATE OR REPLACE VIEW rw_view2 AS SELECT * FROM rw_view1 WHERE a < 10
  WITH LOCAL CHECK OPTION",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 66,
                      "relname": "rw_view1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 59,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 59,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 81,
                      },
                    },
                    "location": 83,
                    "name": [
                      {
                        "String": {
                          "sval": "<",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {
                          "ival": 10,
                        },
                        "location": 85,
                      },
                    },
                  },
                },
              },
            },
            "replace": true,
            "view": {
              "inh": true,
              "location": 40,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "withCheckOption": "LOCAL_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1011 1`] = `
[
  "ALTER VIEW rw_view1 SET (check_option=here)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "List": {
                      "items": [
                        {
                          "DefElem": {
                            "arg": {
                              "TypeName": {
                                "location": 38,
                                "names": [
                                  {
                                    "String": {
                                      "sval": "here",
                                    },
                                  },
                                ],
                                "typemod": -1,
                              },
                            },
                            "defaction": "DEFELEM_UNSPEC",
                            "defname": "check_option",
                            "location": 25,
                          },
                        },
                      ],
                    },
                  },
                  "subtype": "AT_SetRelOptions",
                },
              },
            ],
            "objtype": "OBJECT_VIEW",
            "relation": {
              "inh": true,
              "location": 11,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1011 2`] = `
[
  " -- invalid
ALTER VIEW rw_view1 SET (check_option=local)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "List": {
                      "items": [
                        {
                          "DefElem": {
                            "arg": {
                              "TypeName": {
                                "location": 50,
                                "names": [
                                  {
                                    "String": {
                                      "sval": "local",
                                    },
                                  },
                                ],
                                "typemod": -1,
                              },
                            },
                            "defaction": "DEFELEM_UNSPEC",
                            "defname": "check_option",
                            "location": 37,
                          },
                        },
                      ],
                    },
                  },
                  "subtype": "AT_SetRelOptions",
                },
              },
            ],
            "objtype": "OBJECT_VIEW",
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1015 1`] = `
[
  " -- should fail

ALTER VIEW rw_view2 RESET (check_option)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "List": {
                      "items": [
                        {
                          "DefElem": {
                            "defaction": "DEFELEM_UNSPEC",
                            "defname": "check_option",
                            "location": 44,
                          },
                        },
                      ],
                    },
                  },
                  "subtype": "AT_ResetRelOptions",
                },
              },
            ],
            "objtype": "OBJECT_VIEW",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1029 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT * FROM base_tbl WITH CHECK OPTION",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 38,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "CASCADED_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1049 1`] = `
[
  "INSERT INTO rw_view1 VALUES (1, ARRAY[1,2,3])",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 29,
                          },
                        },
                        {
                          "A_ArrayExpr": {
                            "elements": [
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 38,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 2,
                                  },
                                  "location": 40,
                                },
                              },
                              {
                                "A_Const": {
                                  "ival": {
                                    "ival": 3,
                                  },
                                  "location": 42,
                                },
                              },
                            ],
                            "location": 32,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1050 1`] = `
[
  " -- should fail

UPDATE rw_view1 SET b[2] = -b[2] WHERE a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "indirection": [
                    {
                      "A_Indices": {
                        "uidx": {
                          "A_Const": {
                            "ival": {
                              "ival": 2,
                            },
                            "location": 39,
                          },
                        },
                      },
                    },
                  ],
                  "location": 37,
                  "name": "b",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "location": 44,
                      "name": [
                        {
                          "String": {
                            "sval": "-",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Indirection": {
                          "arg": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "b",
                                  },
                                },
                              ],
                              "location": 45,
                            },
                          },
                          "indirection": [
                            {
                              "A_Indices": {
                                "uidx": {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 2,
                                    },
                                    "location": 47,
                                  },
                                },
                              },
                            },
                          ],
                        },
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 56,
                  },
                },
                "location": 58,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 60,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1053 1`] = `
[
  " -- should fail

PREPARE ins(int, int[]) AS INSERT INTO rw_view1 VALUES($1, $2)",
  {
    "stmts": [
      {
        "stmt": {
          "PrepareStmt": {
            "argtypes": [
              {
                "TypeName": {
                  "location": 29,
                  "names": [
                    {
                      "String": {
                        "sval": "pg_catalog",
                      },
                    },
                    {
                      "String": {
                        "sval": "int4",
                      },
                    },
                  ],
                  "typemod": -1,
                },
              },
              {
                "TypeName": {
                  "arrayBounds": [
                    {
                      "Integer": {},
                    },
                  ],
                  "location": 34,
                  "names": [
                    {
                      "String": {
                        "sval": "pg_catalog",
                      },
                    },
                    {
                      "String": {
                        "sval": "int4",
                      },
                    },
                  ],
                  "typemod": -1,
                },
              },
            ],
            "name": "ins",
            "query": {
              "InsertStmt": {
                "override": "OVERRIDING_NOT_SET",
                "relation": {
                  "inh": true,
                  "location": 56,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
                "selectStmt": {
                  "SelectStmt": {
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "valuesLists": [
                      {
                        "List": {
                          "items": [
                            {
                              "ParamRef": {
                                "location": 72,
                                "number": 1,
                              },
                            },
                            {
                              "ParamRef": {
                                "location": 76,
                                "number": 2,
                              },
                            },
                          ],
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1056 1`] = `
[
  " -- ok
EXECUTE ins(10, ARRAY[4,5])",
  {
    "stmts": [
      {
        "stmt": {
          "ExecuteStmt": {
            "name": "ins",
            "params": [
              {
                "A_Const": {
                  "ival": {
                    "ival": 10,
                  },
                  "location": 19,
                },
              },
              {
                "A_ArrayExpr": {
                  "elements": [
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 4,
                        },
                        "location": 29,
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 5,
                        },
                        "location": 31,
                      },
                    },
                  ],
                  "location": 23,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1057 1`] = `
[
  " -- should fail
DEALLOCATE PREPARE ins",
  {
    "stmts": [
      {
        "stmt": {
          "DeallocateStmt": {
            "name": "ins",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1068 1`] = `
[
  "CREATE VIEW rw_view1 AS
  SELECT * FROM base_tbl b
  WHERE EXISTS(SELECT 1 FROM ref_tbl r WHERE r.a = b.a)
  WITH CHECK OPTION",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "alias": {
                        "aliasname": "b",
                      },
                      "inh": true,
                      "location": 40,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 33,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 33,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "SubLink": {
                    "location": 59,
                    "subLinkType": "EXISTS_SUBLINK",
                    "subselect": {
                      "SelectStmt": {
                        "fromClause": [
                          {
                            "RangeVar": {
                              "alias": {
                                "aliasname": "r",
                              },
                              "inh": true,
                              "location": 80,
                              "relname": "ref_tbl",
                              "relpersistence": "p",
                            },
                          },
                        ],
                        "limitOption": "LIMIT_OPTION_DEFAULT",
                        "op": "SETOP_NONE",
                        "targetList": [
                          {
                            "ResTarget": {
                              "location": 73,
                              "val": {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 73,
                                },
                              },
                            },
                          },
                        ],
                        "whereClause": {
                          "A_Expr": {
                            "kind": "AEXPR_OP",
                            "lexpr": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "r",
                                    },
                                  },
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 96,
                              },
                            },
                            "location": 100,
                            "name": [
                              {
                                "String": {
                                  "sval": "=",
                                },
                              },
                            ],
                            "rexpr": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "b",
                                    },
                                  },
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 102,
                              },
                            },
                          },
                        },
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "CASCADED_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1074 1`] = `
[
  " -- should fail

UPDATE rw_view1 SET a = a + 5",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 37,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 41,
                        },
                      },
                      "location": 43,
                      "name": [
                        {
                          "String": {
                            "sval": "+",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 5,
                          },
                          "location": 45,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1077 1`] = `
[
  " -- should fail

EXPLAIN (costs off) INSERT INTO rw_view1 VALUES (5)",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 26,
                },
              },
            ],
            "query": {
              "InsertStmt": {
                "override": "OVERRIDING_NOT_SET",
                "relation": {
                  "inh": true,
                  "location": 49,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
                "selectStmt": {
                  "SelectStmt": {
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "valuesLists": [
                      {
                        "List": {
                          "items": [
                            {
                              "A_Const": {
                                "ival": {
                                  "ival": 5,
                                },
                                "location": 66,
                              },
                            },
                          ],
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1082 1`] = `
[
  "DROP TABLE base_tbl, ref_tbl CASCADE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "base_tbl",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "ref_tbl",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1088 1`] = `
[
  "CREATE FUNCTION base_tbl_trig_fn()
RETURNS trigger AS
$$
BEGIN
  NEW.b := 10;
  RETURN NEW;
END;
$$
LANGUAGE plpgsql",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "base_tbl_trig_fn",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
BEGIN
  NEW.b := 10;
  RETURN NEW;
END;
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 51,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 100,
                },
              },
            ],
            "returnType": {
              "location": 43,
              "names": [
                {
                  "String": {
                    "sval": "trigger",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1098 1`] = `
[
  "CREATE TRIGGER base_tbl_trig BEFORE INSERT OR UPDATE ON base_tbl
  FOR EACH ROW EXECUTE PROCEDURE base_tbl_trig_fn()",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTrigStmt": {
            "events": 20,
            "funcname": [
              {
                "String": {
                  "sval": "base_tbl_trig_fn",
                },
              },
            ],
            "relation": {
              "inh": true,
              "location": 56,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "row": true,
            "timing": 2,
            "trigname": "base_tbl_trig",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1101 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT * FROM base_tbl WHERE a < b WITH CHECK OPTION",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 38,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 53,
                      },
                    },
                    "location": 55,
                    "name": [
                      {
                        "String": {
                          "sval": "<",
                        },
                      },
                    ],
                    "rexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                        ],
                        "location": 57,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "CASCADED_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1104 1`] = `
[
  " -- should fail
UPDATE rw_view1 SET a = 20, b = 30",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "a",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 20,
                      },
                      "location": 40,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 44,
                  "name": "b",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 30,
                      },
                      "location": 48,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1114 1`] = `
[
  "CREATE VIEW rw_view1 AS SELECT a FROM base_tbl WHERE a < b",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 38,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 31,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 31,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 53,
                      },
                    },
                    "location": 55,
                    "name": [
                      {
                        "String": {
                          "sval": "<",
                        },
                      },
                    ],
                    "rexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                        ],
                        "location": 57,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1134 1`] = `
[
  "CREATE TRIGGER rw_view1_trig
  INSTEAD OF INSERT OR UPDATE OR DELETE ON rw_view1
  FOR EACH ROW EXECUTE PROCEDURE rw_view1_trig_fn()",
  {
    "stmts": [
      {
        "stmt": {
          "CreateTrigStmt": {
            "events": 28,
            "funcname": [
              {
                "String": {
                  "sval": "rw_view1_trig_fn",
                },
              },
            ],
            "relation": {
              "inh": true,
              "location": 72,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "row": true,
            "timing": 64,
            "trigname": "rw_view1_trig",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1138 1`] = `
[
  "CREATE VIEW rw_view2 AS
  SELECT * FROM rw_view1 WHERE a > 0 WITH LOCAL CHECK OPTION",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 40,
                      "relname": "rw_view1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 33,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 33,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 55,
                      },
                    },
                    "location": 57,
                    "name": [
                      {
                        "String": {
                          "sval": ">",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {},
                        "location": 59,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "withCheckOption": "LOCAL_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1150 1`] = `
[
  " -- ok, but not in view (doesn't fail rw_view1's check)
UPDATE rw_view2 SET a = 200 WHERE a = 5",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 63,
              "relname": "rw_view2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 76,
                  "name": "a",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 200,
                      },
                      "location": 80,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 90,
                  },
                },
                "location": 92,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 5,
                    },
                    "location": 94,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1172 1`] = `
[
  "CREATE TABLE base_tbl (a int)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 25,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1188 1`] = `
[
  "CREATE VIEW rw_view1 AS
  SELECT person FROM base_tbl WHERE visibility = 'public'",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 45,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 33,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "person",
                              },
                            },
                          ],
                          "location": 33,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "visibility",
                            },
                          },
                        ],
                        "location": 60,
                      },
                    },
                    "location": 71,
                    "name": [
                      {
                        "String": {
                          "sval": "=",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "location": 73,
                        "sval": {
                          "sval": "public",
                        },
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1191 1`] = `
[
  "CREATE FUNCTION snoop(anyelement)
RETURNS boolean AS
$$
BEGIN
  RAISE NOTICE 'snooped value: %', $1;
  RETURN true;
END;
$$
LANGUAGE plpgsql COST 0.000001",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "snoop",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
BEGIN
  RAISE NOTICE 'snooped value: %', $1;
  RETURN true;
END;
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 50,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 124,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "Float": {
                      "fval": "0.000001",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "cost",
                  "location": 141,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 22,
                    "names": [
                      {
                        "String": {
                          "sval": "anyelement",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                },
              },
            ],
            "returnType": {
              "location": 42,
              "names": [
                {
                  "String": {
                    "sval": "pg_catalog",
                  },
                },
                {
                  "String": {
                    "sval": "bool",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1201 1`] = `
[
  "CREATE OR REPLACE FUNCTION leakproof(anyelement)
RETURNS boolean AS
$$
BEGIN
  RETURN true;
END;
$$
LANGUAGE plpgsql STRICT IMMUTABLE LEAKPROOF",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "leakproof",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
BEGIN
  RETURN true;
END;
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 65,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 100,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "Boolean": {
                      "boolval": true,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "strict",
                  "location": 117,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "immutable",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "volatility",
                  "location": 124,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "Boolean": {
                      "boolval": true,
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "leakproof",
                  "location": 134,
                },
              },
            ],
            "parameters": [
              {
                "FunctionParameter": {
                  "argType": {
                    "location": 37,
                    "names": [
                      {
                        "String": {
                          "sval": "anyelement",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                  "mode": "FUNC_PARAM_DEFAULT",
                },
              },
            ],
            "replace": true,
            "returnType": {
              "location": 57,
              "names": [
                {
                  "String": {
                    "sval": "pg_catalog",
                  },
                },
                {
                  "String": {
                    "sval": "bool",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1210 1`] = `
[
  "SELECT * FROM rw_view1 WHERE snoop(person)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "FuncCall": {
                "args": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "person",
                          },
                        },
                      ],
                      "location": 35,
                    },
                  },
                ],
                "funcformat": "COERCE_EXPLICIT_CALL",
                "funcname": [
                  {
                    "String": {
                      "sval": "snoop",
                    },
                  },
                ],
                "location": 29,
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1214 1`] = `
[
  "ALTER VIEW rw_view1 SET (security_barrier = true)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "List": {
                      "items": [
                        {
                          "DefElem": {
                            "arg": {
                              "String": {
                                "sval": "true",
                              },
                            },
                            "defaction": "DEFELEM_UNSPEC",
                            "defname": "security_barrier",
                            "location": 25,
                          },
                        },
                      ],
                    },
                  },
                  "subtype": "AT_SetRelOptions",
                },
              },
            ],
            "objtype": "OBJECT_VIEW",
            "relation": {
              "inh": true,
              "location": 11,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1233 1`] = `
[
  "EXPLAIN (costs off) SELECT * FROM rw_view1 WHERE snoop(person)",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 34,
                      "relname": "rw_view1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "FuncCall": {
                    "args": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "person",
                              },
                            },
                          ],
                          "location": 55,
                        },
                      },
                    ],
                    "funcformat": "COERCE_EXPLICIT_CALL",
                    "funcname": [
                      {
                        "String": {
                          "sval": "snoop",
                        },
                      },
                    ],
                    "location": 49,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1255 1`] = `
[
  "SELECT * FROM rw_view2 WHERE snoop(person)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "rw_view2",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "FuncCall": {
                "args": [
                  {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "person",
                          },
                        },
                      ],
                      "location": 35,
                    },
                  },
                ],
                "funcformat": "COERCE_EXPLICIT_CALL",
                "funcname": [
                  {
                    "String": {
                      "sval": "snoop",
                    },
                  },
                ],
                "location": 29,
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1259 1`] = `
[
  "EXPLAIN (costs off) SELECT * FROM rw_view2 WHERE snoop(person)",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 34,
                      "relname": "rw_view2",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 27,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 27,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "FuncCall": {
                    "args": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "person",
                              },
                            },
                          ],
                          "location": 55,
                        },
                      },
                    ],
                    "funcformat": "COERCE_EXPLICIT_CALL",
                    "funcname": [
                      {
                        "String": {
                          "sval": "snoop",
                        },
                      },
                    ],
                    "location": 49,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1270 1`] = `
[
  "CREATE RULE base_tbl_ins_rule AS ON INSERT TO base_tbl
  WHERE EXISTS (SELECT 1 FROM base_tbl t WHERE t.id = new.id)
  DO INSTEAD
    UPDATE base_tbl SET data = new.data, deleted = false WHERE id = new.id",
  {
    "stmts": [
      {
        "stmt": {
          "RuleStmt": {
            "actions": [
              {
                "UpdateStmt": {
                  "relation": {
                    "inh": true,
                    "location": 141,
                    "relname": "base_tbl",
                    "relpersistence": "p",
                  },
                  "targetList": [
                    {
                      "ResTarget": {
                        "location": 154,
                        "name": "data",
                        "val": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "new",
                                },
                              },
                              {
                                "String": {
                                  "sval": "data",
                                },
                              },
                            ],
                            "location": 161,
                          },
                        },
                      },
                    },
                    {
                      "ResTarget": {
                        "location": 171,
                        "name": "deleted",
                        "val": {
                          "A_Const": {
                            "boolval": {},
                            "location": 181,
                          },
                        },
                      },
                    },
                  ],
                  "whereClause": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "id",
                              },
                            },
                          ],
                          "location": 193,
                        },
                      },
                      "location": 196,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "new",
                              },
                            },
                            {
                              "String": {
                                "sval": "id",
                              },
                            },
                          ],
                          "location": 198,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "event": "CMD_INSERT",
            "instead": true,
            "relation": {
              "inh": true,
              "location": 46,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "rulename": "base_tbl_ins_rule",
            "whereClause": {
              "SubLink": {
                "location": 63,
                "subLinkType": "EXISTS_SUBLINK",
                "subselect": {
                  "SelectStmt": {
                    "fromClause": [
                      {
                        "RangeVar": {
                          "alias": {
                            "aliasname": "t",
                          },
                          "inh": true,
                          "location": 85,
                          "relname": "base_tbl",
                          "relpersistence": "p",
                        },
                      },
                    ],
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "targetList": [
                      {
                        "ResTarget": {
                          "location": 78,
                          "val": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 78,
                            },
                          },
                        },
                      },
                    ],
                    "whereClause": {
                      "A_Expr": {
                        "kind": "AEXPR_OP",
                        "lexpr": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "t",
                                },
                              },
                              {
                                "String": {
                                  "sval": "id",
                                },
                              },
                            ],
                            "location": 102,
                          },
                        },
                        "location": 107,
                        "name": [
                          {
                            "String": {
                              "sval": "=",
                            },
                          },
                        ],
                        "rexpr": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "new",
                                },
                              },
                              {
                                "String": {
                                  "sval": "id",
                                },
                              },
                            ],
                            "location": 109,
                          },
                        },
                      },
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1275 1`] = `
[
  "CREATE RULE base_tbl_del_rule AS ON DELETE TO base_tbl
  DO INSTEAD
    UPDATE base_tbl SET deleted = true WHERE id = old.id",
  {
    "stmts": [
      {
        "stmt": {
          "RuleStmt": {
            "actions": [
              {
                "UpdateStmt": {
                  "relation": {
                    "inh": true,
                    "location": 79,
                    "relname": "base_tbl",
                    "relpersistence": "p",
                  },
                  "targetList": [
                    {
                      "ResTarget": {
                        "location": 92,
                        "name": "deleted",
                        "val": {
                          "A_Const": {
                            "boolval": {
                              "boolval": true,
                            },
                            "location": 102,
                          },
                        },
                      },
                    },
                  ],
                  "whereClause": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "id",
                              },
                            },
                          ],
                          "location": 113,
                        },
                      },
                      "location": 116,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "old",
                              },
                            },
                            {
                              "String": {
                                "sval": "id",
                              },
                            },
                          ],
                          "location": 118,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "event": "CMD_DELETE",
            "instead": true,
            "relation": {
              "inh": true,
              "location": 46,
              "relname": "base_tbl",
              "relpersistence": "p",
            },
            "rulename": "base_tbl_del_rule",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1279 1`] = `
[
  "CREATE VIEW rw_view1 WITH (security_barrier=true) AS
  SELECT id, data FROM base_tbl WHERE NOT deleted",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "true",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "security_barrier",
                  "location": 27,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 76,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 62,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "id",
                              },
                            },
                          ],
                          "location": 62,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 66,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "data",
                              },
                            },
                          ],
                          "location": 66,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "BoolExpr": {
                    "args": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "deleted",
                              },
                            },
                          ],
                          "location": 95,
                        },
                      },
                    ],
                    "boolop": "NOT_EXPR",
                    "location": 91,
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1284 1`] = `
[
  "EXPLAIN (costs off) DELETE FROM rw_view1 WHERE id = 1 AND snoop(data)",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "DeleteStmt": {
                "relation": {
                  "inh": true,
                  "location": 32,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
                "whereClause": {
                  "BoolExpr": {
                    "args": [
                      {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "id",
                                  },
                                },
                              ],
                              "location": 47,
                            },
                          },
                          "location": 50,
                          "name": [
                            {
                              "String": {
                                "sval": "=",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 52,
                            },
                          },
                        },
                      },
                      {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "data",
                                    },
                                  },
                                ],
                                "location": 64,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "snoop",
                              },
                            },
                          ],
                          "location": 58,
                        },
                      },
                    ],
                    "boolop": "AND_EXPR",
                    "location": 54,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1295 1`] = `
[
  "CREATE TABLE t1 (a int, b float, c text)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "t1",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 17,
                  "typeName": {
                    "location": 19,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 26,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "float8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "c",
                  "is_local": true,
                  "location": 33,
                  "typeName": {
                    "location": 35,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1298 1`] = `
[
  "SELECT i,i,'t1' FROM generate_series(1,10) g(i)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "g",
                    "colnames": [
                      {
                        "String": {
                          "sval": "i",
                        },
                      },
                    ],
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 37,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 10,
                                    },
                                    "location": 39,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 21,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "i",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "i",
                          },
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 11,
                  "val": {
                    "A_Const": {
                      "location": 11,
                      "sval": {
                        "sval": "t1",
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1301 1`] = `
[
  "CREATE TABLE t11 (d text) INHERITS (t1)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "inhRelations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 36,
                  "relname": "t1",
                  "relpersistence": "p",
                },
              },
            ],
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "t11",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "d",
                  "is_local": true,
                  "location": 18,
                  "typeName": {
                    "location": 20,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1307 1`] = `
[
  "CREATE TABLE t12 (e int[]) INHERITS (t1)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "inhRelations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 37,
                  "relname": "t1",
                  "relpersistence": "p",
                },
              },
            ],
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "t12",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "e",
                  "is_local": true,
                  "location": 18,
                  "typeName": {
                    "arrayBounds": [
                      {
                        "Integer": {},
                      },
                    ],
                    "location": 20,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1313 1`] = `
[
  "CREATE TABLE t111 () INHERITS (t11, t12)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "inhRelations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 31,
                  "relname": "t11",
                  "relpersistence": "p",
                },
              },
              {
                "RangeVar": {
                  "inh": true,
                  "location": 36,
                  "relname": "t12",
                  "relpersistence": "p",
                },
              },
            ],
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "t111",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1319 1`] = `
[
  "CREATE VIEW v1 WITH (security_barrier=true) AS
SELECT *, (SELECT d FROM t11 WHERE t11.a = t1.a LIMIT 1) AS d
FROM t1
WHERE a > 5 AND EXISTS(SELECT 1 FROM t12 WHERE t12.a = t1.a)",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "true",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "security_barrier",
                  "location": 21,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 114,
                      "relname": "t1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 54,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 54,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 57,
                      "name": "d",
                      "val": {
                        "SubLink": {
                          "location": 57,
                          "subLinkType": "EXPR_SUBLINK",
                          "subselect": {
                            "SelectStmt": {
                              "fromClause": [
                                {
                                  "RangeVar": {
                                    "inh": true,
                                    "location": 72,
                                    "relname": "t11",
                                    "relpersistence": "p",
                                  },
                                },
                              ],
                              "limitCount": {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 101,
                                },
                              },
                              "limitOption": "LIMIT_OPTION_COUNT",
                              "op": "SETOP_NONE",
                              "targetList": [
                                {
                                  "ResTarget": {
                                    "location": 65,
                                    "val": {
                                      "ColumnRef": {
                                        "fields": [
                                          {
                                            "String": {
                                              "sval": "d",
                                            },
                                          },
                                        ],
                                        "location": 65,
                                      },
                                    },
                                  },
                                },
                              ],
                              "whereClause": {
                                "A_Expr": {
                                  "kind": "AEXPR_OP",
                                  "lexpr": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "t11",
                                          },
                                        },
                                        {
                                          "String": {
                                            "sval": "a",
                                          },
                                        },
                                      ],
                                      "location": 82,
                                    },
                                  },
                                  "location": 88,
                                  "name": [
                                    {
                                      "String": {
                                        "sval": "=",
                                      },
                                    },
                                  ],
                                  "rexpr": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "t1",
                                          },
                                        },
                                        {
                                          "String": {
                                            "sval": "a",
                                          },
                                        },
                                      ],
                                      "location": 90,
                                    },
                                  },
                                },
                              },
                            },
                          },
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "BoolExpr": {
                    "args": [
                      {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "location": 123,
                            },
                          },
                          "location": 125,
                          "name": [
                            {
                              "String": {
                                "sval": ">",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 5,
                              },
                              "location": 127,
                            },
                          },
                        },
                      },
                      {
                        "SubLink": {
                          "location": 133,
                          "subLinkType": "EXISTS_SUBLINK",
                          "subselect": {
                            "SelectStmt": {
                              "fromClause": [
                                {
                                  "RangeVar": {
                                    "inh": true,
                                    "location": 154,
                                    "relname": "t12",
                                    "relpersistence": "p",
                                  },
                                },
                              ],
                              "limitOption": "LIMIT_OPTION_DEFAULT",
                              "op": "SETOP_NONE",
                              "targetList": [
                                {
                                  "ResTarget": {
                                    "location": 147,
                                    "val": {
                                      "A_Const": {
                                        "ival": {
                                          "ival": 1,
                                        },
                                        "location": 147,
                                      },
                                    },
                                  },
                                },
                              ],
                              "whereClause": {
                                "A_Expr": {
                                  "kind": "AEXPR_OP",
                                  "lexpr": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "t12",
                                          },
                                        },
                                        {
                                          "String": {
                                            "sval": "a",
                                          },
                                        },
                                      ],
                                      "location": 164,
                                    },
                                  },
                                  "location": 170,
                                  "name": [
                                    {
                                      "String": {
                                        "sval": "=",
                                      },
                                    },
                                  ],
                                  "rexpr": {
                                    "ColumnRef": {
                                      "fields": [
                                        {
                                          "String": {
                                            "sval": "t1",
                                          },
                                        },
                                        {
                                          "String": {
                                            "sval": "a",
                                          },
                                        },
                                      ],
                                      "location": 172,
                                    },
                                  },
                                },
                              },
                            },
                          },
                        },
                      },
                    ],
                    "boolop": "AND_EXPR",
                    "location": 129,
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "v1",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1324 1`] = `
[
  "SELECT * FROM v1 WHERE a=3",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "v1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 23,
                  },
                },
                "location": 24,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 25,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1327 1`] = `
[
  "EXPLAIN (VERBOSE, COSTS OFF)
UPDATE v1 SET a=100 WHERE snoop(a) AND leakproof(a) AND a < 7 AND a != 6",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "verbose",
                  "location": 9,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 18,
                },
              },
            ],
            "query": {
              "UpdateStmt": {
                "relation": {
                  "inh": true,
                  "location": 36,
                  "relname": "v1",
                  "relpersistence": "p",
                },
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 43,
                      "name": "a",
                      "val": {
                        "A_Const": {
                          "ival": {
                            "ival": 100,
                          },
                          "location": 45,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "BoolExpr": {
                    "args": [
                      {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 61,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "snoop",
                              },
                            },
                          ],
                          "location": 55,
                        },
                      },
                      {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 78,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "leakproof",
                              },
                            },
                          ],
                          "location": 68,
                        },
                      },
                      {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "location": 85,
                            },
                          },
                          "location": 87,
                          "name": [
                            {
                              "String": {
                                "sval": "<",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 7,
                              },
                              "location": 89,
                            },
                          },
                        },
                      },
                      {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "location": 95,
                            },
                          },
                          "location": 97,
                          "name": [
                            {
                              "String": {
                                "sval": "<>",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 6,
                              },
                              "location": 100,
                            },
                          },
                        },
                      },
                    ],
                    "boolop": "AND_EXPR",
                    "location": 64,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1331 1`] = `
[
  " -- Nothing should have been changed to 100
SELECT * FROM t1 WHERE a=100",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 58,
                  "relname": "t1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 51,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 51,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 67,
                  },
                },
                "location": 68,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 100,
                    },
                    "location": 69,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1332 1`] = `
[
  " -- Nothing should have been changed to 100

EXPLAIN (VERBOSE, COSTS OFF)
UPDATE v1 SET a=a+1 WHERE snoop(a) AND leakproof(a) AND a = 8",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "verbose",
                  "location": 54,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 63,
                },
              },
            ],
            "query": {
              "UpdateStmt": {
                "relation": {
                  "inh": true,
                  "location": 81,
                  "relname": "v1",
                  "relpersistence": "p",
                },
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 88,
                      "name": "a",
                      "val": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "location": 90,
                            },
                          },
                          "location": 91,
                          "name": [
                            {
                              "String": {
                                "sval": "+",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 92,
                            },
                          },
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "BoolExpr": {
                    "args": [
                      {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 106,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "snoop",
                              },
                            },
                          ],
                          "location": 100,
                        },
                      },
                      {
                        "FuncCall": {
                          "args": [
                            {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "a",
                                    },
                                  },
                                ],
                                "location": 123,
                              },
                            },
                          ],
                          "funcformat": "COERCE_EXPLICIT_CALL",
                          "funcname": [
                            {
                              "String": {
                                "sval": "leakproof",
                              },
                            },
                          ],
                          "location": 113,
                        },
                      },
                      {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "location": 130,
                            },
                          },
                          "location": 132,
                          "name": [
                            {
                              "String": {
                                "sval": "=",
                              },
                            },
                          ],
                          "rexpr": {
                            "A_Const": {
                              "ival": {
                                "ival": 8,
                              },
                              "location": 134,
                            },
                          },
                        },
                      },
                    ],
                    "boolop": "AND_EXPR",
                    "location": 109,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1338 1`] = `
[
  "SELECT * FROM v1 WHERE b=8",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "v1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "b",
                        },
                      },
                    ],
                    "location": 23,
                  },
                },
                "location": 24,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 8,
                    },
                    "location": 25,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1340 1`] = `
[
  "DELETE FROM v1 WHERE snoop(a) AND leakproof(a)",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "v1",
              "relpersistence": "p",
            },
            "whereClause": {
              "BoolExpr": {
                "args": [
                  {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 27,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "snoop",
                          },
                        },
                      ],
                      "location": 21,
                    },
                  },
                  {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "a",
                                },
                              },
                            ],
                            "location": 44,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "leakproof",
                          },
                        },
                      ],
                      "location": 34,
                    },
                  },
                ],
                "boolop": "AND_EXPR",
                "location": 30,
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1340 2`] = `
[
  " -- should not delete everything, just where a>5

TABLE t1",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 56,
                  "relname": "t1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": -1,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": -1,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1342 1`] = `
[
  " -- verify all a<=5 are intact

DROP TABLE t1, t11, t12, t111 CASCADE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "t1",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "t11",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "t12",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "t111",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1348 1`] = `
[
  "CREATE TABLE tx1 (a integer)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "tx1",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 18,
                  "typeName": {
                    "location": 20,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1356 1`] = `
[
  "DROP VIEW vx1",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "vx1",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1375 1`] = `
[
  "CREATE TABLE tx1 (a integer, b integer)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "tx1",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 18,
                  "typeName": {
                    "location": 20,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 29,
                  "typeName": {
                    "location": 31,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1396 1`] = `
[
  "CREATE TABLE t1 (a int, b text, c int)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "t1",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 17,
                  "typeName": {
                    "location": 19,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 26,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "c",
                  "is_local": true,
                  "location": 32,
                  "typeName": {
                    "location": 34,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1399 1`] = `
[
  "CREATE TABLE t2 (cc int)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "t2",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "cc",
                  "is_local": true,
                  "location": 17,
                  "typeName": {
                    "location": 20,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1402 1`] = `
[
  "CREATE VIEW v1 WITH (security_barrier = true) AS
  SELECT * FROM t1 WHERE (a > 0)
  WITH CHECK OPTION",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "true",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "security_barrier",
                  "location": 21,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 65,
                      "relname": "t1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 58,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 58,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 75,
                      },
                    },
                    "location": 77,
                    "name": [
                      {
                        "String": {
                          "sval": ">",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {},
                        "location": 79,
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "v1",
              "relpersistence": "p",
            },
            "withCheckOption": "CASCADED_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1406 1`] = `
[
  "CREATE VIEW v2 WITH (security_barrier = true) AS
  SELECT * FROM v1 WHERE EXISTS (SELECT 1 FROM t2 WHERE t2.cc = v1.c)
  WITH CHECK OPTION",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "true",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "security_barrier",
                  "location": 21,
                },
              },
            ],
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 65,
                      "relname": "v1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 58,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 58,
                        },
                      },
                    },
                  },
                ],
                "whereClause": {
                  "SubLink": {
                    "location": 74,
                    "subLinkType": "EXISTS_SUBLINK",
                    "subselect": {
                      "SelectStmt": {
                        "fromClause": [
                          {
                            "RangeVar": {
                              "inh": true,
                              "location": 96,
                              "relname": "t2",
                              "relpersistence": "p",
                            },
                          },
                        ],
                        "limitOption": "LIMIT_OPTION_DEFAULT",
                        "op": "SETOP_NONE",
                        "targetList": [
                          {
                            "ResTarget": {
                              "location": 89,
                              "val": {
                                "A_Const": {
                                  "ival": {
                                    "ival": 1,
                                  },
                                  "location": 89,
                                },
                              },
                            },
                          },
                        ],
                        "whereClause": {
                          "A_Expr": {
                            "kind": "AEXPR_OP",
                            "lexpr": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "t2",
                                    },
                                  },
                                  {
                                    "String": {
                                      "sval": "cc",
                                    },
                                  },
                                ],
                                "location": 105,
                              },
                            },
                            "location": 111,
                            "name": [
                              {
                                "String": {
                                  "sval": "=",
                                },
                              },
                            ],
                            "rexpr": {
                              "ColumnRef": {
                                "fields": [
                                  {
                                    "String": {
                                      "sval": "v1",
                                    },
                                  },
                                  {
                                    "String": {
                                      "sval": "c",
                                    },
                                  },
                                ],
                                "location": 113,
                              },
                            },
                          },
                        },
                      },
                    },
                  },
                },
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "v2",
              "relpersistence": "p",
            },
            "withCheckOption": "CASCADED_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1410 1`] = `
[
  "INSERT INTO v2 VALUES (2, 'two', 20)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "v2",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2,
                            },
                            "location": 23,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 26,
                            "sval": {
                              "sval": "two",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 20,
                            },
                            "location": 33,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1412 1`] = `
[
  " -- not allowed

UPDATE v2 SET b = 'ONE' WHERE a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "v2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 31,
                  "name": "b",
                  "val": {
                    "A_Const": {
                      "location": 35,
                      "sval": {
                        "sval": "ONE",
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 47,
                  },
                },
                "location": 49,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 51,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1414 1`] = `
[
  " -- ok
UPDATE v2 SET a = -1 WHERE a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 14,
              "relname": "v2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 21,
                  "name": "a",
                  "val": {
                    "A_Const": {
                      "ival": {},
                      "location": 25,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 34,
                  },
                },
                "location": 36,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 38,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1415 1`] = `
[
  " -- not allowed
UPDATE v2 SET c = 30 WHERE a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 23,
              "relname": "v2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 30,
                  "name": "c",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 30,
                      },
                      "location": 34,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 43,
                  },
                },
                "location": 45,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 47,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1416 1`] = `
[
  " -- not allowed

DELETE FROM v2 WHERE a = 2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 29,
              "relname": "v2",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 38,
                  },
                },
                "location": 40,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 42,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1418 1`] = `
[
  " -- ok
SELECT * FROM v2",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 21,
                  "relname": "v2",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 14,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 14,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1421 1`] = `
[
  "DROP VIEW v2",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "v2",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1429 1`] = `
[
  "CREATE TABLE t1 (a int)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "t1",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 17,
                  "typeName": {
                    "location": 19,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1433 1`] = `
[
  "  UPDATE t1 SET a = NEW.a WHERE a = OLD.a",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 9,
              "relname": "t1",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 16,
                  "name": "a",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "new",
                          },
                        },
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 20,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 32,
                  },
                },
                "location": 34,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "old",
                        },
                      },
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 36,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1435 1`] = `
[
  "  SELECT * FROM v1 WHERE EXISTS (SELECT 1)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 16,
                  "relname": "v1",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 9,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "SubLink": {
                "location": 25,
                "subLinkType": "EXISTS_SUBLINK",
                "subselect": {
                  "SelectStmt": {
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "targetList": [
                      {
                        "ResTarget": {
                          "location": 40,
                          "val": {
                            "A_Const": {
                              "ival": {
                                "ival": 1,
                              },
                              "location": 40,
                            },
                          },
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1437 1`] = `
[
  "EXPLAIN (COSTS OFF) UPDATE v2 SET a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "UpdateStmt": {
                "relation": {
                  "inh": true,
                  "location": 27,
                  "relname": "v2",
                  "relpersistence": "p",
                },
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 34,
                      "name": "a",
                      "val": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 38,
                        },
                      },
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1447 1`] = `
[
  "CREATE TABLE t1 (a int, b text)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "t1",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 17,
                  "typeName": {
                    "location": 19,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 26,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1451 1`] = `
[
  "INSERT INTO v1 VALUES (1, 'ok')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "v1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 23,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 26,
                            "sval": {
                              "sval": "ok",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1452 1`] = `
[
  " -- should fail

DROP VIEW v1",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "v1",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1458 1`] = `
[
  "create table uv_pt (a int, b int, v varchar) partition by range (a, b)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 45,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 65,
                    "name": "a",
                  },
                },
                {
                  "PartitionElem": {
                    "location": 68,
                    "name": "b",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_RANGE",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "uv_pt",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 20,
                  "typeName": {
                    "location": 22,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 27,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "v",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 36,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "varchar",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1468 1`] = `
[
  "create view uv_ptv as select * from uv_pt",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 36,
                      "relname": "uv_pt",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 29,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "A_Star": {},
                            },
                          ],
                          "location": 29,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 12,
              "relname": "uv_ptv",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1488 1`] = `
[
  "create table wcowrtest (a int) partition by list (a)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 31,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 50,
                    "name": "a",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_LIST",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "wcowrtest",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 26,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1493 1`] = `
[
  "alter table wcowrtest add b text",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "ColumnDef": {
                      "colname": "b",
                      "is_local": true,
                      "location": 26,
                      "typeName": {
                        "location": 28,
                        "names": [
                          {
                            "String": {
                              "sval": "text",
                            },
                          },
                        ],
                        "typemod": -1,
                      },
                    },
                  },
                  "subtype": "AT_AddColumn",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "wcowrtest",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1498 1`] = `
[
  "create table sometable (a int, b text)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "sometable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 26,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 31,
                  "typeName": {
                    "location": 33,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1508 1`] = `
[
  "insert into wcowrtest_v2 values (2, 'no such row in sometable')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "wcowrtest_v2",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2,
                            },
                            "location": 33,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 36,
                            "sval": {
                              "sval": "no such row in sometable",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1510 1`] = `
[
  "drop view wcowrtest_v, wcowrtest_v2",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "wcowrtest_v",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "wcowrtest_v2",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1515 1`] = `
[
  "create table uv_iocu_tab (a text unique, b float)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "uv_iocu_tab",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_UNIQUE",
                        "location": 33,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 26,
                  "typeName": {
                    "location": 28,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 41,
                  "typeName": {
                    "location": 43,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "float8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1518 1`] = `
[
  "   select b, b+1 as c, a, '2.0'::text as two from uv_iocu_tab",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 50,
                  "relname": "uv_iocu_tab",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 10,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 10,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 13,
                  "name": "c",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 13,
                        },
                      },
                      "location": 14,
                      "name": [
                        {
                          "String": {
                            "sval": "+",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 15,
                        },
                      },
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 23,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 23,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 26,
                  "name": "two",
                  "val": {
                    "TypeCast": {
                      "arg": {
                        "A_Const": {
                          "location": 26,
                          "sval": {
                            "sval": "2.0",
                          },
                        },
                      },
                      "location": 31,
                      "typeName": {
                        "location": 33,
                        "names": [
                          {
                            "String": {
                              "sval": "text",
                            },
                          },
                        ],
                        "typemod": -1,
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1520 1`] = `
[
  "insert into uv_iocu_view (a, b) values ('xyxyxy', 1)
   on conflict (a) do update set b = uv_iocu_view.b",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 26,
                  "name": "a",
                },
              },
              {
                "ResTarget": {
                  "location": 29,
                  "name": "b",
                },
              },
            ],
            "onConflictClause": {
              "action": "ONCONFLICT_UPDATE",
              "infer": {
                "indexElems": [
                  {
                    "IndexElem": {
                      "name": "a",
                      "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                      "ordering": "SORTBY_DEFAULT",
                    },
                  },
                ],
                "location": 68,
              },
              "location": 56,
              "targetList": [
                {
                  "ResTarget": {
                    "location": 86,
                    "name": "b",
                    "val": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "uv_iocu_view",
                            },
                          },
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                        ],
                        "location": 90,
                      },
                    },
                  },
                },
              ],
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "uv_iocu_view",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "location": 40,
                            "sval": {
                              "sval": "xyxyxy",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 50,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1529 1`] = `
[
  "insert into uv_iocu_view (a, b) values ('xyxyxy', 3)
   on conflict (a) do update set b = cast(excluded.two as float)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 26,
                  "name": "a",
                },
              },
              {
                "ResTarget": {
                  "location": 29,
                  "name": "b",
                },
              },
            ],
            "onConflictClause": {
              "action": "ONCONFLICT_UPDATE",
              "infer": {
                "indexElems": [
                  {
                    "IndexElem": {
                      "name": "a",
                      "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                      "ordering": "SORTBY_DEFAULT",
                    },
                  },
                ],
                "location": 68,
              },
              "location": 56,
              "targetList": [
                {
                  "ResTarget": {
                    "location": 86,
                    "name": "b",
                    "val": {
                      "TypeCast": {
                        "arg": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "excluded",
                                },
                              },
                              {
                                "String": {
                                  "sval": "two",
                                },
                              },
                            ],
                            "location": 95,
                          },
                        },
                        "location": 90,
                        "typeName": {
                          "location": 111,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "float8",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  },
                },
              ],
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "uv_iocu_view",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "location": 40,
                            "sval": {
                              "sval": "xyxyxy",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 50,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1533 1`] = `
[
  "explain (costs off)
insert into uv_iocu_view (a, b) values ('xyxyxy', 3)
   on conflict (a) do update set b = excluded.b where excluded.c > 0",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "InsertStmt": {
                "cols": [
                  {
                    "ResTarget": {
                      "location": 46,
                      "name": "a",
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 49,
                      "name": "b",
                    },
                  },
                ],
                "onConflictClause": {
                  "action": "ONCONFLICT_UPDATE",
                  "infer": {
                    "indexElems": [
                      {
                        "IndexElem": {
                          "name": "a",
                          "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                          "ordering": "SORTBY_DEFAULT",
                        },
                      },
                    ],
                    "location": 88,
                  },
                  "location": 76,
                  "targetList": [
                    {
                      "ResTarget": {
                        "location": 106,
                        "name": "b",
                        "val": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "excluded",
                                },
                              },
                              {
                                "String": {
                                  "sval": "b",
                                },
                              },
                            ],
                            "location": 110,
                          },
                        },
                      },
                    },
                  ],
                  "whereClause": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "excluded",
                              },
                            },
                            {
                              "String": {
                                "sval": "c",
                              },
                            },
                          ],
                          "location": 127,
                        },
                      },
                      "location": 138,
                      "name": [
                        {
                          "String": {
                            "sval": ">",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {},
                          "location": 140,
                        },
                      },
                    },
                  },
                },
                "override": "OVERRIDING_NOT_SET",
                "relation": {
                  "inh": true,
                  "location": 32,
                  "relname": "uv_iocu_view",
                  "relpersistence": "p",
                },
                "selectStmt": {
                  "SelectStmt": {
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "valuesLists": [
                      {
                        "List": {
                          "items": [
                            {
                              "A_Const": {
                                "location": 60,
                                "sval": {
                                  "sval": "xyxyxy",
                                },
                              },
                            },
                            {
                              "A_Const": {
                                "ival": {
                                  "ival": 3,
                                },
                                "location": 70,
                              },
                            },
                          ],
                        },
                      },
                    ],
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1537 1`] = `
[
  "insert into uv_iocu_view (a, b) values ('xyxyxy', 3)
   on conflict (a) do update set b = excluded.b where excluded.c > 0",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 26,
                  "name": "a",
                },
              },
              {
                "ResTarget": {
                  "location": 29,
                  "name": "b",
                },
              },
            ],
            "onConflictClause": {
              "action": "ONCONFLICT_UPDATE",
              "infer": {
                "indexElems": [
                  {
                    "IndexElem": {
                      "name": "a",
                      "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                      "ordering": "SORTBY_DEFAULT",
                    },
                  },
                ],
                "location": 68,
              },
              "location": 56,
              "targetList": [
                {
                  "ResTarget": {
                    "location": 86,
                    "name": "b",
                    "val": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "excluded",
                            },
                          },
                          {
                            "String": {
                              "sval": "b",
                            },
                          },
                        ],
                        "location": 90,
                      },
                    },
                  },
                },
              ],
              "whereClause": {
                "A_Expr": {
                  "kind": "AEXPR_OP",
                  "lexpr": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "excluded",
                          },
                        },
                        {
                          "String": {
                            "sval": "c",
                          },
                        },
                      ],
                      "location": 107,
                    },
                  },
                  "location": 118,
                  "name": [
                    {
                      "String": {
                        "sval": ">",
                      },
                    },
                  ],
                  "rexpr": {
                    "A_Const": {
                      "ival": {},
                      "location": 120,
                    },
                  },
                },
              },
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "uv_iocu_view",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "location": 40,
                            "sval": {
                              "sval": "xyxyxy",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 50,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1541 1`] = `
[
  "drop view uv_iocu_view",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "uv_iocu_view",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1545 1`] = `
[
  "create table uv_iocu_tab (a int unique, b text)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "uv_iocu_tab",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_UNIQUE",
                        "location": 32,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 26,
                  "typeName": {
                    "location": 28,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 40,
                  "typeName": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1547 1`] = `
[
  "    select b as bb, a as aa, uv_iocu_tab::text as cc from uv_iocu_tab",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 58,
                  "relname": "uv_iocu_tab",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 11,
                  "name": "bb",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 11,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 20,
                  "name": "aa",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 20,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 29,
                  "name": "cc",
                  "val": {
                    "TypeCast": {
                      "arg": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "uv_iocu_tab",
                              },
                            },
                          ],
                          "location": 29,
                        },
                      },
                      "location": 40,
                      "typeName": {
                        "location": 42,
                        "names": [
                          {
                            "String": {
                              "sval": "text",
                            },
                          },
                        ],
                        "typemod": -1,
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1549 1`] = `
[
  "insert into uv_iocu_view (aa,bb) values (1,'x')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 26,
                  "name": "aa",
                },
              },
              {
                "ResTarget": {
                  "location": 29,
                  "name": "bb",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "uv_iocu_view",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 41,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 43,
                            "sval": {
                              "sval": "x",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1551 1`] = `
[
  "insert into uv_iocu_view (aa,bb) values (1,'y')
   on conflict (aa) do update set bb = 'Rejected: '||excluded.*
   where excluded.aa > 0
   and excluded.bb != ''
   and excluded.cc is not null",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 26,
                  "name": "aa",
                },
              },
              {
                "ResTarget": {
                  "location": 29,
                  "name": "bb",
                },
              },
            ],
            "onConflictClause": {
              "action": "ONCONFLICT_UPDATE",
              "infer": {
                "indexElems": [
                  {
                    "IndexElem": {
                      "name": "aa",
                      "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                      "ordering": "SORTBY_DEFAULT",
                    },
                  },
                ],
                "location": 63,
              },
              "location": 51,
              "targetList": [
                {
                  "ResTarget": {
                    "location": 82,
                    "name": "bb",
                    "val": {
                      "A_Expr": {
                        "kind": "AEXPR_OP",
                        "lexpr": {
                          "A_Const": {
                            "location": 87,
                            "sval": {
                              "sval": "Rejected: ",
                            },
                          },
                        },
                        "location": 99,
                        "name": [
                          {
                            "String": {
                              "sval": "||",
                            },
                          },
                        ],
                        "rexpr": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "excluded",
                                },
                              },
                              {
                                "A_Star": {},
                              },
                            ],
                            "location": 101,
                          },
                        },
                      },
                    },
                  },
                },
              ],
              "whereClause": {
                "BoolExpr": {
                  "args": [
                    {
                      "A_Expr": {
                        "kind": "AEXPR_OP",
                        "lexpr": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "excluded",
                                },
                              },
                              {
                                "String": {
                                  "sval": "aa",
                                },
                              },
                            ],
                            "location": 121,
                          },
                        },
                        "location": 133,
                        "name": [
                          {
                            "String": {
                              "sval": ">",
                            },
                          },
                        ],
                        "rexpr": {
                          "A_Const": {
                            "ival": {},
                            "location": 135,
                          },
                        },
                      },
                    },
                    {
                      "A_Expr": {
                        "kind": "AEXPR_OP",
                        "lexpr": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "excluded",
                                },
                              },
                              {
                                "String": {
                                  "sval": "bb",
                                },
                              },
                            ],
                            "location": 144,
                          },
                        },
                        "location": 156,
                        "name": [
                          {
                            "String": {
                              "sval": "<>",
                            },
                          },
                        ],
                        "rexpr": {
                          "A_Const": {
                            "location": 159,
                            "sval": {
                              "sval": "",
                            },
                          },
                        },
                      },
                    },
                    {
                      "NullTest": {
                        "arg": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "excluded",
                                },
                              },
                              {
                                "String": {
                                  "sval": "cc",
                                },
                              },
                            ],
                            "location": 169,
                          },
                        },
                        "location": 181,
                        "nulltesttype": "IS_NOT_NULL",
                      },
                    },
                  ],
                  "boolop": "AND_EXPR",
                  "location": 140,
                },
              },
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "uv_iocu_view",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 41,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 43,
                            "sval": {
                              "sval": "y",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1564 1`] = `
[
  "delete from uv_iocu_view",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "uv_iocu_view",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1570 1`] = `
[
  "alter table uv_iocu_tab alter column b set default 'table default'",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "A_Const": {
                      "location": 51,
                      "sval": {
                        "sval": "table default",
                      },
                    },
                  },
                  "name": "b",
                  "subtype": "AT_ColumnDefault",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "uv_iocu_tab",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1575 1`] = `
[
  "alter view uv_iocu_view alter column bb set default 'view default'",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "A_Const": {
                      "location": 52,
                      "sval": {
                        "sval": "view default",
                      },
                    },
                  },
                  "name": "bb",
                  "subtype": "AT_ColumnDefault",
                },
              },
            ],
            "objtype": "OBJECT_VIEW",
            "relation": {
              "inh": true,
              "location": 11,
              "relname": "uv_iocu_view",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1581 1`] = `
[
  "insert into uv_iocu_view (aa) values (1)
   on conflict (aa) do update set cc = 'XXX'",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 26,
                  "name": "aa",
                },
              },
            ],
            "onConflictClause": {
              "action": "ONCONFLICT_UPDATE",
              "infer": {
                "indexElems": [
                  {
                    "IndexElem": {
                      "name": "aa",
                      "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                      "ordering": "SORTBY_DEFAULT",
                    },
                  },
                ],
                "location": 56,
              },
              "location": 44,
              "targetList": [
                {
                  "ResTarget": {
                    "location": 75,
                    "name": "cc",
                    "val": {
                      "A_Const": {
                        "location": 80,
                        "sval": {
                          "sval": "XXX",
                        },
                      },
                    },
                  },
                },
              ],
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "uv_iocu_view",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 38,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1588 1`] = `
[
  "create user regress_view_user1",
  {
    "stmts": [
      {
        "stmt": {
          "CreateRoleStmt": {
            "role": "regress_view_user1",
            "stmt_type": "ROLESTMT_USER",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1596 1`] = `
[
  "grant select (aa,bb) on rw_view1 to regress_view_user2",
  {
    "stmts": [
      {
        "stmt": {
          "GrantStmt": {
            "behavior": "DROP_RESTRICT",
            "grantees": [
              {
                "RoleSpec": {
                  "location": 36,
                  "rolename": "regress_view_user2",
                  "roletype": "ROLESPEC_CSTRING",
                },
              },
            ],
            "is_grant": true,
            "objects": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 24,
                  "relname": "rw_view1",
                  "relpersistence": "p",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "privileges": [
              {
                "AccessPriv": {
                  "cols": [
                    {
                      "String": {
                        "sval": "aa",
                      },
                    },
                    {
                      "String": {
                        "sval": "bb",
                      },
                    },
                  ],
                  "priv_name": "select",
                },
              },
            ],
            "targtype": "ACL_TARGET_OBJECT",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1602 1`] = `
[
  " -- Not allowed
insert into rw_view1 values ('yyy',2.0,1)
  on conflict (aa) do update set bb = rw_view1.cc",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "onConflictClause": {
              "action": "ONCONFLICT_UPDATE",
              "infer": {
                "indexElems": [
                  {
                    "IndexElem": {
                      "name": "aa",
                      "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                      "ordering": "SORTBY_DEFAULT",
                    },
                  },
                ],
                "location": 72,
              },
              "location": 60,
              "targetList": [
                {
                  "ResTarget": {
                    "location": 91,
                    "name": "bb",
                    "val": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "rw_view1",
                            },
                          },
                          {
                            "String": {
                              "sval": "cc",
                            },
                          },
                        ],
                        "location": 96,
                      },
                    },
                  },
                },
              ],
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "location": 45,
                            "sval": {
                              "sval": "yyy",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "2.0",
                            },
                            "location": 51,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 55,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1604 1`] = `
[
  " -- Not allowed
insert into rw_view1 values ('yyy',2.0,1)
  on conflict (aa) do update set bb = excluded.bb",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "onConflictClause": {
              "action": "ONCONFLICT_UPDATE",
              "infer": {
                "indexElems": [
                  {
                    "IndexElem": {
                      "name": "aa",
                      "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                      "ordering": "SORTBY_DEFAULT",
                    },
                  },
                ],
                "location": 72,
              },
              "location": 60,
              "targetList": [
                {
                  "ResTarget": {
                    "location": 91,
                    "name": "bb",
                    "val": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "excluded",
                            },
                          },
                          {
                            "String": {
                              "sval": "bb",
                            },
                          },
                        ],
                        "location": 96,
                      },
                    },
                  },
                },
              ],
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "location": 45,
                            "sval": {
                              "sval": "yyy",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "2.0",
                            },
                            "location": 51,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 55,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1606 1`] = `
[
  " -- OK
insert into rw_view1 values ('zzz',2.0,1)
  on conflict (aa) do update set bb = rw_view1.bb||'xxx'",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "onConflictClause": {
              "action": "ONCONFLICT_UPDATE",
              "infer": {
                "indexElems": [
                  {
                    "IndexElem": {
                      "name": "aa",
                      "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                      "ordering": "SORTBY_DEFAULT",
                    },
                  },
                ],
                "location": 63,
              },
              "location": 51,
              "targetList": [
                {
                  "ResTarget": {
                    "location": 82,
                    "name": "bb",
                    "val": {
                      "A_Expr": {
                        "kind": "AEXPR_OP",
                        "lexpr": {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "rw_view1",
                                },
                              },
                              {
                                "String": {
                                  "sval": "bb",
                                },
                              },
                            ],
                            "location": 87,
                          },
                        },
                        "location": 98,
                        "name": [
                          {
                            "String": {
                              "sval": "||",
                            },
                          },
                        ],
                        "rexpr": {
                          "A_Const": {
                            "location": 100,
                            "sval": {
                              "sval": "xxx",
                            },
                          },
                        },
                      },
                    },
                  },
                },
              ],
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 19,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "location": 36,
                            "sval": {
                              "sval": "zzz",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "2.0",
                            },
                            "location": 42,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 46,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1608 1`] = `
[
  " -- OK
insert into rw_view1 values ('zzz',2.0,1)
  on conflict (aa) do update set cc = 3.0",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "onConflictClause": {
              "action": "ONCONFLICT_UPDATE",
              "infer": {
                "indexElems": [
                  {
                    "IndexElem": {
                      "name": "aa",
                      "nulls_ordering": "SORTBY_NULLS_DEFAULT",
                      "ordering": "SORTBY_DEFAULT",
                    },
                  },
                ],
                "location": 63,
              },
              "location": 51,
              "targetList": [
                {
                  "ResTarget": {
                    "location": 82,
                    "name": "cc",
                    "val": {
                      "A_Const": {
                        "fval": {
                          "fval": "3.0",
                        },
                        "location": 87,
                      },
                    },
                  },
                },
              ],
            },
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 19,
              "relname": "rw_view1",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "location": 36,
                            "sval": {
                              "sval": "zzz",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "fval": {
                              "fval": "2.0",
                            },
                            "location": 42,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 46,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1622 1`] = `
[
  " -- Not allowed
create view rw_view3 as select b as bb, a as aa from base_tbl",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 69,
                      "relname": "base_tbl",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 47,
                      "name": "bb",
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "b",
                              },
                            },
                          ],
                          "location": 47,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 56,
                      "name": "aa",
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 56,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 28,
              "relname": "rw_view3",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1632 1`] = `
[
  " -- Not allowed
create view rw_view5 as select aa, bb FROM rw_view1",
  {
    "stmts": [
      {
        "stmt": {
          "ViewStmt": {
            "query": {
              "SelectStmt": {
                "fromClause": [
                  {
                    "RangeVar": {
                      "inh": true,
                      "location": 59,
                      "relname": "rw_view1",
                      "relpersistence": "p",
                    },
                  },
                ],
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "targetList": [
                  {
                    "ResTarget": {
                      "location": 47,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "aa",
                              },
                            },
                          ],
                          "location": 47,
                        },
                      },
                    },
                  },
                  {
                    "ResTarget": {
                      "location": 51,
                      "val": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "bb",
                              },
                            },
                          ],
                          "location": 51,
                        },
                      },
                    },
                  },
                ],
              },
            },
            "view": {
              "inh": true,
              "location": 28,
              "relname": "rw_view5",
              "relpersistence": "p",
            },
            "withCheckOption": "NO_CHECK_OPTION",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1639 1`] = `
[
  "drop view rw_view5",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "rw_view5",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1650 1`] = `
[
  "create table base_tab_def (a int, b text default 'Table default',
                           c text default 'Table default', d text, e text)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "base_tab_def",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 27,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_DEFAULT",
                        "location": 41,
                        "raw_expr": {
                          "A_Const": {
                            "location": 49,
                            "sval": {
                              "sval": "Table default",
                            },
                          },
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 36,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "c",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_DEFAULT",
                        "location": 100,
                        "raw_expr": {
                          "A_Const": {
                            "location": 108,
                            "sval": {
                              "sval": "Table default",
                            },
                          },
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 93,
                  "typeName": {
                    "location": 95,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "d",
                  "is_local": true,
                  "location": 125,
                  "typeName": {
                    "location": 127,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "e",
                  "is_local": true,
                  "location": 133,
                  "typeName": {
                    "location": 135,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1670 1`] = `
[
  "create function base_tab_def_view_instrig_func() returns trigger
as
$$
begin
  insert into base_tab_def values (new.a, new.b, new.c, new.d, new.e);
  return new;
end;
$$
language plpgsql",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "base_tab_def_view_instrig_func",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
begin
  insert into base_tab_def values (new.a, new.b, new.c, new.d, new.e);
  return new;
end;
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 65,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 170,
                },
              },
            ],
            "returnType": {
              "location": 57,
              "names": [
                {
                  "String": {
                    "sval": "trigger",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1697 1`] = `
[
  "drop trigger base_tab_def_view_instrig on base_tab_def_view",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "base_tab_def_view",
                      },
                    },
                    {
                      "String": {
                        "sval": "base_tab_def_view_instrig",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TRIGGER",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1720 1`] = `
[
  "drop rule base_tab_def_view_ins_rule on base_tab_def_view",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "base_tab_def_view",
                      },
                    },
                    {
                      "String": {
                        "sval": "base_tab_def_view_ins_rule",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_RULE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1747 1`] = `
[
  "drop view base_tab_def_view",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "base_tab_def_view",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_VIEW",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1751 1`] = `
[
  "create table base_tab (a serial, b int[], c text, d text default 'Table default')",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "base_tab",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 25,
                    "names": [
                      {
                        "String": {
                          "sval": "serial",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 33,
                  "typeName": {
                    "arrayBounds": [
                      {
                        "Integer": {},
                      },
                    ],
                    "location": 35,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "c",
                  "is_local": true,
                  "location": 42,
                  "typeName": {
                    "location": 44,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "d",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_DEFAULT",
                        "location": 57,
                        "raw_expr": {
                          "A_Const": {
                            "location": 65,
                            "sval": {
                              "sval": "Table default",
                            },
                          },
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 50,
                  "typeName": {
                    "location": 52,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`updatable_views.sql > line 1755 1`] = `
[
  "values (1, 2, default, 5, 4, default, 3), (10, 11, 'C value', 14, 13, 100, 12)",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "valuesLists": [
              {
                "List": {
                  "items": [
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 1,
                        },
                        "location": 8,
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 2,
                        },
                        "location": 11,
                      },
                    },
                    {
                      "SetToDefault": {
                        "location": 14,
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 5,
                        },
                        "location": 23,
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 4,
                        },
                        "location": 26,
                      },
                    },
                    {
                      "SetToDefault": {
                        "location": 29,
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 3,
                        },
                        "location": 38,
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 10,
                        },
                        "location": 43,
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 11,
                        },
                        "location": 47,
                      },
                    },
                    {
                      "A_Const": {
                        "location": 51,
                        "sval": {
                          "sval": "C value",
                        },
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 14,
                        },
                        "location": 62,
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 13,
                        },
                        "location": 66,
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 100,
                        },
                        "location": 70,
                      },
                    },
                    {
                      "A_Const": {
                        "ival": {
                          "ival": 12,
                        },
                        "location": 75,
                      },
                    },
                  ],
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;
