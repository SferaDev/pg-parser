// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`foreign_key.sql > line 9 1`] = `
[
  "CREATE TABLE PKTABLE ( ptest1 int PRIMARY KEY, ptest2 text )",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 34,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 30,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 13 1`] = `
[
  "INSERT INTO PKTABLE VALUES (1, 'Test1')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 28,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 31,
                            "sval": {
                              "sval": "Test1",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 20 1`] = `
[
  "INSERT INTO FKTABLE VALUES (1, 2)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 28,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2,
                            },
                            "location": 31,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 29 1`] = `
[
  "SELECT * FROM FKTABLE",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "fktable",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 32 1`] = `
[
  "DELETE FROM PKTABLE WHERE ptest1=1",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "ptest1",
                        },
                      },
                    ],
                    "location": 26,
                  },
                },
                "location": 32,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 33,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 38 1`] = `
[
  "UPDATE PKTABLE SET ptest1=1 WHERE ptest1=2",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "ptest1",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 1,
                      },
                      "location": 26,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "ptest1",
                        },
                      },
                    ],
                    "location": 34,
                  },
                },
                "location": 40,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 41,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 43 1`] = `
[
  "DROP TABLE FKTABLE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "fktable",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 49 1`] = `
[
  "CREATE TABLE PKTABLE ( ptest1 int, ptest2 int, ptest3 text, PRIMARY KEY(ptest1, ptest2) )",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 30,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 35,
                  "typeName": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest3",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "location": 60,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 54 1`] = `
[
  "COMMENT ON CONSTRAINT constrname_wrong ON FKTABLE IS 'fk constraint comment'",
  {
    "stmts": [
      {
        "stmt": {
          "CommentStmt": {
            "comment": "fk constraint comment",
            "object": {
              "List": {
                "items": [
                  {
                    "String": {
                      "sval": "fktable",
                    },
                  },
                  {
                    "String": {
                      "sval": "constrname_wrong",
                    },
                  },
                ],
              },
            },
            "objtype": "OBJECT_TABCONSTRAINT",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 83 1`] = `
[
  "DELETE FROM PKTABLE WHERE ptest1=1 and ptest2=2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "whereClause": {
              "BoolExpr": {
                "args": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ptest1",
                              },
                            },
                          ],
                          "location": 26,
                        },
                      },
                      "location": 32,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 33,
                        },
                      },
                    },
                  },
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ptest2",
                              },
                            },
                          ],
                          "location": 39,
                        },
                      },
                      "location": 45,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 46,
                        },
                      },
                    },
                  },
                ],
                "boolop": "AND_EXPR",
                "location": 35,
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 101 1`] = `
[
  "UPDATE FKTABLE SET ftest1 = NULL WHERE ftest1 = 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "ftest1",
                  "val": {
                    "A_Const": {
                      "isnull": true,
                      "location": 28,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "ftest1",
                        },
                      },
                    ],
                    "location": 39,
                  },
                },
                "location": 46,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 48,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 107 1`] = `
[
  "ALTER TABLE PKTABLE ALTER COLUMN ptest1 TYPE bigint",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "ColumnDef": {
                      "location": 33,
                      "typeName": {
                        "location": 45,
                        "names": [
                          {
                            "String": {
                              "sval": "pg_catalog",
                            },
                          },
                          {
                            "String": {
                              "sval": "int8",
                            },
                          },
                        ],
                        "typemod": -1,
                      },
                    },
                  },
                  "name": "ptest1",
                  "subtype": "AT_AlterColumnType",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 112 1`] = `
[
  "DROP TABLE PKTABLE CASCADE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "pktable",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 168 1`] = `
[
  "DROP TABLE PKTABLE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "pktable",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 199 1`] = `
[
  "SELECT * FROM PKTABLE",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "pktable",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 225 1`] = `
[
  "CREATE TABLE PKTABLE ( ptest1 int, ptest2 int, PRIMARY KEY(ptest1, ptest2) )",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 30,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 35,
                  "typeName": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "location": 47,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 231 1`] = `
[
  "ALTER TABLE FKTABLE ADD FOREIGN KEY(ftest1, ftest2) REFERENCES PKTABLE MATCH FULL",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "ftest1",
                          },
                        },
                        {
                          "String": {
                            "sval": "ftest2",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "f",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pktable": {
                        "inh": true,
                        "location": 63,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 240 1`] = `
[
  "CREATE TABLE PKTABLE ( ptest1 int, ptest2 int, ptest3 int, ptest4 text, PRIMARY KEY(ptest1, ptest2, ptest3) )",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 30,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 35,
                  "typeName": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest3",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest4",
                  "is_local": true,
                  "location": 59,
                  "typeName": {
                    "location": 66,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest3",
                      },
                    },
                  ],
                  "location": 72,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 264 1`] = `
[
  "UPDATE PKTABLE set ptest2=5 where ptest2=2",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "ptest2",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 5,
                      },
                      "location": 26,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "ptest2",
                        },
                      },
                    ],
                    "location": 34,
                  },
                },
                "location": 40,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 41,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 267 1`] = `
[
  "UPDATE PKTABLE set ptest1=1 WHERE ptest2=3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "ptest1",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 1,
                      },
                      "location": 26,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "ptest2",
                        },
                      },
                    ],
                    "location": 34,
                  },
                },
                "location": 40,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 41,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 270 1`] = `
[
  "DELETE FROM PKTABLE where ptest1=1 and ptest2=2 and ptest3=3",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "whereClause": {
              "BoolExpr": {
                "args": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ptest1",
                              },
                            },
                          ],
                          "location": 26,
                        },
                      },
                      "location": 32,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 33,
                        },
                      },
                    },
                  },
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ptest2",
                              },
                            },
                          ],
                          "location": 39,
                        },
                      },
                      "location": 45,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 46,
                        },
                      },
                    },
                  },
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ptest3",
                              },
                            },
                          ],
                          "location": 52,
                        },
                      },
                      "location": 58,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 3,
                          },
                          "location": 59,
                        },
                      },
                    },
                  },
                ],
                "boolop": "AND_EXPR",
                "location": 35,
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 284 1`] = `
[
  "CREATE TABLE PKTABLE ( ptest1 int, ptest2 int, ptest3 int, ptest4 text, UNIQUE(ptest1, ptest2, ptest3) )",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 30,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 35,
                  "typeName": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest3",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest4",
                  "is_local": true,
                  "location": 59,
                  "typeName": {
                    "location": 66,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_UNIQUE",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest3",
                      },
                    },
                  ],
                  "location": 72,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 384 1`] = `
[
  "UPDATE PKTABLE set ptest2=2 WHERE ptest2=3 and ptest1=1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "ptest2",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 2,
                      },
                      "location": 26,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "BoolExpr": {
                "args": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ptest2",
                              },
                            },
                          ],
                          "location": 34,
                        },
                      },
                      "location": 40,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 3,
                          },
                          "location": 41,
                        },
                      },
                    },
                  },
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ptest1",
                              },
                            },
                          ],
                          "location": 47,
                        },
                      },
                      "location": 53,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 54,
                        },
                      },
                    },
                  },
                ],
                "boolop": "AND_EXPR",
                "location": 43,
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 398 1`] = `
[
  "DELETE FROM PKTABLE where ptest2=5",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "ptest2",
                        },
                      },
                    ],
                    "location": 26,
                  },
                },
                "location": 32,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 5,
                    },
                    "location": 33,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 439 1`] = `
[
  "UPDATE PKTABLE set ptest1=0, ptest2=-1, ptest3=-2 where ptest2=2",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "ptest1",
                  "val": {
                    "A_Const": {
                      "ival": {},
                      "location": 26,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 29,
                  "name": "ptest2",
                  "val": {
                    "A_Const": {
                      "ival": {},
                      "location": 36,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 40,
                  "name": "ptest3",
                  "val": {
                    "A_Const": {
                      "ival": {},
                      "location": 47,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "ptest2",
                        },
                      },
                    ],
                    "location": 56,
                  },
                },
                "location": 62,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 63,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 457 1`] = `
[
  "DELETE FROM PKTABLE where ptest2=-1 and ptest3=5",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "whereClause": {
              "BoolExpr": {
                "args": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ptest2",
                              },
                            },
                          ],
                          "location": 26,
                        },
                      },
                      "location": 32,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {},
                          "location": 33,
                        },
                      },
                    },
                  },
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ptest3",
                              },
                            },
                          ],
                          "location": 40,
                        },
                      },
                      "location": 46,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 5,
                          },
                          "location": 47,
                        },
                      },
                    },
                  },
                ],
                "boolop": "AND_EXPR",
                "location": 36,
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 467 1`] = `
[
  "CREATE TABLE PKTABLE (tid int, id int, PRIMARY KEY (tid, id))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "tid",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 26,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "id",
                  "is_local": true,
                  "location": 31,
                  "typeName": {
                    "location": 34,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "tid",
                      },
                    },
                    {
                      "String": {
                        "sval": "id",
                      },
                    },
                  ],
                  "location": 39,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 479 1`] = `
[
  "SELECT pg_get_constraintdef(oid) FROM pg_constraint WHERE conrelid = 'fktable'::regclass::oid ORDER BY oid",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 38,
                  "relname": "pg_constraint",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "oid",
                          },
                        },
                      ],
                      "location": 103,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "FuncCall": {
                      "args": [
                        {
                          "ColumnRef": {
                            "fields": [
                              {
                                "String": {
                                  "sval": "oid",
                                },
                              },
                            ],
                            "location": 28,
                          },
                        },
                      ],
                      "funcformat": "COERCE_EXPLICIT_CALL",
                      "funcname": [
                        {
                          "String": {
                            "sval": "pg_get_constraintdef",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "conrelid",
                        },
                      },
                    ],
                    "location": 58,
                  },
                },
                "location": 67,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "TypeCast": {
                    "arg": {
                      "TypeCast": {
                        "arg": {
                          "A_Const": {
                            "location": 69,
                            "sval": {
                              "sval": "fktable",
                            },
                          },
                        },
                        "location": 78,
                        "typeName": {
                          "location": 80,
                          "names": [
                            {
                              "String": {
                                "sval": "regclass",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                    "location": 88,
                    "typeName": {
                      "location": 90,
                      "names": [
                        {
                          "String": {
                            "sval": "oid",
                          },
                        },
                      ],
                      "typemod": -1,
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 486 1`] = `
[
  "DELETE FROM PKTABLE WHERE id = 1 OR id = 2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "whereClause": {
              "BoolExpr": {
                "args": [
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "id",
                              },
                            },
                          ],
                          "location": 26,
                        },
                      },
                      "location": 29,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 31,
                        },
                      },
                    },
                  },
                  {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "id",
                              },
                            },
                          ],
                          "location": 36,
                        },
                      },
                      "location": 39,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 41,
                        },
                      },
                    },
                  },
                ],
                "boolop": "OR_EXPR",
                "location": 33,
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 488 1`] = `
[
  "SELECT * FROM FKTABLE ORDER BY id",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "fktable",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "id",
                          },
                        },
                      ],
                      "location": 31,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 494 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 int PRIMARY KEY, someoid oid)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 33,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "someoid",
                  "is_local": true,
                  "location": 46,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "oid",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 503 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 int, ptest2 int, UNIQUE(ptest1, ptest2))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_UNIQUE",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "location": 46,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 506 1`] = `
[
  "DROP TABLE FKTABLE_FAIL1",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "fktable_fail1",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 513 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 int PRIMARY KEY)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 33,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 516 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 inet REFERENCES pktable)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 34,
                        "pktable": {
                          "inh": true,
                          "location": 45,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 519 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 inet REFERENCES pktable(ptest1))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 34,
                        "pk_attrs": [
                          {
                            "String": {
                              "sval": "ptest1",
                            },
                          },
                        ],
                        "pktable": {
                          "inh": true,
                          "location": 45,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 522 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 int8 REFERENCES pktable)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 34,
                        "pktable": {
                          "inh": true,
                          "location": 45,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "int8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 525 1`] = `
[
  "		-- should fail
UPDATE FKTABLE SET ftest1 = ftest1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 24,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 36,
                  "name": "ftest1",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "ftest1",
                          },
                        },
                      ],
                      "location": 45,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 526 1`] = `
[
  "	-- should succeed
UPDATE FKTABLE SET ftest1 = ftest1 + 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 26,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 38,
                  "name": "ftest1",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "ftest1",
                              },
                            },
                          ],
                          "location": 47,
                        },
                      },
                      "location": 54,
                      "name": [
                        {
                          "String": {
                            "sval": "+",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 56,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 532 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 numeric REFERENCES pktable)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 37,
                        "pktable": {
                          "inh": true,
                          "location": 48,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "numeric",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 536 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 numeric PRIMARY KEY)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 37,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "numeric",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 548 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 int, ptest2 inet, PRIMARY KEY(ptest1, ptest2))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "location": 47,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 550 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 cidr, ftest2 timestamp, FOREIGN KEY(ftest1, ftest2) REFERENCES pktable)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "cidr",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ftest2",
                  "is_local": true,
                  "location": 35,
                  "typeName": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "timestamp",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ftest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ftest2",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 53,
                  "pktable": {
                    "inh": true,
                    "location": 92,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 552 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 cidr, ftest2 timestamp, FOREIGN KEY(ftest1, ftest2) REFERENCES pktable(ptest1, ptest2))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "cidr",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ftest2",
                  "is_local": true,
                  "location": 35,
                  "typeName": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "timestamp",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ftest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ftest2",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 53,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 92,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 554 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 int, ftest2 inet, FOREIGN KEY(ftest2, ftest1) REFERENCES pktable)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ftest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ftest2",
                      },
                    },
                    {
                      "String": {
                        "sval": "ftest1",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 47,
                  "pktable": {
                    "inh": true,
                    "location": 86,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 556 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 int, ftest2 inet, FOREIGN KEY(ftest2, ftest1) REFERENCES pktable(ptest1, ptest2))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ftest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ftest2",
                      },
                    },
                    {
                      "String": {
                        "sval": "ftest1",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 47,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 86,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 558 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 int, ftest2 inet, FOREIGN KEY(ftest1, ftest2) REFERENCES pktable(ptest2, ptest1))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ftest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ftest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ftest2",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 47,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 86,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 560 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 int, ftest2 inet, FOREIGN KEY(ftest2, ftest1) REFERENCES pktable(ptest2, ptest1))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ftest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ftest2",
                      },
                    },
                    {
                      "String": {
                        "sval": "ftest1",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 47,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 86,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 563 1`] = `
[
  "CREATE TABLE FKTABLE (ftest1 int, ftest2 inet, FOREIGN KEY(ftest1, ftest2) REFERENCES pktable(ptest1, ptest2))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ftest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ftest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ftest2",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 47,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 86,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 569 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 int, ptest2 inet, ptest3 int, ptest4 inet, PRIMARY KEY(ptest1, ptest2), FOREIGN KEY(ptest3,
ptest4) REFERENCES pktable(ptest1, ptest2))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest3",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest4",
                  "is_local": true,
                  "location": 59,
                  "typeName": {
                    "location": 66,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "location": 72,
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ptest3",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest4",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 101,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 140,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 573 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 int, ptest2 inet, ptest3 int, ptest4 inet, PRIMARY KEY(ptest1, ptest2), FOREIGN KEY(ptest3,
ptest4) REFERENCES pktable)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest3",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest4",
                  "is_local": true,
                  "location": 59,
                  "typeName": {
                    "location": 66,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "location": 72,
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ptest3",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest4",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 101,
                  "pktable": {
                    "inh": true,
                    "location": 140,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 577 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 int, ptest2 inet, ptest3 int, ptest4 inet, PRIMARY KEY(ptest1, ptest2), FOREIGN KEY(ptest3,
ptest4) REFERENCES pktable(ptest2, ptest1))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest3",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest4",
                  "is_local": true,
                  "location": 59,
                  "typeName": {
                    "location": 66,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "location": 72,
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ptest3",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest4",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 101,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 140,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 580 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 int, ptest2 inet, ptest3 int, ptest4 inet, PRIMARY KEY(ptest1, ptest2), FOREIGN KEY(ptest4,
ptest3) REFERENCES pktable(ptest1, ptest2))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest3",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest4",
                  "is_local": true,
                  "location": 59,
                  "typeName": {
                    "location": 66,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "location": 72,
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ptest4",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest3",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 101,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 140,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 583 1`] = `
[
  "CREATE TABLE PKTABLE (ptest1 int, ptest2 inet, ptest3 int, ptest4 inet, PRIMARY KEY(ptest1, ptest2), FOREIGN KEY(ptest4,
ptest3) REFERENCES pktable)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ptest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest3",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 54,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ptest4",
                  "is_local": true,
                  "location": 59,
                  "typeName": {
                    "location": 66,
                    "names": [
                      {
                        "String": {
                          "sval": "inet",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest2",
                      },
                    },
                  ],
                  "location": 72,
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ptest4",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest3",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 101,
                  "pktable": {
                    "inh": true,
                    "location": 140,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 589 1`] = `
[
  "create table pktable_base (base1 int not null)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable_base",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "base1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_NOTNULL",
                        "location": 37,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 27,
                  "typeName": {
                    "location": 33,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 593 1`] = `
[
  "insert into pktable(base1) values (1)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 20,
                  "name": "base1",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 35,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 596 1`] = `
[
  "insert into fktable(ftest1) values (3)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 20,
                  "name": "ftest1",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 36,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 601 1`] = `
[
  "delete from pktable where base1>2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "base1",
                        },
                      },
                    ],
                    "location": 26,
                  },
                },
                "location": 31,
                "name": [
                  {
                    "String": {
                      "sval": ">",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 32,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 604 1`] = `
[
  "update pktable set base1=base1*4",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "base1",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "base1",
                              },
                            },
                          ],
                          "location": 25,
                        },
                      },
                      "location": 30,
                      "name": [
                        {
                          "String": {
                            "sval": "*",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 4,
                          },
                          "location": 31,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 606 1`] = `
[
  "update pktable set base1=base1*4 where base1<3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "base1",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "base1",
                              },
                            },
                          ],
                          "location": 25,
                        },
                      },
                      "location": 30,
                      "name": [
                        {
                          "String": {
                            "sval": "*",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 4,
                          },
                          "location": 31,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "base1",
                        },
                      },
                    ],
                    "location": 39,
                  },
                },
                "location": 44,
                "name": [
                  {
                    "String": {
                      "sval": "<",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 45,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 614 1`] = `
[
  "create table fktable (ftest1 int, ftest2 int, foreign key(ftest1, ftest2) references pktable(base1, ptest1))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 29,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ftest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ftest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ftest2",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 46,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "base1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ptest1",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 85,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 616 1`] = `
[
  "insert into pktable(base1, ptest1) values (1, 1)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 20,
                  "name": "base1",
                },
              },
              {
                "ResTarget": {
                  "location": 27,
                  "name": "ptest1",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 43,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 46,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 619 1`] = `
[
  "insert into fktable(ftest1, ftest2) values (3, 1)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 20,
                  "name": "ftest1",
                },
              },
              {
                "ResTarget": {
                  "location": 28,
                  "name": "ftest2",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 44,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 47,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 638 1`] = `
[
  "create table pktable_base(base1 int not null, base2 int)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable_base",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "base1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_NOTNULL",
                        "location": 36,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 26,
                  "typeName": {
                    "location": 32,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "base2",
                  "is_local": true,
                  "location": 46,
                  "typeName": {
                    "location": 52,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 646 1`] = `
[
  "insert into pktable (base1, ptest1, base2, ptest2) values (2, 3, 3, 2)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 21,
                  "name": "base1",
                },
              },
              {
                "ResTarget": {
                  "location": 28,
                  "name": "ptest1",
                },
              },
              {
                "ResTarget": {
                  "location": 36,
                  "name": "base2",
                },
              },
              {
                "ResTarget": {
                  "location": 43,
                  "name": "ptest2",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2,
                            },
                            "location": 59,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 62,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3,
                            },
                            "location": 65,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2,
                            },
                            "location": 68,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 648 1`] = `
[
  "delete from pktable where base1=2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "base1",
                        },
                      },
                    ],
                    "location": 26,
                  },
                },
                "location": 31,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 32,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 650 1`] = `
[
  "update pktable set base1=3 where base1=1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "base1",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 3,
                      },
                      "location": 25,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "base1",
                        },
                      },
                    ],
                    "location": 33,
                  },
                },
                "location": 38,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 39,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 652 1`] = `
[
  "delete from pktable where base2=2",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "base2",
                        },
                      },
                    ],
                    "location": 26,
                  },
                },
                "location": 31,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2,
                    },
                    "location": 32,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 661 1`] = `
[
  "create table fktable(ftest1 cidr, ftest2 int[], foreign key (ftest1, ftest2) references pktable)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "ftest1",
                  "is_local": true,
                  "location": 21,
                  "typeName": {
                    "location": 28,
                    "names": [
                      {
                        "String": {
                          "sval": "cidr",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "ftest2",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "arrayBounds": [
                      {
                        "Integer": {},
                      },
                    ],
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "ftest1",
                      },
                    },
                    {
                      "String": {
                        "sval": "ftest2",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 48,
                  "pktable": {
                    "inh": true,
                    "location": 88,
                    "relname": "pktable",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 688 1`] = `
[
  "CREATE TABLE pktable (
	id		INT4 PRIMARY KEY,
	other	INT4
)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "id",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 33,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 28,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "other",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 53,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 693 1`] = `
[
  "CREATE TABLE fktable (
	id		INT4 PRIMARY KEY,
	fk		INT4 REFERENCES pktable DEFERRABLE
)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "id",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 33,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 28,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "fk",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 56,
                        "pktable": {
                          "inh": true,
                          "location": 67,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                    {
                      "Constraint": {
                        "contype": "CONSTR_ATTR_DEFERRABLE",
                        "location": 75,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 51,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 702 1`] = `
[
  "BEGIN",
  {
    "stmts": [
      {
        "stmt": {
          "TransactionStmt": {
            "kind": "TRANS_STMT_BEGIN",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 704 1`] = `
[
  "SET CONSTRAINTS ALL DEFERRED",
  {
    "stmts": [
      {
        "stmt": {
          "ConstraintsSetStmt": {
            "deferred": true,
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 707 1`] = `
[
  " -- make the FK insert valid

COMMIT",
  {
    "stmts": [
      {
        "stmt": {
          "TransactionStmt": {
            "kind": "TRANS_STMT_COMMIT",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 711 1`] = `
[
  "DROP TABLE fktable, pktable",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "fktable",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "pktable",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 719 1`] = `
[
  "CREATE TABLE fktable (
	id		INT4 PRIMARY KEY,
	fk		INT4 REFERENCES pktable DEFERRABLE INITIALLY DEFERRED
)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "id",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 33,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 28,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "fk",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 56,
                        "pktable": {
                          "inh": true,
                          "location": 67,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                    {
                      "Constraint": {
                        "contype": "CONSTR_ATTR_DEFERRABLE",
                        "location": 75,
                      },
                    },
                    {
                      "Constraint": {
                        "contype": "CONSTR_ATTR_DEFERRED",
                        "location": 86,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 51,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 735 1`] = `
[
  "SET CONSTRAINTS ALL IMMEDIATE",
  {
    "stmts": [
      {
        "stmt": {
          "ConstraintsSetStmt": {},
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 793 1`] = `
[
  "DROP TABLE pktable, fktable",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "pktable",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "fktable",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 805 1`] = `
[
  "CREATE TEMP TABLE fktable (
        x1      INT4 REFERENCES pktable(id1),
        x2      VARCHAR(4) REFERENCES pktable(id2),
        x3      REAL REFERENCES pktable(id3),
        x4      TEXT,
        x5      INT2
)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 18,
              "relname": "fktable",
              "relpersistence": "t",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "x1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 49,
                        "pk_attrs": [
                          {
                            "String": {
                              "sval": "id1",
                            },
                          },
                        ],
                        "pktable": {
                          "inh": true,
                          "location": 60,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 36,
                  "typeName": {
                    "location": 44,
                    "names": [
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "x2",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 101,
                        "pk_attrs": [
                          {
                            "String": {
                              "sval": "id2",
                            },
                          },
                        ],
                        "pktable": {
                          "inh": true,
                          "location": 112,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 82,
                  "typeName": {
                    "location": 90,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "varchar",
                        },
                      },
                    ],
                    "typemod": -1,
                    "typmods": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 4,
                          },
                          "location": 98,
                        },
                      },
                    ],
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "x3",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 147,
                        "pk_attrs": [
                          {
                            "String": {
                              "sval": "id3",
                            },
                          },
                        ],
                        "pktable": {
                          "inh": true,
                          "location": 158,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 134,
                  "typeName": {
                    "location": 142,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "float4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "x4",
                  "is_local": true,
                  "location": 180,
                  "typeName": {
                    "location": 188,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "x5",
                  "is_local": true,
                  "location": 202,
                  "typeName": {
                    "location": 210,
                    "names": [
                      {
                        "String": {
                          "sval": "int2",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 818 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_2_3
FOREIGN KEY (x2) REFERENCES pktable(id3)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_2_3",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x2",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id3",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 70,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 822 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_2_1
FOREIGN KEY (x2) REFERENCES pktable(id1)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_2_1",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x2",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id1",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 70,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 826 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_3_1
FOREIGN KEY (x3) REFERENCES pktable(id1)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_3_1",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x3",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id1",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 70,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 830 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_1_2
FOREIGN KEY (x1) REFERENCES pktable(id2)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_1_2",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x1",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id2",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 70,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 836 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_1_3
FOREIGN KEY (x1) REFERENCES pktable(id3)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_1_3",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x1",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id3",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 70,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 840 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_4_2
FOREIGN KEY (x4) REFERENCES pktable(id2)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_4_2",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x4",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id2",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 70,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 844 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_5_1
FOREIGN KEY (x5) REFERENCES pktable(id1)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_5_1",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x5",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id1",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 70,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 854 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_213_213
FOREIGN KEY (x2,x1,x3) REFERENCES pktable(id2,id1,id3)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_213_213",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x2",
                          },
                        },
                        {
                          "String": {
                            "sval": "x1",
                          },
                        },
                        {
                          "String": {
                            "sval": "x3",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id2",
                          },
                        },
                        {
                          "String": {
                            "sval": "id1",
                          },
                        },
                        {
                          "String": {
                            "sval": "id3",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 80,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 857 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_253_213
FOREIGN KEY (x2,x5,x3) REFERENCES pktable(id2,id1,id3)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_253_213",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x2",
                          },
                        },
                        {
                          "String": {
                            "sval": "x5",
                          },
                        },
                        {
                          "String": {
                            "sval": "x3",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id2",
                          },
                        },
                        {
                          "String": {
                            "sval": "id1",
                          },
                        },
                        {
                          "String": {
                            "sval": "id3",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 80,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 865 1`] = `
[
  "ALTER TABLE fktable ADD CONSTRAINT fk_241_132
FOREIGN KEY (x2,x4,x1) REFERENCES pktable(id1,id3,id2)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fk_241_132",
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "x2",
                          },
                        },
                        {
                          "String": {
                            "sval": "x4",
                          },
                        },
                        {
                          "String": {
                            "sval": "x1",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 24,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "id1",
                          },
                        },
                        {
                          "String": {
                            "sval": "id3",
                          },
                        },
                        {
                          "String": {
                            "sval": "id2",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 80,
                        "relname": "pktable",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 882 1`] = `
[
  "CREATE TEMP TABLE fktable (
    id int primary key,
    fk int references pktable deferrable initially deferred
)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 18,
              "relname": "fktable",
              "relpersistence": "t",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "id",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 39,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 32,
                  "typeName": {
                    "location": 35,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "fk",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 63,
                        "pktable": {
                          "inh": true,
                          "location": 74,
                          "relname": "pktable",
                          "relpersistence": "p",
                        },
                      },
                    },
                    {
                      "Constraint": {
                        "contype": "CONSTR_ATTR_DEFERRABLE",
                        "location": 82,
                      },
                    },
                    {
                      "Constraint": {
                        "contype": "CONSTR_ATTR_DEFERRED",
                        "location": 93,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 56,
                  "typeName": {
                    "location": 59,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 895 1`] = `
[
  "UPDATE fktable SET id = id + 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "fktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "id",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "id",
                              },
                            },
                          ],
                          "location": 24,
                        },
                      },
                      "location": 27,
                      "name": [
                        {
                          "String": {
                            "sval": "+",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 29,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 908 1`] = `
[
  "SAVEPOINT savept1",
  {
    "stmts": [
      {
        "stmt": {
          "TransactionStmt": {
            "kind": "TRANS_STMT_SAVEPOINT",
            "savepoint_name": "savept1",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 924 1`] = `
[
  "RELEASE SAVEPOINT savept1",
  {
    "stmts": [
      {
        "stmt": {
          "TransactionStmt": {
            "kind": "TRANS_STMT_RELEASE",
            "savepoint_name": "savept1",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 944 1`] = `
[
  "ROLLBACK TO savept1",
  {
    "stmts": [
      {
        "stmt": {
          "TransactionStmt": {
            "kind": "TRANS_STMT_ROLLBACK_TO",
            "savepoint_name": "savept1",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 955 1`] = `
[
  "ALTER TABLE fktable ALTER CONSTRAINT fktable_fk_fkey DEFERRABLE INITIALLY IMMEDIATE",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fktable_fk_fkey",
                      "contype": "CONSTR_FOREIGN",
                      "deferrable": true,
                    },
                  },
                  "subtype": "AT_AlterConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 960 1`] = `
[
  "UPDATE pktable SET id = 10 WHERE id = 5",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 19,
                  "name": "id",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 10,
                      },
                      "location": 24,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "id",
                        },
                      },
                    ],
                    "location": 33,
                  },
                },
                "location": 36,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 5,
                    },
                    "location": 38,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 972 1`] = `
[
  "ALTER TABLE fktable ALTER CONSTRAINT fktable_fk_fkey NOT DEFERRABLE",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "fktable_fk_fkey",
                      "contype": "CONSTR_FOREIGN",
                    },
                  },
                  "subtype": "AT_AlterConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fktable",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 985 1`] = `
[
  "INSERT INTO users VALUES (1, 'Jozko')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "users",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 26,
                          },
                        },
                        {
                          "A_Const": {
                            "location": 29,
                            "sval": {
                              "sval": "Jozko",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 989 1`] = `
[
  "CREATE TEMP TABLE tasks (
  id INT PRIMARY KEY,
  owner INT REFERENCES users ON UPDATE CASCADE ON DELETE SET NULL,
  worker INT REFERENCES users ON UPDATE CASCADE ON DELETE SET NULL,
  checked_by INT REFERENCES users ON UPDATE CASCADE ON DELETE SET NULL
)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 18,
              "relname": "tasks",
              "relpersistence": "t",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "id",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 35,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 28,
                  "typeName": {
                    "location": 31,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "owner",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "n",
                        "fk_matchtype": "s",
                        "fk_upd_action": "c",
                        "initially_valid": true,
                        "location": 60,
                        "pktable": {
                          "inh": true,
                          "location": 71,
                          "relname": "users",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 50,
                  "typeName": {
                    "location": 56,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "worker",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "n",
                        "fk_matchtype": "s",
                        "fk_upd_action": "c",
                        "initially_valid": true,
                        "location": 128,
                        "pktable": {
                          "inh": true,
                          "location": 139,
                          "relname": "users",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 117,
                  "typeName": {
                    "location": 124,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "checked_by",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "n",
                        "fk_matchtype": "s",
                        "fk_upd_action": "c",
                        "initially_valid": true,
                        "location": 200,
                        "pktable": {
                          "inh": true,
                          "location": 211,
                          "relname": "users",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 185,
                  "typeName": {
                    "location": 196,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 996 1`] = `
[
  "INSERT INTO tasks VALUES (1,1,NULL,NULL)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "tasks",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 26,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 28,
                          },
                        },
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 30,
                          },
                        },
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 35,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1000 1`] = `
[
  "SELECT * FROM tasks",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "tasks",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1002 1`] = `
[
  "UPDATE users SET id = 4 WHERE id = 3",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "users",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 17,
                  "name": "id",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 4,
                      },
                      "location": 22,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "id",
                        },
                      },
                    ],
                    "location": 30,
                  },
                },
                "location": 33,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 3,
                    },
                    "location": 35,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1006 1`] = `
[
  "DELETE FROM users WHERE id = 4",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "users",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "id",
                        },
                      },
                    ],
                    "location": 24,
                  },
                },
                "location": 27,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 4,
                    },
                    "location": 29,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1021 1`] = `
[
  "create temp table selfref (
    a int primary key,
    b int,
    foreign key (b) references selfref (a)
        on update cascade on delete cascade
)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 18,
              "relname": "selfref",
              "relpersistence": "t",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 38,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 32,
                  "typeName": {
                    "location": 34,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 55,
                  "typeName": {
                    "location": 57,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "b",
                      },
                    },
                  ],
                  "fk_del_action": "c",
                  "fk_matchtype": "s",
                  "fk_upd_action": "c",
                  "initially_valid": true,
                  "location": 66,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "a",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 93,
                    "relname": "selfref",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1028 1`] = `
[
  "insert into selfref (a, b)
values
    (0, 0),
    (1, 1)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 21,
                  "name": "a",
                },
              },
              {
                "ResTarget": {
                  "location": 24,
                  "name": "b",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "selfref",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {},
                            "location": 39,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {},
                            "location": 42,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 51,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 54,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1043 1`] = `
[
  "create temp table defp (f1 int primary key)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 18,
              "relname": "defp",
              "relpersistence": "t",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "f1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 31,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 27,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1051 1`] = `
[
  " -- fail
alter table defc alter column f1 set default 1",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "A_Const": {
                      "ival": {
                        "ival": 1,
                      },
                      "location": 54,
                    },
                  },
                  "name": "f1",
                  "subtype": "AT_ColumnDefault",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 21,
              "relname": "defc",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1067 1`] = `
[
  " -- fail
delete from pp where f1 = 13",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 21,
              "relname": "pp",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "f1",
                        },
                      },
                    ],
                    "location": 30,
                  },
                },
                "location": 33,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 13,
                    },
                    "location": 35,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1068 1`] = `
[
  " -- fail
drop table pp, cc",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "pp",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "cc",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1084 1`] = `
[
  "create temp table t1 (a integer primary key, b text)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 18,
              "relname": "t1",
              "relpersistence": "t",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 32,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 24,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 45,
                  "typeName": {
                    "location": 47,
                    "names": [
                      {
                        "String": {
                          "sval": "text",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1088 1`] = `
[
  "explain (costs off) delete from t1 where a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "ExplainStmt": {
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "off",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "costs",
                  "location": 9,
                },
              },
            ],
            "query": {
              "DeleteStmt": {
                "relation": {
                  "inh": true,
                  "location": 32,
                  "relname": "t1",
                  "relpersistence": "p",
                },
                "whereClause": {
                  "A_Expr": {
                    "kind": "AEXPR_OP",
                    "lexpr": {
                      "ColumnRef": {
                        "fields": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "location": 41,
                      },
                    },
                    "location": 43,
                    "name": [
                      {
                        "String": {
                          "sval": "=",
                        },
                      },
                    ],
                    "rexpr": {
                      "A_Const": {
                        "ival": {
                          "ival": 1,
                        },
                        "location": 45,
                      },
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1093 1`] = `
[
  "create table pktable2 (a int, b int, c int, d int, e int, primary key (d, e))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable2",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 25,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 30,
                  "typeName": {
                    "location": 32,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "c",
                  "is_local": true,
                  "location": 37,
                  "typeName": {
                    "location": 39,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "d",
                  "is_local": true,
                  "location": 44,
                  "typeName": {
                    "location": 46,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "e",
                  "is_local": true,
                  "location": 51,
                  "typeName": {
                    "location": 53,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "d",
                      },
                    },
                    {
                      "String": {
                        "sval": "e",
                      },
                    },
                  ],
                  "location": 58,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1102 1`] = `
[
  "create table pktable1 (a int primary key)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable1",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 29,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 25,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1118 1`] = `
[
  "create table pktable2(f1 int primary key)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable2",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "f1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 29,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 22,
                  "typeName": {
                    "location": 25,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1149 1`] = `
[
  "drop table pktable2, fktable2",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "pktable2",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "fktable2",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1154 1`] = `
[
  "create table pktable2 (a float8, b float8, primary key (a, b))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pktable2",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 23,
                  "typeName": {
                    "location": 25,
                    "names": [
                      {
                        "String": {
                          "sval": "float8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 33,
                  "typeName": {
                    "location": 35,
                    "names": [
                      {
                        "String": {
                          "sval": "float8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "a",
                      },
                    },
                    {
                      "String": {
                        "sval": "b",
                      },
                    },
                  ],
                  "location": 43,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1157 1`] = `
[
  "insert into pktable2 values ('-0', '-0')",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pktable2",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "location": 29,
                            "sval": {
                              "sval": "-0",
                            },
                          },
                        },
                        {
                          "A_Const": {
                            "location": 35,
                            "sval": {
                              "sval": "-0",
                            },
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1160 1`] = `
[
  "select * from pktable2",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "pktable2",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1163 1`] = `
[
  "update pktable2 set a = '0' where a = '-0'",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pktable2",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 20,
                  "name": "a",
                  "val": {
                    "A_Const": {
                      "location": 24,
                      "sval": {
                        "sval": "0",
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 34,
                  },
                },
                "location": 36,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "location": 38,
                    "sval": {
                      "sval": "-0",
                    },
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1167 1`] = `
[
  "select * from fktable2",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "fktable2",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1177 1`] = `
[
  "CREATE TABLE fk_notpartitioned_pk (fdrop1 int, a int, fdrop2 int, b int,
  PRIMARY KEY (a, b))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk_notpartitioned_pk",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "fdrop1",
                  "is_local": true,
                  "location": 35,
                  "typeName": {
                    "location": 42,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 47,
                  "typeName": {
                    "location": 49,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "fdrop2",
                  "is_local": true,
                  "location": 54,
                  "typeName": {
                    "location": 61,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 66,
                  "typeName": {
                    "location": 68,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "a",
                      },
                    },
                    {
                      "String": {
                        "sval": "b",
                      },
                    },
                  ],
                  "location": 75,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1190 1`] = `
[
  "CREATE TABLE fk_partitioned_fk_3 (fdrop1 int, fdrop2 int, fdrop3 int, fdrop4 int, b int, a int)
  PARTITION BY HASH (a)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 98,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 117,
                    "name": "a",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_HASH",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk_partitioned_fk_3",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "fdrop1",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 41,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "fdrop2",
                  "is_local": true,
                  "location": 46,
                  "typeName": {
                    "location": 53,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "fdrop3",
                  "is_local": true,
                  "location": 58,
                  "typeName": {
                    "location": 65,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "fdrop4",
                  "is_local": true,
                  "location": 70,
                  "typeName": {
                    "location": 77,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 82,
                  "typeName": {
                    "location": 84,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 89,
                  "typeName": {
                    "location": 91,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1201 1`] = `
[
  "ALTER TABLE ONLY fk_partitioned_fk ADD FOREIGN KEY (a, b)
  REFERENCES fk_notpartitioned_pk",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 39,
                      "pktable": {
                        "inh": true,
                        "location": 71,
                        "relname": "fk_notpartitioned_pk",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "location": 17,
              "relname": "fk_partitioned_fk",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1205 1`] = `
[
  "ALTER TABLE fk_partitioned_fk ADD FOREIGN KEY (a, b)
  REFERENCES fk_notpartitioned_pk NOT VALID",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "location": 34,
                      "pktable": {
                        "inh": true,
                        "location": 66,
                        "relname": "fk_notpartitioned_pk",
                        "relpersistence": "p",
                      },
                      "skip_validation": true,
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_partitioned_fk",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1210 1`] = `
[
  "INSERT INTO fk_partitioned_fk (a,b) VALUES (500, 501)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 31,
                  "name": "a",
                },
              },
              {
                "ResTarget": {
                  "location": 33,
                  "name": "b",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_partitioned_fk",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 500,
                            },
                            "location": 44,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 501,
                            },
                            "location": 49,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1220 1`] = `
[
  "INSERT INTO fk_notpartitioned_pk VALUES (500, 501), (1500, 1501),
  (2500, 2502), (2501, 2503)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_notpartitioned_pk",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 500,
                            },
                            "location": 41,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 501,
                            },
                            "location": 46,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1500,
                            },
                            "location": 53,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1501,
                            },
                            "location": 59,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2500,
                            },
                            "location": 69,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2502,
                            },
                            "location": 75,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2501,
                            },
                            "location": 83,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2503,
                            },
                            "location": 89,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1228 1`] = `
[
  "UPDATE fk_partitioned_fk SET a = a + 1 WHERE a = 2501",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "fk_partitioned_fk",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 29,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 33,
                        },
                      },
                      "location": 35,
                      "name": [
                        {
                          "String": {
                            "sval": "+",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 37,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 45,
                  },
                },
                "location": 47,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2501,
                    },
                    "location": 49,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1230 1`] = `
[
  "INSERT INTO fk_notpartitioned_pk (a,b) VALUES (2502, 2503)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 34,
                  "name": "a",
                },
              },
              {
                "ResTarget": {
                  "location": 36,
                  "name": "b",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_notpartitioned_pk",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2502,
                            },
                            "location": 47,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2503,
                            },
                            "location": 53,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1234 1`] = `
[
  "UPDATE fk_notpartitioned_pk SET b = 502 WHERE a = 500",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "fk_notpartitioned_pk",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 32,
                  "name": "b",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 502,
                      },
                      "location": 36,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 46,
                  },
                },
                "location": 48,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 500,
                    },
                    "location": 50,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1241 1`] = `
[
  "DROP TABLE fk_notpartitioned_pk, fk_partitioned_fk",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "fk_notpartitioned_pk",
                      },
                    },
                  ],
                },
              },
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "fk_partitioned_fk",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1245 1`] = `
[
  "CREATE TABLE fk_notpartitioned_pk (a INT, PRIMARY KEY(a), CHECK (a > 0))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk_notpartitioned_pk",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 35,
                  "typeName": {
                    "location": 37,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "a",
                      },
                    },
                  ],
                  "location": 42,
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_CHECK",
                  "initially_valid": true,
                  "location": 58,
                  "raw_expr": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 65,
                        },
                      },
                      "location": 67,
                      "name": [
                        {
                          "String": {
                            "sval": ">",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {},
                          "location": 69,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1256 1`] = `
[
  "CREATE TABLE fk_notpartitioned_pk (a int, b int, primary key (a, b))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk_notpartitioned_pk",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 35,
                  "typeName": {
                    "location": 37,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 42,
                  "typeName": {
                    "location": 44,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "a",
                      },
                    },
                    {
                      "String": {
                        "sval": "b",
                      },
                    },
                  ],
                  "location": 49,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1270 1`] = `
[
  "INSERT INTO fk_partitioned_fk_3 (a, b) VALUES (2502, NULL)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "cols": [
              {
                "ResTarget": {
                  "location": 33,
                  "name": "a",
                },
              },
              {
                "ResTarget": {
                  "location": 36,
                  "name": "b",
                },
              },
            ],
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_partitioned_fk_3",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2502,
                            },
                            "location": 47,
                          },
                        },
                        {
                          "A_Const": {
                            "isnull": true,
                            "location": 53,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1283 1`] = `
[
  "  -- fails
TRUNCATE fk_partitioned_fk_full",
  {
    "stmts": [
      {
        "stmt": {
          "TruncateStmt": {
            "behavior": "DROP_RESTRICT",
            "relations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 20,
                  "relname": "fk_partitioned_fk_full",
                  "relpersistence": "p",
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1286 1`] = `
[
  "  -- fails
DROP TABLE fk_partitioned_fk_full",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "fk_partitioned_fk_full",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1290 1`] = `
[
  "SELECT tableoid::regclass, a, b FROM fk_partitioned_fk WHERE b IS NULL ORDER BY a",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 37,
                  "relname": "fk_partitioned_fk",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 80,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "TypeCast": {
                      "arg": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "tableoid",
                              },
                            },
                          ],
                          "location": 7,
                        },
                      },
                      "location": 15,
                      "typeName": {
                        "location": 17,
                        "names": [
                          {
                            "String": {
                              "sval": "regclass",
                            },
                          },
                        ],
                        "typemod": -1,
                      },
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 27,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "location": 27,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 30,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "location": 30,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "NullTest": {
                "arg": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "b",
                        },
                      },
                    ],
                    "location": 61,
                  },
                },
                "location": 63,
                "nulltesttype": "IS_NULL",
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1295 1`] = `
[
  "INSERT INTO fk_partitioned_fk VALUES (2503, 2503)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_partitioned_fk",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2503,
                            },
                            "location": 38,
                          },
                        },
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2503,
                            },
                            "location": 44,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1301 1`] = `
[
  "ALTER TABLE fk_partitioned_fk DROP CONSTRAINT fk_partitioned_fk_a_b_fkey",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "name": "fk_partitioned_fk_a_b_fkey",
                  "subtype": "AT_DropConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_partitioned_fk",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1309 1`] = `
[
  "UPDATE fk_notpartitioned_pk SET a = 1500 WHERE a = 2502",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "fk_notpartitioned_pk",
              "relpersistence": "p",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 32,
                  "name": "a",
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 1500,
                      },
                      "location": 36,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 47,
                  },
                },
                "location": 49,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 2502,
                    },
                    "location": 51,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1348 1`] = `
[
  "SELECT * FROM fk_partitioned_fk WHERE b = 142857",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "fk_partitioned_fk",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "b",
                        },
                      },
                    ],
                    "location": 38,
                  },
                },
                "location": 40,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 142857,
                    },
                    "location": 42,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1351 1`] = `
[
  "SELECT * FROM fk_partitioned_fk WHERE a = 142857",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 14,
                  "relname": "fk_partitioned_fk",
                  "relpersistence": "p",
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 38,
                  },
                },
                "location": 40,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 142857,
                    },
                    "location": 42,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1354 1`] = `
[
  "DROP TABLE fk_partitioned_fk_2",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "fk_partitioned_fk_2",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1358 1`] = `
[
  "CREATE TABLE fk_partitioned_fk_2 PARTITION OF fk_partitioned_fk FOR VALUES IN (1500,1502)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "inhRelations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 46,
                  "relname": "fk_partitioned_fk",
                  "relpersistence": "p",
                },
              },
            ],
            "oncommit": "ONCOMMIT_NOOP",
            "partbound": {
              "listdatums": [
                {
                  "A_Const": {
                    "ival": {
                      "ival": 1500,
                    },
                    "location": 79,
                  },
                },
                {
                  "A_Const": {
                    "ival": {
                      "ival": 1502,
                    },
                    "location": 84,
                  },
                },
              ],
              "location": 75,
              "strategy": "l",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk_partitioned_fk_2",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1375 1`] = `
[
  "CREATE TABLE fk_partitioned_fk_4 (a int, b int, FOREIGN KEY (a, b) REFERENCES fk_notpartitioned_pk(a, b) ON UPDATE CASCADE ON DELETE CASCADE) PARTITION BY RANGE (b, a)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 142,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 162,
                    "name": "b",
                  },
                },
                {
                  "PartitionElem": {
                    "location": 165,
                    "name": "a",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_RANGE",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk_partitioned_fk_4",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 36,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 41,
                  "typeName": {
                    "location": 43,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "a",
                      },
                    },
                    {
                      "String": {
                        "sval": "b",
                      },
                    },
                  ],
                  "fk_del_action": "c",
                  "fk_matchtype": "s",
                  "fk_upd_action": "c",
                  "initially_valid": true,
                  "location": 48,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "a",
                      },
                    },
                    {
                      "String": {
                        "sval": "b",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 78,
                    "relname": "fk_notpartitioned_pk",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1408 1`] = `
[
  "CREATE TABLE fk_partitioned_fk_2 (a int, b int) PARTITION BY RANGE (b)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 48,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 68,
                    "name": "b",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_RANGE",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk_partitioned_fk_2",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 36,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 41,
                  "typeName": {
                    "location": 43,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1421 1`] = `
[
  "create role regress_other_partitioned_fk_owner",
  {
    "stmts": [
      {
        "stmt": {
          "CreateRoleStmt": {
            "role": "regress_other_partitioned_fk_owner",
            "stmt_type": "ROLESTMT_ROLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1428 1`] = `
[
  "  select 2048, x from generate_series(1,10) x",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "RangeFunction": {
                  "alias": {
                    "aliasname": "x",
                  },
                  "functions": [
                    {
                      "List": {
                        "items": [
                          {
                            "FuncCall": {
                              "args": [
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 1,
                                    },
                                    "location": 38,
                                  },
                                },
                                {
                                  "A_Const": {
                                    "ival": {
                                      "ival": 10,
                                    },
                                    "location": 40,
                                  },
                                },
                              ],
                              "funcformat": "COERCE_EXPLICIT_CALL",
                              "funcname": [
                                {
                                  "String": {
                                    "sval": "generate_series",
                                  },
                                },
                              ],
                              "location": 22,
                            },
                          },
                          {},
                        ],
                      },
                    },
                  ],
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "targetList": [
              {
                "ResTarget": {
                  "location": 9,
                  "val": {
                    "A_Const": {
                      "ival": {
                        "ival": 2048,
                      },
                      "location": 9,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 15,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "x",
                          },
                        },
                      ],
                      "location": 15,
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1430 1`] = `
[
  "alter table other_partitioned_fk add foreign key (a, b)
  references fk_notpartitioned_pk(a, b)",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 37,
                      "pk_attrs": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                        {
                          "String": {
                            "sval": "b",
                          },
                        },
                      ],
                      "pktable": {
                        "inh": true,
                        "location": 69,
                        "relname": "fk_notpartitioned_pk",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "other_partitioned_fk",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1433 1`] = `
[
  "reset role",
  {
    "stmts": [
      {
        "stmt": {
          "VariableSetStmt": {
            "kind": "VAR_RESET",
            "name": "role",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1440 1`] = `
[
  "drop table other_partitioned_fk",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "other_partitioned_fk",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1449 1`] = `
[
  "CREATE TABLE parted_self_fk (
    id bigint NOT NULL PRIMARY KEY,
    id_abc bigint,
    FOREIGN KEY (id_abc) REFERENCES parted_self_fk(id)
)
PARTITION BY RANGE (id)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 142,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 162,
                    "name": "id",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_RANGE",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "parted_self_fk",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "id",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_NOTNULL",
                        "location": 44,
                      },
                    },
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 53,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 34,
                  "typeName": {
                    "location": 37,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "id_abc",
                  "is_local": true,
                  "location": 70,
                  "typeName": {
                    "location": 77,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int8",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_FOREIGN",
                  "fk_attrs": [
                    {
                      "String": {
                        "sval": "id_abc",
                      },
                    },
                  ],
                  "fk_del_action": "a",
                  "fk_matchtype": "s",
                  "fk_upd_action": "a",
                  "initially_valid": true,
                  "location": 89,
                  "pk_attrs": [
                    {
                      "String": {
                        "sval": "id",
                      },
                    },
                  ],
                  "pktable": {
                    "inh": true,
                    "location": 121,
                    "relname": "parted_self_fk",
                    "relpersistence": "p",
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1473 1`] = `
[
  "SELECT cr.relname, co.conname, co.contype, co.convalidated,
       p.conname AS conparent, p.convalidated, cf.relname AS foreignrel
FROM pg_constraint co
JOIN pg_class cr ON cr.oid = co.conrelid
LEFT JOIN pg_class cf ON cf.oid = co.confrelid
LEFT JOIN pg_constraint p ON p.oid = co.conparentid
WHERE cr.oid IN (SELECT relid FROM pg_partition_tree('parted_self_fk'))
ORDER BY co.contype, cr.relname, co.conname, p.conname",
  {
    "stmts": [
      {
        "stmt": {
          "SelectStmt": {
            "fromClause": [
              {
                "JoinExpr": {
                  "jointype": "JOIN_LEFT",
                  "larg": {
                    "JoinExpr": {
                      "jointype": "JOIN_LEFT",
                      "larg": {
                        "JoinExpr": {
                          "jointype": "JOIN_INNER",
                          "larg": {
                            "RangeVar": {
                              "alias": {
                                "aliasname": "co",
                              },
                              "inh": true,
                              "location": 137,
                              "relname": "pg_constraint",
                              "relpersistence": "p",
                            },
                          },
                          "quals": {
                            "A_Expr": {
                              "kind": "AEXPR_OP",
                              "lexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "cr",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "oid",
                                      },
                                    },
                                  ],
                                  "location": 174,
                                },
                              },
                              "location": 181,
                              "name": [
                                {
                                  "String": {
                                    "sval": "=",
                                  },
                                },
                              ],
                              "rexpr": {
                                "ColumnRef": {
                                  "fields": [
                                    {
                                      "String": {
                                        "sval": "co",
                                      },
                                    },
                                    {
                                      "String": {
                                        "sval": "conrelid",
                                      },
                                    },
                                  ],
                                  "location": 183,
                                },
                              },
                            },
                          },
                          "rarg": {
                            "RangeVar": {
                              "alias": {
                                "aliasname": "cr",
                              },
                              "inh": true,
                              "location": 159,
                              "relname": "pg_class",
                              "relpersistence": "p",
                            },
                          },
                        },
                      },
                      "quals": {
                        "A_Expr": {
                          "kind": "AEXPR_OP",
                          "lexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "cf",
                                  },
                                },
                                {
                                  "String": {
                                    "sval": "oid",
                                  },
                                },
                              ],
                              "location": 220,
                            },
                          },
                          "location": 227,
                          "name": [
                            {
                              "String": {
                                "sval": "=",
                              },
                            },
                          ],
                          "rexpr": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "co",
                                  },
                                },
                                {
                                  "String": {
                                    "sval": "confrelid",
                                  },
                                },
                              ],
                              "location": 229,
                            },
                          },
                        },
                      },
                      "rarg": {
                        "RangeVar": {
                          "alias": {
                            "aliasname": "cf",
                          },
                          "inh": true,
                          "location": 205,
                          "relname": "pg_class",
                          "relpersistence": "p",
                        },
                      },
                    },
                  },
                  "quals": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "p",
                              },
                            },
                            {
                              "String": {
                                "sval": "oid",
                              },
                            },
                          ],
                          "location": 271,
                        },
                      },
                      "location": 277,
                      "name": [
                        {
                          "String": {
                            "sval": "=",
                          },
                        },
                      ],
                      "rexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "co",
                              },
                            },
                            {
                              "String": {
                                "sval": "conparentid",
                              },
                            },
                          ],
                          "location": 279,
                        },
                      },
                    },
                  },
                  "rarg": {
                    "RangeVar": {
                      "alias": {
                        "aliasname": "p",
                      },
                      "inh": true,
                      "location": 252,
                      "relname": "pg_constraint",
                      "relpersistence": "p",
                    },
                  },
                },
              },
            ],
            "limitOption": "LIMIT_OPTION_DEFAULT",
            "op": "SETOP_NONE",
            "sortClause": [
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "co",
                          },
                        },
                        {
                          "String": {
                            "sval": "contype",
                          },
                        },
                      ],
                      "location": 375,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "cr",
                          },
                        },
                        {
                          "String": {
                            "sval": "relname",
                          },
                        },
                      ],
                      "location": 387,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "co",
                          },
                        },
                        {
                          "String": {
                            "sval": "conname",
                          },
                        },
                      ],
                      "location": 399,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
              {
                "SortBy": {
                  "location": -1,
                  "node": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "p",
                          },
                        },
                        {
                          "String": {
                            "sval": "conname",
                          },
                        },
                      ],
                      "location": 411,
                    },
                  },
                  "sortby_dir": "SORTBY_DEFAULT",
                  "sortby_nulls": "SORTBY_NULLS_DEFAULT",
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 7,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "cr",
                          },
                        },
                        {
                          "String": {
                            "sval": "relname",
                          },
                        },
                      ],
                      "location": 7,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 19,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "co",
                          },
                        },
                        {
                          "String": {
                            "sval": "conname",
                          },
                        },
                      ],
                      "location": 19,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 31,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "co",
                          },
                        },
                        {
                          "String": {
                            "sval": "contype",
                          },
                        },
                      ],
                      "location": 31,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 43,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "co",
                          },
                        },
                        {
                          "String": {
                            "sval": "convalidated",
                          },
                        },
                      ],
                      "location": 43,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 67,
                  "name": "conparent",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "p",
                          },
                        },
                        {
                          "String": {
                            "sval": "conname",
                          },
                        },
                      ],
                      "location": 67,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 91,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "p",
                          },
                        },
                        {
                          "String": {
                            "sval": "convalidated",
                          },
                        },
                      ],
                      "location": 91,
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 107,
                  "name": "foreignrel",
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "String": {
                            "sval": "cf",
                          },
                        },
                        {
                          "String": {
                            "sval": "relname",
                          },
                        },
                      ],
                      "location": 107,
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "SubLink": {
                "location": 307,
                "subLinkType": "ANY_SUBLINK",
                "subselect": {
                  "SelectStmt": {
                    "fromClause": [
                      {
                        "RangeFunction": {
                          "functions": [
                            {
                              "List": {
                                "items": [
                                  {
                                    "FuncCall": {
                                      "args": [
                                        {
                                          "A_Const": {
                                            "location": 347,
                                            "sval": {
                                              "sval": "parted_self_fk",
                                            },
                                          },
                                        },
                                      ],
                                      "funcformat": "COERCE_EXPLICIT_CALL",
                                      "funcname": [
                                        {
                                          "String": {
                                            "sval": "pg_partition_tree",
                                          },
                                        },
                                      ],
                                      "location": 329,
                                    },
                                  },
                                  {},
                                ],
                              },
                            },
                          ],
                        },
                      },
                    ],
                    "limitOption": "LIMIT_OPTION_DEFAULT",
                    "op": "SETOP_NONE",
                    "targetList": [
                      {
                        "ResTarget": {
                          "location": 318,
                          "val": {
                            "ColumnRef": {
                              "fields": [
                                {
                                  "String": {
                                    "sval": "relid",
                                  },
                                },
                              ],
                              "location": 318,
                            },
                          },
                        },
                      },
                    ],
                  },
                },
                "testexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "cr",
                        },
                      },
                      {
                        "String": {
                          "sval": "oid",
                        },
                      },
                    ],
                    "location": 300,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1483 1`] = `
[
  "ALTER TABLE parted_self_fk DETACH PARTITION part2_self_fk",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "PartitionCmd": {
                      "name": {
                        "inh": true,
                        "location": 44,
                        "relname": "part2_self_fk",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_DetachPartition",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "parted_self_fk",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1503 1`] = `
[
  "create schema fkpart0
  create table pkey (a int primary key)
  create table fk_part (a int) partition by list (a)
  create table fk_part_1 partition of fk_part
      (foreign key (a) references fkpart0.pkey) for values in (1)
  create table fk_part_23 partition of fk_part
      (foreign key (a) references fkpart0.pkey) for values in (2, 3)
      partition by list (a)
  create table fk_part_23_2 partition of fk_part_23 for values in (2)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaElts": [
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 37,
                    "relname": "pkey",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 49,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 43,
                        "typeName": {
                          "location": 45,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 93,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 112,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 77,
                    "relname": "fk_part",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "is_local": true,
                        "location": 86,
                        "typeName": {
                          "location": 88,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 153,
                        "relname": "fk_part",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 224,
                        },
                      },
                    ],
                    "location": 220,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 130,
                    "relname": "fk_part_1",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 168,
                        "pktable": {
                          "inh": true,
                          "location": 195,
                          "relname": "pkey",
                          "relpersistence": "p",
                          "schemaname": "fkpart0",
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 266,
                        "relname": "fk_part",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 337,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 3,
                          },
                          "location": 340,
                        },
                      },
                    ],
                    "location": 333,
                    "strategy": "l",
                  },
                  "partspec": {
                    "location": 349,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 368,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 242,
                    "relname": "fk_part_23",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 281,
                        "pktable": {
                          "inh": true,
                          "location": 308,
                          "relname": "pkey",
                          "relpersistence": "p",
                          "schemaname": "fkpart0",
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 412,
                        "relname": "fk_part_23",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 438,
                        },
                      },
                    ],
                    "location": 434,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 386,
                    "relname": "fk_part_23_2",
                    "relpersistence": "p",
                  },
                },
              },
            ],
            "schemaname": "fkpart0",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1513 1`] = `
[
  "alter table fkpart0.fk_part add foreign key (a) references fkpart0.pkey",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "contype": "CONSTR_FOREIGN",
                      "fk_attrs": [
                        {
                          "String": {
                            "sval": "a",
                          },
                        },
                      ],
                      "fk_del_action": "a",
                      "fk_matchtype": "s",
                      "fk_upd_action": "a",
                      "initially_valid": true,
                      "location": 32,
                      "pktable": {
                        "inh": true,
                        "location": 59,
                        "relname": "pkey",
                        "relpersistence": "p",
                        "schemaname": "fkpart0",
                      },
                    },
                  },
                  "subtype": "AT_AddConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_part",
              "relpersistence": "p",
              "schemaname": "fkpart0",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1515 1`] = `
[
  "alter table fkpart0.fk_part_1 drop constraint fk_part_1_a_fkey",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "name": "fk_part_1_a_fkey",
                  "subtype": "AT_DropConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_part_1",
              "relpersistence": "p",
              "schemaname": "fkpart0",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1522 1`] = `
[
  "create table fkpart0.fk_part_4 partition of fkpart0.fk_part for values in (4)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "inhRelations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 44,
                  "relname": "fk_part",
                  "relpersistence": "p",
                  "schemaname": "fkpart0",
                },
              },
            ],
            "oncommit": "ONCOMMIT_NOOP",
            "partbound": {
              "listdatums": [
                {
                  "A_Const": {
                    "ival": {
                      "ival": 4,
                    },
                    "location": 75,
                  },
                },
              ],
              "location": 71,
              "strategy": "l",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk_part_4",
              "relpersistence": "p",
              "schemaname": "fkpart0",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1524 1`] = `
[
  "alter table fkpart0.fk_part_4 drop constraint fk_part_a_fkey",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "name": "fk_part_a_fkey",
                  "subtype": "AT_DropConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_part_4",
              "relpersistence": "p",
              "schemaname": "fkpart0",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1526 1`] = `
[
  "create table fkpart0.fk_part_56 partition of fkpart0.fk_part
    for values in (5,6) partition by list (a)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "inhRelations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 45,
                  "relname": "fk_part",
                  "relpersistence": "p",
                  "schemaname": "fkpart0",
                },
              },
            ],
            "oncommit": "ONCOMMIT_NOOP",
            "partbound": {
              "listdatums": [
                {
                  "A_Const": {
                    "ival": {
                      "ival": 5,
                    },
                    "location": 80,
                  },
                },
                {
                  "A_Const": {
                    "ival": {
                      "ival": 6,
                    },
                    "location": 82,
                  },
                },
              ],
              "location": 76,
              "strategy": "l",
            },
            "partspec": {
              "location": 85,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 104,
                    "name": "a",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_LIST",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk_part_56",
              "relpersistence": "p",
              "schemaname": "fkpart0",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1531 1`] = `
[
  "alter table fkpart0.fk_part_56 drop constraint fk_part_a_fkey",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "name": "fk_part_a_fkey",
                  "subtype": "AT_DropConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk_part_56",
              "relpersistence": "p",
              "schemaname": "fkpart0",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1536 1`] = `
[
  "create schema fkpart1
  create table pkey (a int primary key)
  create table fk_part (a int) partition by list (a)
  create table fk_part_1 partition of fk_part for values in (1) partition by list (a)
  create table fk_part_1_1 partition of fk_part_1 for values in (1)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaElts": [
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 37,
                    "relname": "pkey",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 49,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 43,
                        "typeName": {
                          "location": 45,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 93,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 112,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 77,
                    "relname": "fk_part",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "is_local": true,
                        "location": 86,
                        "typeName": {
                          "location": 88,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 153,
                        "relname": "fk_part",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 176,
                        },
                      },
                    ],
                    "location": 172,
                    "strategy": "l",
                  },
                  "partspec": {
                    "location": 179,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 198,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 130,
                    "relname": "fk_part_1",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 241,
                        "relname": "fk_part_1",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 266,
                        },
                      },
                    ],
                    "location": 262,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 216,
                    "relname": "fk_part_1_1",
                    "relpersistence": "p",
                  },
                },
              },
            ],
            "schemaname": "fkpart1",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1542 1`] = `
[
  "		-- should fail
insert into fkpart1.pkey values (1)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 29,
              "relname": "pkey",
              "relpersistence": "p",
              "schemaname": "fkpart1",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 50,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1545 1`] = `
[
  "		-- should fail
alter table fkpart1.fk_part detach partition fkpart1.fk_part_1",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "PartitionCmd": {
                      "name": {
                        "inh": true,
                        "location": 62,
                        "relname": "fk_part_1",
                        "relpersistence": "p",
                        "schemaname": "fkpart1",
                      },
                    },
                  },
                  "subtype": "AT_DetachPartition",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 29,
              "relname": "fk_part",
              "relpersistence": "p",
              "schemaname": "fkpart1",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1548 1`] = `
[
  "	-- should fail
delete from fkpart1.pkey where a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "pkey",
              "relpersistence": "p",
              "schemaname": "fkpart1",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 47,
                  },
                },
                "location": 49,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 51,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1553 1`] = `
[
  "create schema fkpart2
  create table pkey (a int primary key)
  create table fk_part (a int, constraint fkey foreign key (a) references fkpart2.pkey) partition by list (a)
  create table fk_part_1 partition of fkpart2.fk_part for values in (1) partition by list (a)
  create table fk_part_1_1 (a int, constraint my_fkey foreign key (a) references fkpart2.pkey)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaElts": [
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 37,
                    "relname": "pkey",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 49,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 43,
                        "typeName": {
                          "location": 45,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 150,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 169,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 77,
                    "relname": "fk_part",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "is_local": true,
                        "location": 86,
                        "typeName": {
                          "location": 88,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                    {
                      "Constraint": {
                        "conname": "fkey",
                        "contype": "CONSTR_FOREIGN",
                        "fk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 93,
                        "pktable": {
                          "inh": true,
                          "location": 136,
                          "relname": "pkey",
                          "relpersistence": "p",
                          "schemaname": "fkpart2",
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 210,
                        "relname": "fk_part",
                        "relpersistence": "p",
                        "schemaname": "fkpart2",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 241,
                        },
                      },
                    ],
                    "location": 237,
                    "strategy": "l",
                  },
                  "partspec": {
                    "location": 244,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 263,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 187,
                    "relname": "fk_part_1",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 281,
                    "relname": "fk_part_1_1",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "is_local": true,
                        "location": 294,
                        "typeName": {
                          "location": 296,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                    {
                      "Constraint": {
                        "conname": "my_fkey",
                        "contype": "CONSTR_FOREIGN",
                        "fk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 301,
                        "pktable": {
                          "inh": true,
                          "location": 347,
                          "relname": "pkey",
                          "relpersistence": "p",
                          "schemaname": "fkpart2",
                        },
                      },
                    },
                  ],
                },
              },
            ],
            "schemaname": "fkpart2",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1559 1`] = `
[
  "	-- should fail
alter table fkpart2.fk_part_1_1 drop constraint my_fkey",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "name": "my_fkey",
                  "subtype": "AT_DropConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "fk_part_1_1",
              "relpersistence": "p",
              "schemaname": "fkpart2",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1560 1`] = `
[
  "	-- should fail
alter table fkpart2.fk_part detach partition fkpart2.fk_part_1",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "PartitionCmd": {
                      "name": {
                        "inh": true,
                        "location": 61,
                        "relname": "fk_part_1",
                        "relpersistence": "p",
                        "schemaname": "fkpart2",
                      },
                    },
                  },
                  "subtype": "AT_DetachPartition",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 28,
              "relname": "fk_part",
              "relpersistence": "p",
              "schemaname": "fkpart2",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1563 1`] = `
[
  "	-- doesn't exist

-- verify constraint deferrability
create schema fkpart3
  create table pkey (a int primary key)
  create table fk_part (a int, constraint fkey foreign key (a) references fkpart3.pkey deferrable initially immediate) partition by list (a)
  create table fk_part_1 partition of fkpart3.fk_part for values in (1) partition by list (a)
  create table fk_part_1_1 partition of fkpart3.fk_part_1 for values in (1)
  create table fk_part_2 partition of fkpart3.fk_part for values in (2)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaElts": [
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 91,
                    "relname": "pkey",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 103,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 97,
                        "typeName": {
                          "location": 99,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 235,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 254,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 131,
                    "relname": "fk_part",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "is_local": true,
                        "location": 140,
                        "typeName": {
                          "location": 142,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                    {
                      "Constraint": {
                        "conname": "fkey",
                        "contype": "CONSTR_FOREIGN",
                        "deferrable": true,
                        "fk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 147,
                        "pktable": {
                          "inh": true,
                          "location": 190,
                          "relname": "pkey",
                          "relpersistence": "p",
                          "schemaname": "fkpart3",
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 295,
                        "relname": "fk_part",
                        "relpersistence": "p",
                        "schemaname": "fkpart3",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 326,
                        },
                      },
                    ],
                    "location": 322,
                    "strategy": "l",
                  },
                  "partspec": {
                    "location": 329,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 348,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 272,
                    "relname": "fk_part_1",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 391,
                        "relname": "fk_part_1",
                        "relpersistence": "p",
                        "schemaname": "fkpart3",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 424,
                        },
                      },
                    ],
                    "location": 420,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 366,
                    "relname": "fk_part_1_1",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 465,
                        "relname": "fk_part",
                        "relpersistence": "p",
                        "schemaname": "fkpart3",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 496,
                        },
                      },
                    ],
                    "location": 492,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 442,
                    "relname": "fk_part_2",
                    "relpersistence": "p",
                  },
                },
              },
            ],
            "schemaname": "fkpart3",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1583 1`] = `
[
  "drop schema fkpart0, fkpart1, fkpart2, fkpart3 cascade",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "String": {
                  "sval": "fkpart0",
                },
              },
              {
                "String": {
                  "sval": "fkpart1",
                },
              },
              {
                "String": {
                  "sval": "fkpart2",
                },
              },
              {
                "String": {
                  "sval": "fkpart3",
                },
              },
            ],
            "removeType": "OBJECT_SCHEMA",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1590 1`] = `
[
  "CREATE SCHEMA fkpart3",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaname": "fkpart3",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1593 1`] = `
[
  "CREATE TABLE pk (a int PRIMARY KEY) PARTITION BY RANGE (a)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 36,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 56,
                    "name": "a",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_RANGE",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pk",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 23,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 17,
                  "typeName": {
                    "location": 19,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1600 1`] = `
[
  "CREATE TABLE fk (a int) PARTITION BY RANGE (a)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 24,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 44,
                    "name": "a",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_RANGE",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "is_local": true,
                  "location": 17,
                  "typeName": {
                    "location": 19,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1607 1`] = `
[
  "CREATE TABLE pk3 PARTITION OF pk FOR VALUES FROM (2000) TO (3000)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "inhRelations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 30,
                  "relname": "pk",
                  "relpersistence": "p",
                },
              },
            ],
            "oncommit": "ONCOMMIT_NOOP",
            "partbound": {
              "location": 44,
              "lowerdatums": [
                {
                  "A_Const": {
                    "ival": {
                      "ival": 2000,
                    },
                    "location": 50,
                  },
                },
              ],
              "strategy": "r",
              "upperdatums": [
                {
                  "A_Const": {
                    "ival": {
                      "ival": 3000,
                    },
                    "location": 60,
                  },
                },
              ],
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pk3",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1611 1`] = `
[
  "CREATE TABLE pk5 (c int, b int, a int NOT NULL) PARTITION BY RANGE (a)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 48,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 68,
                    "name": "a",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_RANGE",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pk5",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "c",
                  "is_local": true,
                  "location": 18,
                  "typeName": {
                    "location": 20,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "b",
                  "is_local": true,
                  "location": 25,
                  "typeName": {
                    "location": 27,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "a",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_NOTNULL",
                        "location": 38,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 32,
                  "typeName": {
                    "location": 34,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1617 1`] = `
[
  "CREATE TABLE fk3 PARTITION OF fk FOR VALUES FROM (3500) TO (5000)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "inhRelations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 30,
                  "relname": "fk",
                  "relpersistence": "p",
                },
              },
            ],
            "oncommit": "ONCOMMIT_NOOP",
            "partbound": {
              "location": 44,
              "lowerdatums": [
                {
                  "A_Const": {
                    "ival": {
                      "ival": 3500,
                    },
                    "location": 50,
                  },
                },
              ],
              "strategy": "r",
              "upperdatums": [
                {
                  "A_Const": {
                    "ival": {
                      "ival": 5000,
                    },
                    "location": 60,
                  },
                },
              ],
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "fk3",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1620 1`] = `
[
  "INSERT into fk VALUES (1)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 23,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1627 1`] = `
[
  "INSERT into pk VALUES (1), (1000), (2000), (3000), (4000), (4500)",
  {
    "stmts": [
      {
        "stmt": {
          "InsertStmt": {
            "override": "OVERRIDING_NOT_SET",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pk",
              "relpersistence": "p",
            },
            "selectStmt": {
              "SelectStmt": {
                "limitOption": "LIMIT_OPTION_DEFAULT",
                "op": "SETOP_NONE",
                "valuesLists": [
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1,
                            },
                            "location": 23,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 1000,
                            },
                            "location": 28,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 2000,
                            },
                            "location": 36,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 3000,
                            },
                            "location": 44,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 4000,
                            },
                            "location": 52,
                          },
                        },
                      ],
                    },
                  },
                  {
                    "List": {
                      "items": [
                        {
                          "A_Const": {
                            "ival": {
                              "ival": 4500,
                            },
                            "location": 60,
                          },
                        },
                      ],
                    },
                  },
                ],
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1631 1`] = `
[
  "DELETE FROM pk WHERE a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "pk",
              "relpersistence": "p",
            },
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 21,
                  },
                },
                "location": 23,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 25,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1644 1`] = `
[
  "DELETE FROM fk",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1658 1`] = `
[
  "CREATE SCHEMA fkpart4",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaname": "fkpart4",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1662 1`] = `
[
  "CREATE TABLE droppk (a int PRIMARY KEY) PARTITION BY RANGE (a)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 40,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 60,
                    "name": "a",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_RANGE",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "droppk",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "a",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_PRIMARY",
                        "location": 27,
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 21,
                  "typeName": {
                    "location": 23,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1673 1`] = `
[
  "ALTER TABLE droppk DETACH PARTITION droppk_d",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "PartitionCmd": {
                      "name": {
                        "inh": true,
                        "location": 36,
                        "relname": "droppk_d",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_DetachPartition",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "droppk",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1679 1`] = `
[
  "DROP TABLE droppk_d",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_RESTRICT",
            "objects": [
              {
                "List": {
                  "items": [
                    {
                      "String": {
                        "sval": "droppk_d",
                      },
                    },
                  ],
                },
              },
            ],
            "removeType": "OBJECT_TABLE",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1690 1`] = `
[
  "ALTER TABLE droppk2 DETACH PARTITION droppk21",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "PartitionCmd": {
                      "name": {
                        "inh": true,
                        "location": 37,
                        "relname": "droppk21",
                        "relpersistence": "p",
                      },
                    },
                  },
                  "subtype": "AT_DetachPartition",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "droppk2",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1694 1`] = `
[
  "CREATE SCHEMA fkpart5",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaname": "fkpart5",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1724 1`] = `
[
  "CREATE SCHEMA fkpart9",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaname": "fkpart9",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1745 1`] = `
[
  "							-- OK

-- Verify constraint deferrability when changed by ALTER
-- Partitioned table at referencing end
CREATE TABLE pt(f1 int, f2 int, f3 int, PRIMARY KEY(f1,f2))",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 124,
              "relname": "pt",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "f1",
                  "is_local": true,
                  "location": 127,
                  "typeName": {
                    "location": 130,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "f2",
                  "is_local": true,
                  "location": 135,
                  "typeName": {
                    "location": 138,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "f3",
                  "is_local": true,
                  "location": 143,
                  "typeName": {
                    "location": 146,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "f1",
                      },
                    },
                    {
                      "String": {
                        "sval": "f2",
                      },
                    },
                  ],
                  "location": 151,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1776 1`] = `
[
  "	-- fails
ALTER TABLE ref ALTER CONSTRAINT ref_f1_f2_fkey
  DEFERRABLE INITIALLY DEFERRED",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "def": {
                    "Constraint": {
                      "conname": "ref_f1_f2_fkey",
                      "contype": "CONSTR_FOREIGN",
                      "deferrable": true,
                      "initdeferred": true,
                    },
                  },
                  "subtype": "AT_AlterConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 22,
              "relname": "ref",
              "relpersistence": "p",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1786 1`] = `
[
  "CREATE TABLE pt(f1 int, f2 int, f3 int, PRIMARY KEY(f1,f2))
  PARTITION BY LIST(f1)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "partspec": {
              "location": 62,
              "partParams": [
                {
                  "PartitionElem": {
                    "location": 80,
                    "name": "f1",
                  },
                },
              ],
              "strategy": "PARTITION_STRATEGY_LIST",
            },
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "pt",
              "relpersistence": "p",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "f1",
                  "is_local": true,
                  "location": 16,
                  "typeName": {
                    "location": 19,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "f2",
                  "is_local": true,
                  "location": 24,
                  "typeName": {
                    "location": 27,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "ColumnDef": {
                  "colname": "f3",
                  "is_local": true,
                  "location": 32,
                  "typeName": {
                    "location": 35,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
              {
                "Constraint": {
                  "contype": "CONSTR_PRIMARY",
                  "keys": [
                    {
                      "String": {
                        "sval": "f1",
                      },
                    },
                    {
                      "String": {
                        "sval": "f2",
                      },
                    },
                  ],
                  "location": 40,
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1821 1`] = `
[
  "DROP SCHEMA fkpart9 CASCADE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "String": {
                  "sval": "fkpart9",
                },
              },
            ],
            "removeType": "OBJECT_SCHEMA",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1824 1`] = `
[
  "CREATE SCHEMA fkpart6",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaname": "fkpart6",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1844 1`] = `
[
  "TRUNCATE TABLE pk",
  {
    "stmts": [
      {
        "stmt": {
          "TruncateStmt": {
            "behavior": "DROP_RESTRICT",
            "relations": [
              {
                "RangeVar": {
                  "inh": true,
                  "location": 15,
                  "relname": "pk",
                  "relpersistence": "p",
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1888 1`] = `
[
  "CREATE SCHEMA fkpart7
  CREATE TABLE pkpart (a int) PARTITION BY LIST (a)
  CREATE TABLE pkpart1 PARTITION OF pkpart FOR VALUES IN (1)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaElts": [
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 52,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 71,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 37,
                    "relname": "pkpart",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "is_local": true,
                        "location": 45,
                        "typeName": {
                          "location": 47,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 110,
                        "relname": "pkpart",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 132,
                        },
                      },
                    ],
                    "location": 128,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 89,
                    "relname": "pkpart1",
                    "relpersistence": "p",
                  },
                },
              },
            ],
            "schemaname": "fkpart7",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1897 1`] = `
[
  "CREATE SCHEMA fkpart8
  CREATE TABLE tbl1(f1 int PRIMARY KEY)
  CREATE TABLE tbl2(f1 int REFERENCES tbl1 DEFERRABLE INITIALLY DEFERRED) PARTITION BY RANGE(f1)
  CREATE TABLE tbl2_p1 PARTITION OF tbl2 FOR VALUES FROM (minvalue) TO (maxvalue)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaElts": [
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 37,
                    "relname": "tbl1",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "f1",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 49,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 42,
                        "typeName": {
                          "location": 45,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 136,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 155,
                          "name": "f1",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_RANGE",
                  },
                  "relation": {
                    "inh": true,
                    "location": 77,
                    "relname": "tbl2",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "f1",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_FOREIGN",
                              "fk_del_action": "a",
                              "fk_matchtype": "s",
                              "fk_upd_action": "a",
                              "initially_valid": true,
                              "location": 89,
                              "pktable": {
                                "inh": true,
                                "location": 100,
                                "relname": "tbl1",
                                "relpersistence": "p",
                              },
                            },
                          },
                          {
                            "Constraint": {
                              "contype": "CONSTR_ATTR_DEFERRABLE",
                              "location": 105,
                            },
                          },
                          {
                            "Constraint": {
                              "contype": "CONSTR_ATTR_DEFERRED",
                              "location": 116,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 82,
                        "typeName": {
                          "location": 85,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 195,
                        "relname": "tbl2",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "location": 211,
                    "lowerdatums": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "minvalue",
                              },
                            },
                          ],
                          "location": 217,
                        },
                      },
                    ],
                    "strategy": "r",
                    "upperdatums": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "maxvalue",
                              },
                            },
                          ],
                          "location": 231,
                        },
                      },
                    ],
                  },
                  "relation": {
                    "inh": true,
                    "location": 174,
                    "relname": "tbl2_p1",
                    "relpersistence": "p",
                  },
                },
              },
            ],
            "schemaname": "fkpart8",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1910 1`] = `
[
  "CREATE SCHEMA fkpart9
  CREATE TABLE pk (a INT PRIMARY KEY) PARTITION BY RANGE (a)
  CREATE TABLE fk (
    fk_a INT REFERENCES pk(a) ON DELETE CASCADE
  )
  CREATE TABLE pk1 PARTITION OF pk FOR VALUES FROM (30) TO (50) PARTITION BY RANGE (a)
  CREATE TABLE pk11 PARTITION OF pk1 FOR VALUES FROM (30) TO (40)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaElts": [
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 60,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 80,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_RANGE",
                  },
                  "relation": {
                    "inh": true,
                    "location": 37,
                    "relname": "pk",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 47,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 41,
                        "typeName": {
                          "location": 43,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 98,
                    "relname": "fk",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "fk_a",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_FOREIGN",
                              "fk_del_action": "c",
                              "fk_matchtype": "s",
                              "fk_upd_action": "a",
                              "initially_valid": true,
                              "location": 116,
                              "pk_attrs": [
                                {
                                  "String": {
                                    "sval": "a",
                                  },
                                },
                              ],
                              "pktable": {
                                "inh": true,
                                "location": 127,
                                "relname": "pk",
                                "relpersistence": "p",
                              },
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 107,
                        "typeName": {
                          "location": 112,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 187,
                        "relname": "pk",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "location": 201,
                    "lowerdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 30,
                          },
                          "location": 207,
                        },
                      },
                    ],
                    "strategy": "r",
                    "upperdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 50,
                          },
                          "location": 215,
                        },
                      },
                    ],
                  },
                  "partspec": {
                    "location": 219,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 239,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_RANGE",
                  },
                  "relation": {
                    "inh": true,
                    "location": 170,
                    "relname": "pk1",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 275,
                        "relname": "pk1",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "location": 290,
                    "lowerdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 30,
                          },
                          "location": 296,
                        },
                      },
                    ],
                    "strategy": "r",
                    "upperdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 40,
                          },
                          "location": 304,
                        },
                      },
                    ],
                  },
                  "relation": {
                    "inh": true,
                    "location": 257,
                    "relname": "pk11",
                    "relpersistence": "p",
                  },
                },
              },
            ],
            "schemaname": "fkpart9",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1926 1`] = `
[
  "CREATE SCHEMA fkpart10
  CREATE TABLE tbl1(f1 int PRIMARY KEY) PARTITION BY RANGE(f1)
  CREATE TABLE tbl1_p1 PARTITION OF tbl1 FOR VALUES FROM (minvalue) TO (1)
  CREATE TABLE tbl1_p2 PARTITION OF tbl1 FOR VALUES FROM (1) TO (maxvalue)
  CREATE TABLE tbl2(f1 int REFERENCES tbl1 DEFERRABLE INITIALLY DEFERRED)
  CREATE TABLE tbl3(f1 int PRIMARY KEY) PARTITION BY RANGE(f1)
  CREATE TABLE tbl3_p1 PARTITION OF tbl3 FOR VALUES FROM (minvalue) TO (1)
  CREATE TABLE tbl3_p2 PARTITION OF tbl3 FOR VALUES FROM (1) TO (maxvalue)
  CREATE TABLE tbl4(f1 int REFERENCES tbl3 DEFERRABLE INITIALLY DEFERRED)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaElts": [
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 63,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 82,
                          "name": "f1",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_RANGE",
                  },
                  "relation": {
                    "inh": true,
                    "location": 38,
                    "relname": "tbl1",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "f1",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 50,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 43,
                        "typeName": {
                          "location": 46,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 122,
                        "relname": "tbl1",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "location": 138,
                    "lowerdatums": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "minvalue",
                              },
                            },
                          ],
                          "location": 144,
                        },
                      },
                    ],
                    "strategy": "r",
                    "upperdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 158,
                        },
                      },
                    ],
                  },
                  "relation": {
                    "inh": true,
                    "location": 101,
                    "relname": "tbl1_p1",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 197,
                        "relname": "tbl1",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "location": 213,
                    "lowerdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 219,
                        },
                      },
                    ],
                    "strategy": "r",
                    "upperdatums": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "maxvalue",
                              },
                            },
                          ],
                          "location": 226,
                        },
                      },
                    ],
                  },
                  "relation": {
                    "inh": true,
                    "location": 176,
                    "relname": "tbl1_p2",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 251,
                    "relname": "tbl2",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "f1",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_FOREIGN",
                              "fk_del_action": "a",
                              "fk_matchtype": "s",
                              "fk_upd_action": "a",
                              "initially_valid": true,
                              "location": 263,
                              "pktable": {
                                "inh": true,
                                "location": 274,
                                "relname": "tbl1",
                                "relpersistence": "p",
                              },
                            },
                          },
                          {
                            "Constraint": {
                              "contype": "CONSTR_ATTR_DEFERRABLE",
                              "location": 279,
                            },
                          },
                          {
                            "Constraint": {
                              "contype": "CONSTR_ATTR_DEFERRED",
                              "location": 290,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 256,
                        "typeName": {
                          "location": 259,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 350,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 369,
                          "name": "f1",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_RANGE",
                  },
                  "relation": {
                    "inh": true,
                    "location": 325,
                    "relname": "tbl3",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "f1",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 337,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 330,
                        "typeName": {
                          "location": 333,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 409,
                        "relname": "tbl3",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "location": 425,
                    "lowerdatums": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "minvalue",
                              },
                            },
                          ],
                          "location": 431,
                        },
                      },
                    ],
                    "strategy": "r",
                    "upperdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 445,
                        },
                      },
                    ],
                  },
                  "relation": {
                    "inh": true,
                    "location": 388,
                    "relname": "tbl3_p1",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 484,
                        "relname": "tbl3",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "location": 500,
                    "lowerdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 506,
                        },
                      },
                    ],
                    "strategy": "r",
                    "upperdatums": [
                      {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "maxvalue",
                              },
                            },
                          ],
                          "location": 513,
                        },
                      },
                    ],
                  },
                  "relation": {
                    "inh": true,
                    "location": 463,
                    "relname": "tbl3_p2",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 538,
                    "relname": "tbl4",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "f1",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_FOREIGN",
                              "fk_del_action": "a",
                              "fk_matchtype": "s",
                              "fk_upd_action": "a",
                              "initially_valid": true,
                              "location": 550,
                              "pktable": {
                                "inh": true,
                                "location": 561,
                                "relname": "tbl3",
                                "relpersistence": "p",
                              },
                            },
                          },
                          {
                            "Constraint": {
                              "contype": "CONSTR_ATTR_DEFERRABLE",
                              "location": 566,
                            },
                          },
                          {
                            "Constraint": {
                              "contype": "CONSTR_ATTR_DEFERRED",
                              "location": 577,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 543,
                        "typeName": {
                          "location": 546,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
            ],
            "schemaname": "fkpart10",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1969 1`] = `
[
  "CREATE TABLE fkpart10.tbl5(f1 int REFERENCES fkpart10.tbl3)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateStmt": {
            "oncommit": "ONCOMMIT_NOOP",
            "relation": {
              "inh": true,
              "location": 13,
              "relname": "tbl5",
              "relpersistence": "p",
              "schemaname": "fkpart10",
            },
            "tableElts": [
              {
                "ColumnDef": {
                  "colname": "f1",
                  "constraints": [
                    {
                      "Constraint": {
                        "contype": "CONSTR_FOREIGN",
                        "fk_del_action": "a",
                        "fk_matchtype": "s",
                        "fk_upd_action": "a",
                        "initially_valid": true,
                        "location": 34,
                        "pktable": {
                          "inh": true,
                          "location": 45,
                          "relname": "tbl3",
                          "relpersistence": "p",
                          "schemaname": "fkpart10",
                        },
                      },
                    },
                  ],
                  "is_local": true,
                  "location": 27,
                  "typeName": {
                    "location": 30,
                    "names": [
                      {
                        "String": {
                          "sval": "pg_catalog",
                        },
                      },
                      {
                        "String": {
                          "sval": "int4",
                        },
                      },
                    ],
                    "typemod": -1,
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1978 1`] = `
[
  "DELETE FROM fkpart10.tbl5",
  {
    "stmts": [
      {
        "stmt": {
          "DeleteStmt": {
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "tbl5",
              "relpersistence": "p",
              "schemaname": "fkpart10",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1984 1`] = `
[
  "DROP SCHEMA fkpart10 CASCADE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "String": {
                  "sval": "fkpart10",
                },
              },
            ],
            "removeType": "OBJECT_SCHEMA",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 1988 1`] = `
[
  "CREATE SCHEMA fkpart11
  CREATE TABLE pk (a INT PRIMARY KEY, b text) PARTITION BY LIST (a)
  CREATE TABLE fk (
    a INT,
    CONSTRAINT fkey FOREIGN KEY (a) REFERENCES pk(a) ON UPDATE CASCADE ON DELETE CASCADE
  )
  CREATE TABLE fk_parted (
    a INT PRIMARY KEY,
    CONSTRAINT fkey FOREIGN KEY (a) REFERENCES pk(a) ON UPDATE CASCADE ON DELETE CASCADE
  ) PARTITION BY LIST (a)
  CREATE TABLE fk_another (
    a INT,
    CONSTRAINT fkey FOREIGN KEY (a) REFERENCES fk_parted (a) ON UPDATE CASCADE ON DELETE CASCADE
  )
  CREATE TABLE pk1 PARTITION OF pk FOR VALUES IN (1, 2) PARTITION BY LIST (a)
  CREATE TABLE pk2 PARTITION OF pk FOR VALUES IN (3)
  CREATE TABLE pk3 PARTITION OF pk FOR VALUES IN (4)
  CREATE TABLE fk1 PARTITION OF fk_parted FOR VALUES IN (1, 2)
  CREATE TABLE fk2 PARTITION OF fk_parted FOR VALUES IN (3)
  CREATE TABLE fk3 PARTITION OF fk_parted FOR VALUES IN (4)",
  {
    "stmts": [
      {
        "stmt": {
          "CreateSchemaStmt": {
            "schemaElts": [
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 69,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 88,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 38,
                    "relname": "pk",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 48,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 42,
                        "typeName": {
                          "location": 44,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                    {
                      "ColumnDef": {
                        "colname": "b",
                        "is_local": true,
                        "location": 61,
                        "typeName": {
                          "location": 63,
                          "names": [
                            {
                              "String": {
                                "sval": "text",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 106,
                    "relname": "fk",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "is_local": true,
                        "location": 115,
                        "typeName": {
                          "location": 117,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                    {
                      "Constraint": {
                        "conname": "fkey",
                        "contype": "CONSTR_FOREIGN",
                        "fk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "fk_del_action": "c",
                        "fk_matchtype": "s",
                        "fk_upd_action": "c",
                        "initially_valid": true,
                        "location": 126,
                        "pk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "pktable": {
                          "inh": true,
                          "location": 169,
                          "relname": "pk",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "partspec": {
                    "location": 358,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 377,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 230,
                    "relname": "fk_parted",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "constraints": [
                          {
                            "Constraint": {
                              "contype": "CONSTR_PRIMARY",
                              "location": 252,
                            },
                          },
                        ],
                        "is_local": true,
                        "location": 246,
                        "typeName": {
                          "location": 248,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                    {
                      "Constraint": {
                        "conname": "fkey",
                        "contype": "CONSTR_FOREIGN",
                        "fk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "fk_del_action": "c",
                        "fk_matchtype": "s",
                        "fk_upd_action": "c",
                        "initially_valid": true,
                        "location": 269,
                        "pk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "pktable": {
                          "inh": true,
                          "location": 312,
                          "relname": "pk",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "oncommit": "ONCOMMIT_NOOP",
                  "relation": {
                    "inh": true,
                    "location": 395,
                    "relname": "fk_another",
                    "relpersistence": "p",
                  },
                  "tableElts": [
                    {
                      "ColumnDef": {
                        "colname": "a",
                        "is_local": true,
                        "location": 412,
                        "typeName": {
                          "location": 414,
                          "names": [
                            {
                              "String": {
                                "sval": "pg_catalog",
                              },
                            },
                            {
                              "String": {
                                "sval": "int4",
                              },
                            },
                          ],
                          "typemod": -1,
                        },
                      },
                    },
                    {
                      "Constraint": {
                        "conname": "fkey",
                        "contype": "CONSTR_FOREIGN",
                        "fk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "fk_del_action": "c",
                        "fk_matchtype": "s",
                        "fk_upd_action": "c",
                        "initially_valid": true,
                        "location": 423,
                        "pk_attrs": [
                          {
                            "String": {
                              "sval": "a",
                            },
                          },
                        ],
                        "pktable": {
                          "inh": true,
                          "location": 466,
                          "relname": "fk_parted",
                          "relpersistence": "p",
                        },
                      },
                    },
                  ],
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 552,
                        "relname": "pk",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 570,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 573,
                        },
                      },
                    ],
                    "location": 566,
                    "strategy": "l",
                  },
                  "partspec": {
                    "location": 576,
                    "partParams": [
                      {
                        "PartitionElem": {
                          "location": 595,
                          "name": "a",
                        },
                      },
                    ],
                    "strategy": "PARTITION_STRATEGY_LIST",
                  },
                  "relation": {
                    "inh": true,
                    "location": 535,
                    "relname": "pk1",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 630,
                        "relname": "pk",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 3,
                          },
                          "location": 648,
                        },
                      },
                    ],
                    "location": 644,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 613,
                    "relname": "pk2",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 683,
                        "relname": "pk",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 4,
                          },
                          "location": 701,
                        },
                      },
                    ],
                    "location": 697,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 666,
                    "relname": "pk3",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 736,
                        "relname": "fk_parted",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 761,
                        },
                      },
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 2,
                          },
                          "location": 764,
                        },
                      },
                    ],
                    "location": 757,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 719,
                    "relname": "fk1",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 799,
                        "relname": "fk_parted",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 3,
                          },
                          "location": 824,
                        },
                      },
                    ],
                    "location": 820,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 782,
                    "relname": "fk2",
                    "relpersistence": "p",
                  },
                },
              },
              {
                "CreateStmt": {
                  "inhRelations": [
                    {
                      "RangeVar": {
                        "inh": true,
                        "location": 859,
                        "relname": "fk_parted",
                        "relpersistence": "p",
                      },
                    },
                  ],
                  "oncommit": "ONCOMMIT_NOOP",
                  "partbound": {
                    "listdatums": [
                      {
                        "A_Const": {
                          "ival": {
                            "ival": 4,
                          },
                          "location": 884,
                        },
                      },
                    ],
                    "location": 880,
                    "strategy": "l",
                  },
                  "relation": {
                    "inh": true,
                    "location": 842,
                    "relname": "fk3",
                    "relpersistence": "p",
                  },
                },
              },
            ],
            "schemaname": "fkpart11",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 2020 1`] = `
[
  "UPDATE fkpart11.pk SET a = a + 1 RETURNING tableoid::pg_catalog.regclass, *",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pk",
              "relpersistence": "p",
              "schemaname": "fkpart11",
            },
            "returningList": [
              {
                "ResTarget": {
                  "location": 43,
                  "val": {
                    "TypeCast": {
                      "arg": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "tableoid",
                              },
                            },
                          ],
                          "location": 43,
                        },
                      },
                      "location": 51,
                      "typeName": {
                        "location": 53,
                        "names": [
                          {
                            "String": {
                              "sval": "pg_catalog",
                            },
                          },
                          {
                            "String": {
                              "sval": "regclass",
                            },
                          },
                        ],
                        "typemod": -1,
                      },
                    },
                  },
                },
              },
              {
                "ResTarget": {
                  "location": 74,
                  "val": {
                    "ColumnRef": {
                      "fields": [
                        {
                          "A_Star": {},
                        },
                      ],
                      "location": 74,
                    },
                  },
                },
              },
            ],
            "targetList": [
              {
                "ResTarget": {
                  "location": 23,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 27,
                        },
                      },
                      "location": 29,
                      "name": [
                        {
                          "String": {
                            "sval": "+",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 31,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 2032 1`] = `
[
  "ALTER TABLE fkpart11.fk DROP CONSTRAINT fkey",
  {
    "stmts": [
      {
        "stmt": {
          "AlterTableStmt": {
            "cmds": [
              {
                "AlterTableCmd": {
                  "behavior": "DROP_RESTRICT",
                  "name": "fkey",
                  "subtype": "AT_DropConstraint",
                },
              },
            ],
            "objtype": "OBJECT_TABLE",
            "relation": {
              "inh": true,
              "location": 12,
              "relname": "fk",
              "relpersistence": "p",
              "schemaname": "fkpart11",
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 2037 1`] = `
[
  "UPDATE fkpart11.pk1 SET a = a - 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pk1",
              "relpersistence": "p",
              "schemaname": "fkpart11",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 24,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 28,
                        },
                      },
                      "location": 30,
                      "name": [
                        {
                          "String": {
                            "sval": "-",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 32,
                        },
                      },
                    },
                  },
                },
              },
            ],
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 2050 1`] = `
[
  "UPDATE fkpart11.pk SET a = a + 1 WHERE a = 1",
  {
    "stmts": [
      {
        "stmt": {
          "UpdateStmt": {
            "relation": {
              "inh": true,
              "location": 7,
              "relname": "pk",
              "relpersistence": "p",
              "schemaname": "fkpart11",
            },
            "targetList": [
              {
                "ResTarget": {
                  "location": 23,
                  "name": "a",
                  "val": {
                    "A_Expr": {
                      "kind": "AEXPR_OP",
                      "lexpr": {
                        "ColumnRef": {
                          "fields": [
                            {
                              "String": {
                                "sval": "a",
                              },
                            },
                          ],
                          "location": 27,
                        },
                      },
                      "location": 29,
                      "name": [
                        {
                          "String": {
                            "sval": "+",
                          },
                        },
                      ],
                      "rexpr": {
                        "A_Const": {
                          "ival": {
                            "ival": 1,
                          },
                          "location": 31,
                        },
                      },
                    },
                  },
                },
              },
            ],
            "whereClause": {
              "A_Expr": {
                "kind": "AEXPR_OP",
                "lexpr": {
                  "ColumnRef": {
                    "fields": [
                      {
                        "String": {
                          "sval": "a",
                        },
                      },
                    ],
                    "location": 39,
                  },
                },
                "location": 41,
                "name": [
                  {
                    "String": {
                      "sval": "=",
                    },
                  },
                ],
                "rexpr": {
                  "A_Const": {
                    "ival": {
                      "ival": 1,
                    },
                    "location": 43,
                  },
                },
              },
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 2056 1`] = `
[
  "CREATE FUNCTION fkpart11.print_row () RETURNS TRIGGER LANGUAGE plpgsql AS $$
  BEGIN
    RAISE NOTICE 'TABLE: %, OP: %, OLD: %, NEW: %', TG_RELNAME, TG_OP, OLD, NEW;
    RETURN NULL;
  END;
$$",
  {
    "stmts": [
      {
        "stmt": {
          "CreateFunctionStmt": {
            "funcname": [
              {
                "String": {
                  "sval": "fkpart11",
                },
              },
              {
                "String": {
                  "sval": "print_row",
                },
              },
            ],
            "options": [
              {
                "DefElem": {
                  "arg": {
                    "String": {
                      "sval": "plpgsql",
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "language",
                  "location": 54,
                },
              },
              {
                "DefElem": {
                  "arg": {
                    "List": {
                      "items": [
                        {
                          "String": {
                            "sval": "
  BEGIN
    RAISE NOTICE 'TABLE: %, OP: %, OLD: %, NEW: %', TG_RELNAME, TG_OP, OLD, NEW;
    RETURN NULL;
  END;
",
                          },
                        },
                      ],
                    },
                  },
                  "defaction": "DEFELEM_UNSPEC",
                  "defname": "as",
                  "location": 71,
                },
              },
            ],
            "returnType": {
              "location": 46,
              "names": [
                {
                  "String": {
                    "sval": "trigger",
                  },
                },
              ],
              "typemod": -1,
            },
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;

exports[`foreign_key.sql > line 2071 1`] = `
[
  "DROP SCHEMA fkpart11 CASCADE",
  {
    "stmts": [
      {
        "stmt": {
          "DropStmt": {
            "behavior": "DROP_CASCADE",
            "objects": [
              {
                "String": {
                  "sval": "fkpart11",
                },
              },
            ],
            "removeType": "OBJECT_SCHEMA",
          },
        },
      },
    ],
    "version": 160001,
  },
]
`;
